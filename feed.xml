<?xml version="1.0" encoding="UTF-8"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>에너지엔데이터연구소</title>
    <description>공학박사 과정에서 쌓은 에너지 시스템 전문성에 데이터 사이언스 석사를 더하며 쌓은 계산통계학 활용 역량을 결합하여, 데이터 기반의 에너지 시스템/ 정책/ 시장 관련 솔루션 도출을 올바르게 할 수 있도록 돕습니다.</description>
    <link>https://song4energyndata.github.io/</link>
    <atom:link href="https://song4energyndata.github.io/feed.xml" rel="self" type="application/rss+xml"/>
    <pubDate>Tue, 24 Oct 2023 11:22:49 +0900</pubDate>
    <lastBuildDate>Tue, 24 Oct 2023 11:22:49 +0900</lastBuildDate>
    <generator>Jekyll v4.3.2</generator>
    
      <item>
        <title>국내 전력시장 주요 운영규칙 핵심사항 정리</title>
        <description>&lt;p&gt;최근 에너지 플랫폼 업계 현직자들과 대화를 하며, 국내 전력시장 운영규칙을 상세히 알 필요성을 느꼈다. 본격적으로 에너지 플랫폼 업계에 종사한다면 전력시장 입찰을 전제로 한 에너지 설비들의 데이터 및 비즈니스 모델을 주로 분석하게 될 것이라 생각했기 때문이다. (그간 필자는 BTM (Behind-the-Meter) 단의 에너지 설비 도입을 통한 수요처 에너지 요금 절감량 분석 프로젝트들을 주로 수행했다)&lt;/p&gt;

&lt;p&gt;이에, 전력시장 운영규칙 및 관련 시장제도 설명 원문을 읽고, 방대한 내용들 중 비즈니스모델의 정량적 분석을 위해 필수적으로 알아야 할 것으로 보이는 항목들을 요약하여 이 포스트에 기록하였다. 특히 구체적 수치가 있으면 가능한 한 포함하였다. (기록된 항목 못지않게 중요한 항목들 및 제도 개정으로 인해 변경된 항몰들은 앞으로 꾸준히 업데이트해나갈 예정이다)&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;
&lt;h2 id=&quot;발전-전력량-정산&quot;&gt;발전 전력량 정산&lt;/h2&gt;

&lt;p&gt;내용 출처: &lt;a href=&quot;https://new.kpx.or.kr/board.es?mid=a10502000000&amp;amp;bid=0045&amp;amp;act=view&amp;amp;list_no=51715&amp;amp;tag=&amp;amp;nPage=12&quot;&gt;전력거래소 정산규칙해설서 (2019)&lt;/a&gt;&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;하루전 시장에서의 market clearing을 통해, 시간별로 예측수요를 최종적으로 충족시키는 발전기의 변동비가 해당 시간의 계통한계가격 (SMP) 로 결정됨.&lt;/li&gt;

&lt;li&gt;발전기가 하루전 발전계획에 포함된 발전량 범위 내에서 실제로 발전한 양에 대해, 시장가격 (MP) 을 단가로 하여 정산함. 이를 계획발전 전력량 정산금 (Scheduled Energy Payment, SEP) 이라 함.&lt;br /&gt;&lt;br /&gt;

시장가격은 SMP와 다름. 시장가격은 발전기와 전력수요지와의 거리에 따른 송전손실 차이를 반영하기 위해 SMP에 송전손실계수 (TLF) 를 곱한 값임.&lt;br /&gt;&lt;br /&gt;

이를테면 최대 수요지인 서울에 가까운 포천복합/ 하남열병합 등은 송전손실이 작으므로 TLF가 1보다 크고, 서울에서 먼 월성원자력/ 호남화력 등은 송전손실이 크므로 TLF가 1보다 작음.&lt;br /&gt;&lt;br /&gt;

가격결정발전계획에 포함된 발전기의 변동비는 SMP보다 작거나 같으므로, 발전량에 대해 MP를 정산받으면 변동비를 회수하고도 수익을 얻음. &lt;br /&gt;
(단, 유연탄 및 원자력 발전은 수익 조정을 위한 정산조정계수를 적용받음 (0에서 1 사이))&lt;/li&gt;

&lt;li&gt;발전기가 하루전 발전계획 대비 초과 발전한 경우, 해당 초과분에 대해 정산하는 금액은 추가발전 사유가 발전사에 있느냐 전력계통에 있느냐에 따라 다름.&lt;/li&gt;

&lt;li&gt;발전기가 자체성능시험/ 열제약 등 계통사유가 아닌 발전사 사유로 초과 발전한 경우, 초과 발전량에 대해 무부하비 제외 변동비와 시장가격 중 작은 값을 정산함. 이를 발전사업자 제약 발전 전력량 정산금 (Payment by Market Price for Minimum Energy produced due to Generator-self Constraint, GSCON) 이라 함.&lt;br /&gt;&lt;br /&gt;

(무부하비란 발전기를 전력시스템에 동기화시키되 출력은 내지 않을 때 소요되는 비용임, 자동차가 공회전할 때의 연료비에 비유할 수 있음, 무부하운전을 해야 발전기의 온도를 적정 상태로 맞추어 출력변경에 제때 응동할 수 있음.)&lt;br /&gt;&lt;br /&gt;

초과 발전량에 대한 해당 발전기의 무부하비 제외 변동비가 시장가격보다 높다면 초과 발전량에 대해서는 변동비를 회수하지 못하고, 변동비가 시장가격보다 낮다면 변동비만 회수 가능하고 시장가격으로 전력을 판매하지 못함.&lt;br /&gt;&lt;br /&gt;

단, 열공급 발전기가 하루전계획에는 포함되지 않았으나 실제로는 지역난방 난방수요 충족 등을 이유로 열제약 운전을 하는 경우, 열전비와 발전량에 따라 무부하비 일부를 지급함. 열전비가 작을수록, 변경공급가능용량 대비 실제 발전량이 클수록 무부하비 지급 비율이 커짐.&lt;/li&gt;

&lt;li&gt;발전기가 송전제약/ 수요예측오차 등 계통사유로 초과 발전한 경우, 초과 발전량에 대해 변동비와 시장가격 중 큰 값을 정산함. 이를 계통제약 발전 전력량 정산금 (payment for energy produced due to System Constraints, SCON) 이라 함.&lt;br /&gt;&lt;br /&gt;

가격결정계획에 반영되지 못한 발전량에 대해서는 변동비가 SMP보다 클 것이므로, 변동비를 회수할 수 있도록 변동비를 정산함.&lt;br /&gt;&lt;br /&gt;

특히 가격계획에 반영되지 않았고 자가제약도 없어 원래대로라면 기동하지 않았을 발전기가 계통 사유로 기동한 경우, 변동비 산정에 무부하비도 포함.&lt;/li&gt;

&lt;li&gt;발전기가 하루전 발전계획에 포함된 발전량을 &apos;계통 지시에 의해 감발하거나 정지하여&apos; 실제로는 발전하지 않은 경우, 발전했더라면 거둬들였을 기대 이익을 정산함. 이를 제약 비발전 전력량 정산금 (Constrained-off energy payment, COFF) 이라 함.&lt;br /&gt;&lt;br /&gt;

기대이익 단가는 시장가격과 변동비의 차이임.&lt;br /&gt;&lt;br /&gt;

감발한 급전발전기는 수요 증가에 의한 주파수 하락 시 출력 증가를 통해 주파수 회복에 기여할 수 있으므로, COFF는 일종의 예비력 정산금과 같이 볼 수 있음.&lt;/li&gt;

&lt;li&gt;비중앙급전 발전기에 대해서는 실제 발전량을 SMP로 정산하고, 기타 사항은 정산하지 않음.&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;
&lt;h2 id=&quot;용량가격-보조서비스가격-정산&quot;&gt;용량가격/ 보조서비스가격 정산&lt;/h2&gt;

&lt;p&gt;내용 출처: &lt;a href=&quot;https://new.kpx.or.kr/board.es?mid=a10502000000&amp;amp;bid=0045&amp;amp;act=view&amp;amp;list_no=51715&amp;amp;tag=&amp;amp;nPage=12&quot;&gt;전력거래소 정산규칙해설서 (2019)&lt;/a&gt;&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;전력시장에 입찰하는 급전가능 발전기들에 대해, 공통적으로 공급가능용량에 대한 용량요금 (Trading Period Capacity Payment, CP) 을 정산함 (입찰은 했으나 하루전 발전계획에 포함되지 않은 발전기가 실제로도 발전하지 않은 경우에도 정산).&lt;br /&gt;&lt;br /&gt;

초기입찰 후 공급가능용량을 낮추어서 변경입찰 시 최종 공급가능용량 기준으로 정산함. 반대로 초기입찰 후 공급가능용량을 높여 변경입찰하더라도 초기입찰용량 기준으로 정산함. 이는 공급용량을 정확히 예측하라는 의미임.&lt;br /&gt;&lt;br /&gt;

단, 복합발전기 가스터빈의 경우 외기온도 저하로 공기밀도가 증가하면 공급가능용량이 증가함. 그러므로 거래일의 예측기온과 당일의 실제기온 간 차이를 보정한 온도보정 입찰값을 변경입찰값과 비교해 산정함.&lt;/li&gt;

&lt;li&gt;용량가격은 용량에 일반용량가격(용량당 단가)과 용량가격보정계수의 합을 곱하여 계산함. 일반용량가격은 기준용량가격, 용량가격계수, 시간대별용량가격계수, 연료전환성과계수 네 값의 곱임. 용량가격계수와 연료전환성과계수는 발전기 별로 상이함.&lt;/li&gt;

&lt;li&gt;비중앙급전 발전기의 경우 용량요금은 지불하지 않음.&lt;/li&gt;

&lt;li&gt;주파수 추종 운전상태를 30분 이상 유지하는 발전기에 대해 주파수 추종 서비스 정산금액을 지불함. 또한 자동발전제어 서비스 (주파수 제어 관련) 를 제공한 발전기에 대해 제어가용률 및 제어성과 가중치를 반영한 정산금액을 지불함.&lt;br /&gt;&lt;br /&gt;

발전사업자가 소유한 중앙급전 전기저장장치가 주파수추종 또는 원격출력제어 서비스를 제공한 경우에도 위 규칙을 준용해 정산함.&lt;/li&gt;

&lt;li&gt;예비력 (20분 또는 120분 이내 응동) 계획에 포함된 발전기는 지정된 에비력 용량에 대해 발전 여부에 상관없이 예비력 정산금을 받음 (발전하는 경우 에너지 정산금도 받음).&lt;br /&gt;&lt;br /&gt;

예비력 계획에 반영되었음에도 응동 및 발전하지 못하는 경우 예비력 정산금을 지불하지 않음은 물론, 예정 정산금의 3배를 환수함 (단, 고장 등 사유로 예비력 제공이 불가능해 사전 신고한 경우는 제외).&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;
&lt;h2 id=&quot;급전지시-미이행-시-패널티&quot;&gt;급전지시 미이행 시 패널티&lt;/h2&gt;

&lt;p&gt;내용 출처: &lt;a href=&quot;https://new.kpx.or.kr/board.es?mid=a10502000000&amp;amp;bid=0045&amp;amp;act=view&amp;amp;list_no=51715&amp;amp;tag=&amp;amp;nPage=12&quot;&gt;전력거래소 정산규칙해설서 (2019)&lt;/a&gt;&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;계통 연결 또는 분리를 지시받고 지시받은 시각보다 (허용오차를 초과해) 늦게 또는 빨리 이행하는 경우 패널티를 받음.&lt;br /&gt;&lt;br /&gt;

조기 계통연결 및 계통분리 지연시, 계획된 연결시간 이외 시간의 발전에 대한 계량값은 0으로 조정함.&lt;br /&gt;&lt;br /&gt;

조기 계통분리시 빨리 분리한 시간 동안의 공급가능용량은 0으로 조정, 계통연결 지연시 공급가능용량은 계량값으로 조정함
(이를테면 500MW 발전기가 15분 조기 분리 시 공급가능용량은 500MWh에 3분의 4를 곱한 375MWh).&lt;/li&gt;

&lt;li&gt;조기 계통연결 및 계통분리 지연은 공급 과잉으로 인한 주파수 상승을 야기하고, 조기 계통분리 및 계통연결 지연은 공급 부족으로 인한 주파수 하락을 야기함. 주파수 하락이 전력계통에 있어 더 큰 위협이므로, 조기 계통분리 및 계통연결 지연 시 패널티가 더 큼, 특히 계통연결 지연에 대해 매우 큰 패널티가 부여됨.&lt;/li&gt;

&lt;li&gt;발전사 사유로 급전지시량에 미달되게 발전하고도 적절한 변경입찰을 하지 않은 경우, 공급가능용량을 계량전력량으로 조정함.&lt;br /&gt;&lt;br /&gt;

급전지시량을 초과하여 발전하는 경우 초과발전량만큼 공급가능용량을 차감함. 또한 SEP를 실제 발전량이 아닌 차감된 공급가능용량 기준으로 정산함.&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;
&lt;h2 id=&quot;수요반응자원&quot;&gt;수요반응자원&lt;/h2&gt;

&lt;p&gt;내용 출처: &lt;a href=&quot;https://new.kpx.or.kr/board.es?mid=a10205010000&amp;amp;bid=0030&quot;&gt;전력거래소 전력시장운영규칙&lt;/a&gt;&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;고객기준부하 (수요반응에 참여하지 않았다면 사용했을 평상시 사용전력량 예측값) 기준으로 차이를 계산함. 전력부하감축량은 일반적으로 DR에서 말하는 감축량, 전력부하증대량은 플러스DR에 의해 사용량을 늘린 양&lt;/li&gt;

&lt;li&gt;각 거래시간 별 고객기준부하 산정 방식은 아래 중 택일.&lt;br /&gt;&lt;br /&gt;

1) 최근 평일 5일(참고일) 중 거래시간 사용전력량이 큰 순서대로 최대 4일(유사일) 선택, 유사일의 사용전력량 평균&lt;br /&gt;
2) 최근 평일 10일 중 거래시간 사용전력량 기준 최대 2일과 최소 2일 제외 후 남은 6일 평균&lt;br /&gt;
3) 최근 평일 6일 중 최대 1일과 최소 1일 제외 후 남은 4일 평균 (플러스DR/ 국민DR의 고객기준부하 산정)&lt;br /&gt;
4) 최근 평일 10일 중 최대 1일과 최소 1일 제외 후 남은 8일 평균 (국민DR의 고객기준부하 산정)&lt;br /&gt;
5) 최근 10분의 1분 단위 전력사용량 합에 6을 곱한 값 (주파수DR의 고객기준부하 산정)&lt;br /&gt;
6) 최근 공휴일/ 토요일 6일 중 최대 1일과 최소 1일 제외 후 남은 4일ㄹ 평균 (플러스DR의 공휴일/ 토요일 전력부하증대량 평가를 위한 고객기준부하 산정)&lt;br /&gt;&lt;br /&gt;

비정상근무일 (생산설비 고장/ 창립기념일 등 평상시 전기소비형태와 매우 다른 날) 이 참고일에 포함되지 않도록 함. 산출된 평균 사용전력량의 75% 미만인 날은 참고일 산정에서 제외함, 산업용의 경우 앞 기준으로 참고일 재산정 시 평균 대비 75% 미만 혹은 125% 초과인 날을 추가로 제외함.&lt;br /&gt;&lt;br /&gt;

유사일과 감축일의 기온오차 등에 따른 전기소비형태를 반영하기 위해, 감축시작시간 1시간 전에서 4시간 전까지의 3시간 동안의 평균 사용전력량에서 유사일의 동일 시간대 평균 사용전력량을 차감한 값을 고객기준부하 값에 합해 &apos;최종적인&apos; 고객기준부하를 산출함.&lt;/li&gt;

&lt;li&gt;의무감축용량은 예비력 550만kW 미만 예상 시 발령되는 의무감축요청에 따라 감축할 의무를 갖는 용량임 (이전의 신뢰성 DR에 대응). 용량 및 고객 유형에 따라 표준형 (10MW 초과 500MW 이하), 중소형 (2MW 초과 50MW 이하), 국민DR (제한 없음) 으로 나뉨. &lt;/li&gt;

&lt;li&gt;감축가능용량은 자발적 입찰을 통해 하루전발전계획에 포함할 수 있는 용량임 (이전의 경제성 DR에 대응). 경제성DR에서는 전력시장에서 발전사업자 발전량들과 경쟁에서 낙찰 시 감축을 수행함.&lt;br /&gt;&lt;br /&gt;

그 외에 피크수요 DR (동계/ 하계 전력수급대책 목표수요 초과 예상 시 전일 입찰 개설), 미세먼지 DR (고농도 미세먼지 비상조치 발령 시 전일 입찰 개설) 등의 자발적 프로그램이 있음.&lt;br /&gt;&lt;br /&gt;

자발적 수요감축 입찰은 평일 거래일에 대해 입찰함.&lt;/li&gt;

&lt;li&gt;최근에는 Fast DR (계통 주파수 59.85Hz 이하로 하락 시 자동 반응 가능한 고객 설비로 구성), Plus DR (전력공급이 과도할 경우 전력 소비를 증가시킬 수 있는 고객 설비로 구성) 도 추가됨.&lt;br /&gt;&lt;br /&gt;

Plus DR은 현재 제주에서는 정식으로 시행 중이며, 육지에서는 시범사업 중임.&lt;/li&gt;

&lt;li&gt;자발적 감축에 따라 계획에 포함된 감축량은 SMP로 정산함.&lt;/li&gt;

&lt;li&gt;의무감축요청에 따른 의무감축이행량에 대해서는 해당 시간에 최소출력의 110% 이상으로 운전한 급전가능발전기들의 최고 변동비를 출력으로 나눈 값을 단가로 하여 정산함.&lt;br /&gt;&lt;br /&gt;

또한 표준 및 중소형DR에 대해서는 감축량과 별개로 용량에 대해서도 기본정산금을 지급함 (국민DR에 대해서는 기본정산금을 지급하지 않음).&lt;/li&gt;

&lt;li&gt;참여 전에 등록시험 및 전기소비형태 검증을 해야 함.&lt;br /&gt;&lt;br /&gt;

등록시험의 경우 감축지속시간은 3시간~4시간 (중소형DR/ 제주DR은 1시간), 시간대는 평일 9시~20시 사이 (12~13시 제외) 제주DR은 평일 10시~21시 사이) 임.&lt;br /&gt;&lt;br /&gt;

전기소비형태 검증 기준은, 검증대상일 (등록일로부터 20일 전부터 평일 45일, 감축일은 제외) 의 9시~20시 동안 계산된 RRMSE (Relative Root Mean Squared Error, 검증기간의 시간별 고객기준부하 (CBL) 와 실제 사용전력량 (Load)의 평균 오차와 검증기간의 평균 사용전력량의 비율) 가 30% 이하일 것임. RRMSE의 식은 하기와 같음.&lt;br /&gt;&lt;br /&gt;

\begin{align} 
\sqrt{\frac{\sum_{d \in D,t \in T} (CBL_{d,t} - Load_{d,t})^2}{D(n) \times T(n)}} \div \frac{\sum_{d \in D,t \in T} Load_{d,t}}{D(n) \times T(n)}
\notag
\end{align} &lt;/li&gt;

&lt;li&gt;평균감축이행률은 해당 거래일 거래시간별 전력부하감축량의 합을 감축계획량의 합으로 나눈 값임.&lt;br /&gt;&lt;br /&gt;

평균감축이행률이 97% 이상이어야 온전히 정산받을 수 있음. 80% 이상 97% 미만이면 등록신청용량에 평균감축이행률을 곱한 값으로 용량이 하향조정되며, 평균 80% 미만이거나 시간대별 감축이행률의 최소값이 70% 미만이면 참여가 제한됨.&lt;/li&gt;

&lt;li&gt;연중 2회 (12월 및 6월 1~2주) 감축시험을 시행함. 시험에서 평균감축이행률이 97% 미만이거나 시간대별 감축이행률의 최소값이 70% 미만인 자원은 12월 및 6월 3~4주에 재시험을 시행함.&lt;/li&gt;

&lt;li&gt;감축일의 특정 감축시간대에 특정 고객의 사용전력량 데이터 누락 발생 시, 해당 고객의 해당 거래시간 감축량은 0으로 적용함.&lt;/li&gt;

&lt;/ul&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;
&lt;h2 id=&quot;재생에너지-발전량-예측제도&quot;&gt;재생에너지 발전량 예측제도&lt;/h2&gt;

&lt;p&gt;내용 출처: &lt;a href=&quot;https://new.kpx.or.kr/board.es?mid=a10205010000&amp;amp;bid=0030&quot;&gt;전력거래소 전력시장운영규칙&lt;/a&gt;&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;태양광/ 풍력 개별발전기 또는 집합전력자원의 총 용량이 20MW를 초과해야 함.&lt;/li&gt;

&lt;li&gt;시간대별 설비이용률 (전력거래량을 용량으로 나누어 얻은 비율) 이 10% 이상 되는 시간 각각에 대해, 예측오차율 (예측발전량과 실제전력거래량 간 차이의 절대값을 설비용량으로 나누어 얻은 비율) 을 계산함. (실제전력거래량으로 나누는 것이 아님에 주의)&lt;br /&gt;&lt;br /&gt;

단, 설비이용률 산정 시 고장/ 정비로 정지해 있거나 급전지시로 출력제어 된 설비의 용량 및 발전량은 위 계산에서 제외함.&lt;/li&gt;

&lt;li&gt;예측발전량을 총 2회 (거래전일 10시, 17시) 에 걸쳐 제출하므로 각 예측발전량에 대해 예측오차율을 구한 후 산술평균을 냄. 이 산술평균이 6% 이하인 시간대에 대해서는 kWh당 4원, 6% 초과 8% 이하인 시간대에 대해서는 kWh당 3원의 인센티브를 정산함.&lt;/li&gt;

&lt;li&gt;대상자원 등록자격은 3개월 주기로 갱신하며, 직전 3개월 간의 시간대별 예측오차율들을 산술평균한 값이 10% 이하여야 자격이 연장됨.&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;
&lt;h2 id=&quot;실시간-시장에서의-재생에너지-입찰제도-제주-시범사업-기준&quot;&gt;실시간 시장에서의 재생에너지 입찰제도 (제주 시범사업 기준)&lt;/h2&gt;

&lt;p&gt;내용 출처: &lt;a href=&quot;https://www.kpx.or.kr/board.es?mid=a11203000000&amp;amp;bid=0209&amp;amp;act=view&amp;amp;list_no=70470&quot;&gt;전력시장 제도개선 제주 시범사업 운영규칙(안)&lt;/a&gt;&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;제주도에서 하루전 시장 (1시간 단위) 과 더불어 당일 실시간 시장 (15분 단위) 을 신설함.&lt;br /&gt;&lt;br /&gt;

하루전 시장에서의 낙찰량은 하루전 가격으로 정산, 하루전 낙찰량과 당일 실제 발전량 간 &apos;차이&apos;는 실시간가격으로 정산함.&lt;/li&gt;

&lt;li&gt;급전가능 재생에너지도 전력시장에 입찰해 가격결정에 관여함 (음의 가격으로 입찰하되, 하한은 2개월 전 현물 REC 평균가의 -2.5배임).&lt;/li&gt;

&lt;li&gt;급전가능 재생에너지는 보조 ESS 및 전력거래소에 실시간 정보를 제공하고 출력상한/ 출력제어 지시를 받는 인프라를 포함하고, 15분 평균 발전량을 출력상한 내로 조정 가능해야 함.&lt;br /&gt;&lt;br /&gt;

용량은 개별 1MW 초과 20MW 이하 또는 VPP 용량 1MW 초과 100MW 이하여야 함. 특히 3MW 초과 시 의무적으로 참여해야 함.&lt;/li&gt;

&lt;li&gt;재생발전기의 가장 큰 이슈인 출력제한 (curtailment) 에 대한 보상안이 마련됨.&lt;br /&gt;&lt;br /&gt;

재생발전기가 계통 지시로 출력제한 시, 그 출력제한 양에 실시간가격과 발전단가의 차이를 곱하여 계산되는 기대이익을 보상함. (만약 예비력 계획에 포함되었고 예비력실적에도 변동이 있었다면 이도 보상)&lt;/li&gt;

&lt;li&gt;실시간발전량이 허용오차를 벗어나는 수준으로 제약입찰량에 미달할 경우, 미달 발전량에 대해 실시간가격의 20%의 패널티를 부과함.&lt;br /&gt;&lt;br /&gt;

허용오차는 변경입찰후 공급가능용량에 0.005를 곱한 값 (주파수추종/ 자동발전제어운전신고 후 운전한 발전기는 0.01을 곱한 값) 을 원칙으로 하되 하한은 0.5MWh, 상한은 5MWh임.&lt;/li&gt;

&lt;li&gt;재생에너지 입찰제도 도입 시 재생에너지 발전량 예측제도에 의한 인센티브 지급은 원칙적으로 종료되어야 함. 그러나 전환기 조치로 첫 1년간 현행 인센티브의 50%를 지급함. 또한 예측제도 참여자원 감소분을 고려해 예측제도의 용량 기준을 20MW에서 1MW로 완화함 (급전가능재생에너지 참여규모 기준과 일치).&lt;/li&gt;
&lt;/ul&gt;

</description>
        <pubDate>Sun, 22 Oct 2023 00:00:00 +0900</pubDate>
        <link>https://song4energyndata.github.io/koreanmarketrules.html</link>
        <guid isPermaLink="true">https://song4energyndata.github.io/koreanmarketrules.html</guid>
        
        <category>전력시장</category>
        
        
        <category>market</category>
        
      </item>
    
      <item>
        <title>논문 소개: 전기차 충전 이력 데이터 기반의, 계통 내 시간별 전기차 충전 부하 시뮬레이션</title>
        <description>&lt;p&gt;전기차 및 충전 인프라 규모가 증가할수록 전력계통에 걸리는 부하가 증가한다. 그러므로 향후 발전/ 송전/ 배전 (특히 배전단) 설비 및 스케줄링 계획 수립을 위해, 전기차 충전으로 인한 시간별 부하 증가를 정확히 예측할 필요가 있다.&lt;/p&gt;

&lt;p&gt;이를테면 &lt;a href=&quot;https://www.mckinsey.com/industries/automotive-and-assembly/our-insights/the-potential-impact-of-electric-vehicles-on-global-energy-systems&quot;&gt;McKinsey에서는 150세대의 주거지역 배전단에서 가정 내 전기차 비중이 25%가 되면 아래 그림과 같이 모든 시간의 전기부하가 증가하며, 특히 최대부하는 약 30% 증가할 것으로 예상했다.&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/evestimates/impact_mckinsey.png&quot; alt=&quot;impact_ev&quot; class=&quot;align-center&quot; width=&quot;80%&quot; /&gt;
&lt;em&gt;전기차 증가로 인한 시간별 부하 증가 예상. (출처: 위 링크의 McKinsey 웹페이지)&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;또한 최근에는 수 kW급의 저속충전 뿐 아니라 100kW 이상의 고속충전 인프라가 확산되고 있으므로, 전기차 충전이 짧은 시간 내에 특정 배전 계통에 큰 부담을 줄 가능성도 고려해야 한다.&lt;/p&gt;

&lt;p&gt;(그나마 한국에서는 &lt;a href=&quot;https://www.electimes.com/news/articleView.html?idxno=327073&quot;&gt;최근 전기차 충전소에서 자체 재생에너지와 ESS를 전력시장을 거치지 않고 충전에 사용할 수 있도록 제도가 개선되었는데&lt;/a&gt;, 이를 통해 고속충전 인프라가 야기하는 배전계통의 부담을 완화시키는 방안이 도출될 수 있을지 기대된다.)&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;
&lt;h2 id=&quot;운전자-별-충전-행태의-다양성-및-임의성&quot;&gt;운전자 별 충전 행태의 다양성 및 임의성&lt;/h2&gt;

&lt;p&gt;전기차 부하 예측에서 어려운 점은, 전기차 운전자들의 충전 행태가 운전자별로 굉장히 다양하며 (heterogeneous) 확률적이라는 (probabilistic) 것이다.&lt;/p&gt;

&lt;p&gt;어떤 사람은 주로 집에서 야간 완속충전을 하는 반면, 어떤 사람은 주로 공용충전소에서 주간에 급속충전을 한다. 또 어떤 사람은 직장에 충전설비가 있어 직장에서 주간에 완속충전을 한다. 즉 충전 행태가 다양하다. 한편, 이는 행태가 비슷한 운전자들의 ‘grouping’의 필요성도 암시한다.&lt;/p&gt;

&lt;p&gt;또한 같은 운전자라도 충전 행태가 매일 완벽히 똑같진 않을 것이다. 오늘의 정확한 충전 시간대가 어제와는 몇 분 이상 다를 수 있고, 오늘의 충전량 또한 어제의 충전량과 조금은 다를 수 있다. 심지어는 같은 운전자가 오늘 충전 시 어제와는 다른 장소에서 충전할 수도 있다. 즉 운전자가 ‘오늘 언제 어디서 얼마나 충전할지’는 고정된 상수가 아닌 확률변수로 보아야 한다.&lt;/p&gt;

&lt;p&gt;위와 같이 다양하고 확률적인 운전자 별 충전 행태를 고려한 충전 부하 예측을 위해서는, 운전자들의 실제 충전 이력 데이터에 기반한 통계학습 모델을 구성하는 것이 좋다.&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;
&lt;h2 id=&quot;논문에서-제안하는-모델의-concept&quot;&gt;논문에서 제안하는 모델의 concept&lt;/h2&gt;

&lt;p&gt;이 포스팅에서는, 운전자들의 충전 이력 데이터셋을 이용해, 전기차가 많이 보급될 경우 특정 지역 내에서 하루 24시간 동안의 전기 부하가 어떻게 증가할지를 예측하는 모델을 제안한 논문을 소개한다. &lt;a href=&quot;https://doi.org/10.1016/j.apenergy.2021.118382 &quot;&gt;Applied Energy에서 출판된 ‘Scalable probabilistic estimates of electric vehicle charging given observed driver behavior’&lt;/a&gt; 이다.&lt;/p&gt;

&lt;p&gt;해당 논문에서 제시한 모델의 목적은, 각 전기차 운전자 별로 아래 요소들로 표현되는 충전 행태를 시뮬레이션하고, 그 결과를 합하여 ‘운전자들의 전기차 충전부하의 총 합’ 을 시간별로 예측하는 것이다.&lt;/p&gt;

&lt;p&gt;1) 어디에서 어떤 인프라로 충전하는가?&lt;br /&gt;
2) 몇 시 몇 분에 충전을 시작하는가?&lt;br /&gt;
3) 충전 시간은 얼마나 걸리는가?&lt;br /&gt;
4) 충전 에너지의 양은 얼마나 되는가?&lt;/p&gt;

&lt;p&gt;위 요소 중 1)에 해당하는 장소 및 인프라 종류는 segment라고도 하며, 이 연구에서는 아래 5가지를 고려하였다.&lt;/p&gt;

&lt;p&gt;a) 단독주택에서의 저속 (6.6kW) 충전&lt;br /&gt;
b) 공동주택에서의 저속 충전&lt;br /&gt;
c) 직장에서의 저속 충전&lt;br /&gt;
d) 공용충전소에서의 저속 충전&lt;br /&gt;
e) 공용충전소에서의 고속 (50~150kW) 충전&lt;/p&gt;

&lt;p&gt;제안된 모델은 앞서 언급한 이슈들인 다양성과 임의성을 고려하여 시뮬레이션이 가능하다는 장점이 있다. 아래 그림처럼 전기차 운전자들을 충전 행태의 유사도에 따라 grouping하여 충전 행태의 다양성을 반영할 수 있고, 특정 그룹에 속하는 운전자가 어떤 유형의 충전인프라를 언제 얼만큼 사용할지에 대한 확률분포를 모델링해 시뮬레이션한다.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/evestimates/profiles_cluster.png&quot; alt=&quot;clusters_ev&quot; class=&quot;align-center&quot; /&gt;
&lt;em&gt;각 운전자 group 별 시간별 충전 부하 형태 (normalized profiles). 각 색깔은 각 segment를 의미함.&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;이를테면 위 그림에서 cluster 1~3 (붉은 테두리) 은 ‘충전의 대부분을 직장에서 주간에 하는 운전자들의 group을, cluster 4~6 (주황 테두리) 는 ‘충전의 대부분을 주택에서 야간에 하는 운전자들의 group’ 을 의미한다.&lt;/p&gt;

&lt;p&gt;이 논문에서 제안된 모델을 통해, 일정 규모 이상의 발전/ 송전/ 배전 계획에서 전기차 확산의 영향을 보다 정확히 예측할 수 있을 것으로 기대된다.&lt;/p&gt;

&lt;p&gt;실제로 &lt;a href=&quot;https://doi.org/10.1038/s41560-022-01105-7&quot;&gt;해당 연구의 후속 연구 (Charging infrastructure access and operation to reduce the grid impacts of deep electric vehicle adoption) 는 Nature Energy에 게재되기도 했다.&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;
&lt;h2 id=&quot;비슷한-운전자들을-grouping-clustering-analysis-기반&quot;&gt;비슷한 운전자들을 grouping (Clustering analysis 기반)&lt;/h2&gt;

&lt;p&gt;충전 행태가 ‘비슷한’ 운전자들 별 group들을 구성하기 위해 clustering analysis가 사용되었다. 운전자 별 유사도 판단에 사용할 운전자 별 정량적 속성 (quantitative feature) 들은 아래와 같다.&lt;/p&gt;

&lt;p&gt;1) (일정 기간 내에) 각 segment에서 충전한 횟수&lt;br /&gt;
2) 각 segment에서의 평균적인 도착 시간&lt;br /&gt;
3) 각 segment에서의 평균적인 충전량&lt;br /&gt;
4) 각 segment에서의 평균적인 충전 시간&lt;br /&gt;
5) 각 segment에서 평일 대비 휴일 충전의 비율 (횟수 기준)&lt;br /&gt;
6) 전기차 배터리 용량&lt;br /&gt;
7) 충전하는 장소 수 (주소 기준)&lt;/p&gt;

&lt;p&gt;(위 7개 feature들 중 1) ~ 5) 는 모든 segment 각각에 대해 별도로 계산됨에 주의.)&lt;/p&gt;

&lt;p&gt;각 feature별로 단위 및 scale이 다르므로 normalization을 한 후, normalized feature vector space에서의 Euclidean distance에 기반해 clustering을 수행한다.&lt;/p&gt;

&lt;p&gt;이 논문에서는 가장 흔히 사용되는 $k$-Means가 아닌, 계층적 (hierarchical) 구조를 고려하는 agglomerative clustering을 사용하였다. 이는 bottom-up 방식의 방법으로, 각 data point를 하나의 cluster로 두고 시작해 매 step마다 ‘가장 비슷한’ 두 cluster들을 하나의 cluster로 묶는 작업을 반복하는 알고리즘이다.&lt;/p&gt;

&lt;p&gt;Agglomerative clustering을 하면 각 cluster의 의미를 파악하기 쉽다는 장점이 있다. 이 연구에서는 각 cluster의 의미가 중요하기 때문에 채택하였다.&lt;/p&gt;

&lt;p&gt;이 연구에서는 cluster 갯수를 16개로 결정하였다 (elbow curve에 근거함). 16개 cluster들을 위에서 언급한 ‘의미’에 따라 보면, 각 운전자가 아래 5개의 ‘super’cluster들 중 하나에 속하는 것으로 해석할 수 있다.&lt;/p&gt;

&lt;p&gt;1) 거의 대부분 직장에서 충전 (아래의 A-Red)&lt;br /&gt;
2) 거의 대부분 집에서 충전 (아래의 B-Orange)&lt;br /&gt;
3) 거의 대부분 공용충전소에서 충전 (아래의 C-Yellow)&lt;br /&gt;
4) 직장 및 공용충전소에서 충전, 배터리 크기 큼 (아래의 D-Green)&lt;br /&gt;
5) 직장 및 공용충전소에서 충전, 배터리 크기 작음 (아래의 E-Blue)&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/evestimates/dendrogram.png&quot; alt=&quot;dendrogram&quot; class=&quot;align-center&quot; /&gt;
&lt;em&gt;Clustering 결과의 의미를 해석하기 위한 dendrogram 및 5개의 supercluster들.&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;어떤 운전자가 16개의 cluster 중 특정 cluster $G$에 속할 확률을 $P(G)$라 표현한다. $P(G)$는 통상적으로 훈련 데이터에서의 각 cluster 별 크기에 기반해 결정하지만, 현실에 맞게 조정할 수 있다.&lt;/p&gt;

&lt;p&gt;이를테면, 이 논문의 case study에서는 집에서의 야간 완속충전 비중이 증가하는 추세를 반영하여, 집에서의 야간 완속충전을 위주로 하는 운전자들에 대응하는 supercluster (위에서의 B-Orange) 의 $P(G)$를 증가시켰다.&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;
&lt;h2 id=&quot;각-운전자의-충전-장소-인프라-확률-모델링&quot;&gt;각 운전자의 충전 장소/ 인프라 확률 모델링&lt;/h2&gt;

&lt;p&gt;서두에서 언급했듯, 전기차 충전 장소와 인프라 유형 (segment라 칭함) 으로 아래 5가지를 고려하였다.&lt;/p&gt;

&lt;p&gt;a) 단독주택에서의 저속 (6.6kW) 충전&lt;br /&gt;
b) 공동주택에서의 저속 충전&lt;br /&gt;
c) 직장에서의 저속 충전&lt;br /&gt;
d) 공용충전소에서의 저속 충전&lt;br /&gt;
e) 공용충전소에서의 고속 (50~150kW) 충전&lt;/p&gt;

&lt;p&gt;각 cluster 별 운전자는 꼭 하나의 segment에서만 충전하는 것은 아니다. 빈도의 차이는 있지만, 그때그때 다른 segment에서 충전할 수 있다. 이를테면 대부분의 충전을 주택에서 하는 운전자도, 불가피하게 장거리 운전을 하다 도중에 공용충전소에서 충전할 일도 있을 것이다.&lt;/p&gt;

&lt;p&gt;그러므로 각 cluster 별로, cluster $G$에 속하는 운전자가 하루 동안 segment $z$에서 충전할 확률 $P(z \vert G)$를 추정한다.&lt;/p&gt;

&lt;p&gt;평일에 대해서는, 그 group 내 모든 운전자들이 데이터 수집 기간 동안의 총 평일 수 대비 해당 segment $z$에서 충전한 평균횟수의 비율로 추정하였다. 휴일에 대해서는 같은 논리로 별도의 확률을 추정한다.&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;
&lt;h2 id=&quot;각-운전자의-충전-시작시간-에너지량-소요시간-확률-모델링&quot;&gt;각 운전자의 충전 시작시간/ 에너지량/ 소요시간 확률 모델링&lt;/h2&gt;

&lt;p&gt;Cluster $G$에 속하는 운전자가 segment $z$에서 충전할 때, 충전소에서 충전을 시작하는 시간/ 충전 에너지량/ 충전에 걸리는 시간 총 세 가지 변수의 묶음을 3변량 확률변수 벡터 $s$로 보고, 해당 벡터의 다변량확률분포 $P(s \vert z,G)$를 모델링한다.&lt;/p&gt;

&lt;p&gt;이 연구에서는 Gaussian Mixture Model (GMM) 을 사용하였다. 즉 확률분포를 단일한 정규분포가 아니라 여러 개의 정규분포들의 합 (즉 multimodal distribution) 으로 가정하였다.&lt;/p&gt;

&lt;p&gt;이는 같은 group과 같은 segment라 하더라도 사람들에 따라 디테일한 충전 행태가 다를 것이고 (누구는 이른 시간에 와서 조금만 충전하고, 누구는 늦은 시간에 와서 많이 충전하고 등), 특별히 빈도가 높은 행태가 한 가지가 아니라 두 가지 이상일 수 있기 때문이다.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/evestimates/gmm_concept.png&quot; alt=&quot;gmm_concept&quot; class=&quot;align-center&quot; width=&quot;70%&quot; /&gt;
&lt;em&gt;Gaussian Mixture Model의 concept. 빈도가 높은 값이 여러 개 있음.&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;GMM에서는 component (각각의 단일한 3변량 정규분포) 의 갯수를 사전에 정해 주면, 각 component 별 평균 벡터와 공분산 행렬 및 각 component의 가중치를 (데이터에 가장 잘 적합되게) 계산한다.&lt;/p&gt;

&lt;p&gt;각 $(z,G)$ 별 GMM 모델의 component 갯수를 정하려면 지표가 필요한데, 이 논문에서는 Akaike Information Criterion (AIC) 를 지표로 두어 데이터에 잘 적합되면서도 복잡하지 않은 모델을 도출하도록 하였다.&lt;/p&gt;

&lt;p&gt;이를테면, 아래 그림에서 상단의 큰 subplot은 특정 cluster에 속하며 직장에서 주간 완속충전을 하는 사람 1만명을 가정하고 시뮬레이션해 얻은 시간별 총 충전 부하이고, 하단의 4개 subplot들은 해당 $(z,G)$에 대한 GMM 모델의 component들 중 가중치가 높은 순으로 4개 component들 각각에 의해 도출된 시간별 충전 부하다.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/evestimates/gmm.png&quot; alt=&quot;Gaussian_mixture&quot; class=&quot;align-center&quot; /&gt;
&lt;em&gt;특정 cluster - segment 조합에 대한 운전자 1만명을 시뮬레이션했을 때의 충전 패턴 (상단) 및 GMM의 major component들에 의해 계산된 패턴들 (하단).&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;여기까지 계산하면, 각 운전자의 cluster/ segment/ 디테일한 충전행태 (충전 시작시간/ 에너지량/ 소요시간) 의 ‘결합’ 확률분포 $P(s,z,G)$ 를, 앞에서 구한 확률분포들의 곱인 $P(s \vert z,G) P(z \vert G) P(G)$ 로 계산할 수 있다.&lt;/p&gt;

&lt;p&gt;위 확률분포 곱을 얻으면, $G$를 생성하고, 주어진 $G$를 조건부로 하는 $z$를 생성하고, 주어진 $(z,G)$를 조건부로 하는 $s$를 생성하여, 각 운전자의 충전 부하를 시뮬레이션으로 생성할 수 있다.&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;
&lt;h2 id=&quot;논문의-case-study-시나리오-소개&quot;&gt;논문의 case study: 시나리오 소개&lt;/h2&gt;

&lt;p&gt;논문에 사용된 데이터셋은 California의 특정 충전소 사업체로부터 받은, 약 38,000명의 운전자가 약 399만 회 충전한 이력 데이터이다.&lt;/p&gt;

&lt;p&gt;논문에서는 2030년에 전기차 수가 8백만대로 증가한다고 가정하고, 하기의 4개 시나리오 각각에 대해 총 전기차 충전 부하를 시뮬레이션하였다.&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;
&lt;b&gt;시나리오 1: 주택에서의 충전이 계시별 요금제 및 타이머 기반으로 이루어질 경우&lt;/b&gt;&lt;/p&gt;

&lt;p&gt;모델링에 사용된 충전 이력 데이터에 따르면 대부분의 충전이 직장에서 이루어졌다. 그러나 이는 해당 충전소 사업체의 특성에 영향받은 결과이다. 실제로 California에서는 주택에서의 충전이 증가하는 추세이며, 2030년에는 운전자의 3분의 2가 주택에서 충전할 것으로 예상된다.&lt;/p&gt;

&lt;p&gt;그러므로 16개 cluster들 중 거의 대부분 주택에서 충전하는 운전자들에 대응하는 3개 cluster (위 dendogram에서의 B-Orange) 에 대한 $P(G)$의 합이 67%가 되게 확률을 조정하였다.&lt;/p&gt;

&lt;p&gt;또한 주택 충전의 3분의 2가 타이머 기반 자동 충전 (오후 11시 또는 자정에 시작) 을 할 것으로 예상된다. 그러므로 시나리오 1에서는, 각 cluster의 운전자가 segment들 중 주택에서 충전할 경우의 GMM 모델에 대해 타이머 기반 자동 충전에 대응되는 component들의 weight를 증가시켰다.&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;
&lt;b&gt;시나리오 2: 주택에서의 충전이 임의적으로 이루어지는 경우&lt;/b&gt;&lt;/p&gt;

&lt;p&gt;시나리오 1에서는 주택의 계시별 요금제 및 타이머 기반 자동 충전을 가정했다. 그러나 실제로는 주택 사용자들이 계시별 요금제를 채택하지도 않고 그 결과 타이머 기반 충전을 하지 않을 수도 있다. 일종의 ‘uncontrolled charging’ (임의적 충전) 으로 볼 수 있다.&lt;/p&gt;

&lt;p&gt;시나리오 2에서는 uncontrolled charging을 시뮬레이션한다. 이를 위해 시나리오 1과는 반대로, 타이머 기반 자동 충전에 대응되는 component들의 weight를 감소시켰다.&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;
&lt;b&gt;시나리오 3: 직장에서의 충전 시간대를 분산시키는 경우&lt;/b&gt;&lt;/p&gt;

&lt;p&gt;거의 대부분을 직장에서 충전하는 운전자들에 대응하는 cluster들에 대한 시간별 충전 profile을 보면 (위 16개 cluster 각각의 충전 profile 그림의 1~3번째), 대략 10시 경에 뾰족한 피크부하가 형성된다. 이는 직장에서 충전하는 운전자들 대다수가 직장에 도착하자마자 (즉 비슷한 시간에) 충전을 시작하기 때문으로 추정된다.&lt;/p&gt;

&lt;p&gt;이러한 피크부하는 계통에 부담을 주므로, 부하 평준화가 필요하다. 시나리오 3에서는, 어떤 인센티브 정책에 의해 직장에서 충전하는 운전자들의 상당수가 정오 이후에 충전을 시작하는 경우를 시뮬레이션한다.&lt;/p&gt;

&lt;p&gt;이를 위해, 직장에서도 충전하는 운전자들이 직장에서 충전할 경우의 GMM 모델에 대해 정오 이후의 충전에 대응되는 component들의 weight를 증가시켰다.&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;
&lt;b&gt;시나리오 4: 재택근무자 증가로 주택에서의 아침~오후 충전 비중이 증가할 경우&lt;/b&gt;&lt;/p&gt;

&lt;p&gt;시나리오 1과 2에서는 주택에서의 충전이 거의 대부분 야간에 이루어진다고 가정했다. 그러나 최근 재택근무 (working from home) 이 증가하고 있다. 이 경우, 주택에서의 충전 중 아침~오후 시간대에 이루어지는 충전의 비중이 증가할 수 있다.&lt;/p&gt;

&lt;p&gt;시나리오 4에서는, 주택에서 충전하는 운전자들의 cluster (dendogram에서의 B-Orange) 및 주택 segment 내 충전에 대한 GMM 모델에서 아침~오후 시간대 충전에 대응되는 component들의 weight를 증가시켰다.&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;
&lt;h2 id=&quot;논문의-case-study-결과-주택-내-충전에-의한-야간-피크부하-발생&quot;&gt;논문의 case study: 결과 (주택 내 충전에 의한 야간 피크부하 발생)&lt;/h2&gt;

&lt;p&gt;4개의 시나리오 각각에 대해, 전기차 8백만대가 하루 동안 발생시킬 것으로 예측되는 총 충전 부하를 시뮬레이션한 결과는 아래 그림과 같다.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/evestimates/scenarios.png&quot; alt=&quot;scenarios&quot; class=&quot;align-center&quot; /&gt;
&lt;em&gt;4개 시나리오에 대해 전기차 8백만대의 총 충전 부하를 시뮬레이션한 결과.&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;주목할 부분은 시나리오 1 (위 그림의 (a)) 에서 야간에 발생하는 피크부하 (약 7GW) 및 오후 11시를 기점으로 하는 부하 급증이다. 이는 대부분의 운전자가 계시별 요금제에 대응하여 특정 시간에 충전을 시작하도록 타이머를 쓰고, 그 결과 대부분의 주택 운전자들의 충전 시작 시간대가 거의 같아지기 때문이다.&lt;/p&gt;

&lt;p&gt;현재 California 전력계통의 주간 피크가 약 25GW임을 감안하면, 계시별 요금제 적용 시 주택 내에서 타이머에 기반해 이루어지는 전기차 자동 충전에 의해 매우 큰 야간 피크부하가 발생하고, 심지어 해당 피크부하 발생 직전의 ramp rate 또한 매우 커서, 계통 안정성이 위협받을 것으로 추정된다.&lt;/p&gt;

&lt;p&gt;따라서 향후 주택 내 전기차 충전 요금제는, 운전자들의 충전 시작 시간을 분산시킬 수 있도록 설계할 필요가 있다는 결론을 얻는다.&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;
&lt;h2 id=&quot;저자의-data-driven-modeling-강의&quot;&gt;저자의 data-driven modeling 강의&lt;/h2&gt;

&lt;p&gt;해당 연구를 주도한 연구자이자 논문 교신저자인 &lt;a href=&quot;https://cee.stanford.edu/people/ram-rajagopal&quot;&gt;Ram Rajagopal (Stanford Univ.)&lt;/a&gt; 가, 해당 연구 내용을 포함하는 세미나 ‘Data-Driven Modeling of Distributed Energy Resources and Applications’ 를 &lt;a href=&quot;https://energy-markets-school.dk/school-2023/&quot;&gt;DTU Summer School 2023&lt;/a&gt;에서 진행하였다 (아래 영상 참고).&lt;/p&gt;

&lt;!-- Courtesy of embedresponsively.com --&gt;

&lt;div class=&quot;responsive-video-container&quot;&gt;
    &lt;iframe src=&quot;https://www.youtube-nocookie.com/embed/J83ac7ZKwVo&quot; frameborder=&quot;0&quot; webkitallowfullscreen=&quot;&quot; mozallowfullscreen=&quot;&quot; allowfullscreen=&quot;&quot;&gt;&lt;/iframe&gt;
  &lt;/div&gt;

</description>
        <pubDate>Sat, 21 Oct 2023 00:00:00 +0900</pubDate>
        <link>https://song4energyndata.github.io/evestimate.html</link>
        <guid isPermaLink="true">https://song4energyndata.github.io/evestimate.html</guid>
        
        <category>전기차</category>
        
        <category>부하패턴</category>
        
        <category>Clustering</category>
        
        <category>GMM</category>
        
        
        <category>dataset</category>
        
      </item>
    
      <item>
        <title>재생발전 비중이 높은 전력시장에 대한 심화 주제들</title>
        <description>&lt;p&gt;필자가 정리했던 &lt;a href=&quot;https://song4energyndata.github.io/jalalone.html&quot;&gt;Jalal Kazempour 교수의 전력시장 강의&lt;/a&gt;에서 reference로써 추천한 책으로, &lt;a href=&quot;https://link.springer.com/book/10.1007/978-1-4614-9411-9&quot;&gt;Integrating Renewables in Electricity Markets: Operational Problems&lt;/a&gt; 이 있다.&lt;/p&gt;

&lt;p&gt;강의 내용에 더해 해당 책을 공부하며, 하루전 시장과 실시간 시장으로 구성된 전력시장의 수리모델링에 대해 더 깊게 이해할 수 있었다.&lt;/p&gt;

&lt;p&gt;앞으로 우리나라에서도 &lt;a href=&quot;https://www.electimes.com/news/articleView.html?idxno=325061&quot;&gt;2024년부터 제주도에서 실시간 시장이 시범 실시되며 몇 년 내로 육지에서도 실시될 예정&lt;/a&gt;인 만큼, 에너지시스템 모델링 전문가를 지향한다면 해당 주제에 대해 미리 공부해놓는 것이 당연하다 하겠다.&lt;/p&gt;

&lt;p&gt;이번 포스팅에서는, 해당 책 내용 중 Jalal 교수의 강의에서 다루지 않았으나 현실 세계에서 자주 볼 법한, 그러면서도 지나치게 복잡하지는 않은 (즉 우선순위가 높아 보이는) 모델들을 정리하였다.&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;
&lt;h2 id=&quot;예비력을-포함한-market-clearing&quot;&gt;예비력을 포함한 market clearing&lt;/h2&gt;

&lt;p&gt;급전 계획에서 각 발전기의 출력은, 총 공급과 총 수요가 일치하도록 결정된다. 그런데 실제로는, 계획 대비 실시간에서의 총 수요가 더 클 수 있다. 이 때 수요 증가에 ‘신속하게’ 대응할 수 있도록, 예비력 (reserve capacity) 을 확보해야 한다.&lt;/p&gt;

&lt;p&gt;예비력을 제공하는 발전기에 대해, 급전과 별개로 예비력에 대해서도 비용을 지불하는 경우에 대한 최적 계획 문제를 보자.&lt;/p&gt;

&lt;p&gt;발전기 A는 용량 100 MW, offer price는 MWh당 10달러이고, 발전기 B는 용량 100 MW, offer price는 MWh당 20달러이다.&lt;/p&gt;

&lt;p&gt;한편 예상되는 총 수요는 130 MW 이지만, 예비력을 20 MW 확보해야 한다. 발전기 A는 예비력을 무상으로 제공하는 반면, 발전기 B의 예비력에 대한 offer price는 MW당 25달러이다.&lt;/p&gt;

&lt;p&gt;이 때 발전량과 예비력을 동시에 구하는 market clearing problem은 아래와 같다. (Unit commitment 제약들은 무시했다.)&lt;/p&gt;

&lt;p&gt;Min. $10 P_A + 30 P_B + 0 R_A + 25 R_B$&lt;/p&gt;

&lt;p&gt;Subject to&lt;/p&gt;

&lt;p&gt;$ P_A + P_B = 130$ : $\lambda_P$&lt;/p&gt;

&lt;p&gt;$ R_A + R_B = 20$ : $\lambda_R$&lt;/p&gt;

&lt;p&gt;$ P_A + R_A \leq 100$, $P_A \geq 0$, $R_A \geq 0$&lt;/p&gt;

&lt;p&gt;$ P_B + R_B \leq 100$, $P_B \geq 0$, $R_B \geq 0$&lt;/p&gt;

&lt;p&gt;예상 수요와 요구되는 예비력을 충족해야 하면서, 각 발전기 별로 실제 발전량과 예비력 제공량의 합이 용량을 초과할 수 없다는 제약 하에, 비용을 최소화하는 발전기 별 발전량과 예비력 제공량을 구한다.&lt;/p&gt;

&lt;p&gt;이 때 예상 수요 충족 제약의 dual variable $\lambda_P$는 energy price이고, 요구되는 예비력 충족 제약의 dual variable $\lambda_R$은 reserve capacity price이다.&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;
위 문제에서는 예비력 제공량이 미리 정해진 요구치 20 MW 를 반드시 충족해야 했다. 여기에는, 총 수요가 갑자기 20 MW 증가할 가능성이 어느 정도 있으며 해당 수요 증가분을 충족하지 못할 경우 심각한 손해를 입을 것이라는 가정이 암묵적으로 깔려 있다.&lt;/p&gt;

&lt;p&gt;만약 수요가 갑자기 20 MW 증가할 가능성이 매우 낮거나, 증가한 수요를 충족하지 못하더라도 그로 인해 입는 손실이 그다지 크지 않다면, 예비력을 20 MW 제공하는 것이 경제성 측면에서 최선이 아닐 수 있다.&lt;/p&gt;

&lt;p&gt;이를테면 수요가 갑자기 20 MW 증가할 확률이 5퍼센트이고, 갑자기 증가한 수요를 충족하지 못할 경우의 경제적 손실은 MWh당 1000달러라 하자. 이 때 예비력 제공량을 결정하는 문제는 아래와 같다.&lt;/p&gt;

&lt;p&gt;Min. $10 P_A + 30 P_B + 0 R_A + 25 R_B + 0.05 (10 r_A + 30 r_B + 1000 L^{shed})$&lt;/p&gt;

&lt;p&gt;Subject to&lt;/p&gt;

&lt;p&gt;$r_A \leq R_A$&lt;/p&gt;

&lt;p&gt;$r_B \leq R_B$&lt;/p&gt;

&lt;p&gt;$ P_A + P_B = 130$ : $\lambda_P$&lt;/p&gt;

&lt;p&gt;$ P_A + R_A \leq 100$&lt;/p&gt;

&lt;p&gt;$ P_B + R_B \leq 100$&lt;/p&gt;

&lt;p&gt;$ r_A + r_B + L^{shed} = 20 $&lt;/p&gt;

&lt;p&gt;$P_A, P_B, R_A, R_B, r_A, r_B, L^{shed} \geq 0$&lt;/p&gt;

&lt;p&gt;위에서 $r_A$와 $r_B$는 총 수요가 20 MW 증가할 경우에 각 발전기의 출력 증가량이고, $ L^{shed}$는 증가한 수요 중 충족하지 못한 양이다.&lt;/p&gt;

&lt;p&gt;이 문제를 풀어 얻는 $R_A + R_B$가 예비력 제공량이다. 수요 증가 확률 및 공급 부족에 의한 손실이 얼마나 큰가에 따라, 최적의 예비력 제공량은 20 MW 일 수도, 그보다 작을 수도, 아예 0일 수도 있다.&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;
&lt;h2 id=&quot;stochastic-market-clearing-시의-매출-계산&quot;&gt;Stochastic market clearing 시의 매출 계산&lt;/h2&gt;

&lt;p&gt;Stochastic market clearing 문제에서 하루전 시장 수요-공급 일치 조건의 (bus $n$에서의) dual variable을 $\lambda_n^{D}$라 하자. 그러면 하루전 시장에서의 가격은 $\lambda_n^{D}$이다.&lt;/p&gt;

&lt;p&gt;한편 실시간 시장에서 시나리오 $\omega$ 하에 수요-공급 일치 조건의 dual variable을 $\gamma_{n \omega}$라 하자. 그리고 시나리오 $\omega$의 확률을 $\pi_{\omega}$라 하자. 그러면 해당 시나리오 하에 실시간 시장에서의 가격은 $\pi_{\omega}$이다.&lt;/p&gt;

&lt;p&gt;하루전 시장과 실시간 시장에서의 총 매출은, 하루전 시장에서 계획된 에너지 판매량을 $E$, 실시간 시장에서 시나리오 $\omega$ 하에 balancing을 위해 ‘추가적으로’ 판매하거나 수요처인 경우 소비를 줄인 에너지를 $\Delta E_{\omega}$라 할 때 아래와 같이 계산된다.&lt;/p&gt;

&lt;p&gt;$\lambda_n^{D} E + (\gamma_{n \omega}/\pi_{\omega}) \Delta E_{\omega}$&lt;/p&gt;

&lt;p&gt;$\gamma_{n \omega}$를 $\pi_{\omega}$로 나눠주는 이유는, 하루전 시장과 실시간 시장을 모두 포함하는 최적화 문제에서는 각 시나리오 별 subproblem의 목적함수에 이미 $\pi_{\omega}$가 곱해져 있으므로, dual variable이 ‘$\pi_{\omega}$만큼 scaling된’ sensitivity이기 때문이다.&lt;/p&gt;

&lt;p&gt;($E$가 음수면 에너지를 소비한 것, $\Delta E$가 음수면 발전량을 줄이거나 에너지를 추가로 소비한 것이다.)&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;
&lt;h2 id=&quot;실시간-시장에서-각-참가자들의-수익&quot;&gt;실시간 시장에서 각 참가자들의 수익&lt;/h2&gt;

&lt;p&gt;하루전 시장에서의 market clearing price를 $\lambda^{S}$, 실시간 시장에서의 market clearing price를 $\lambda^{B}$라 하자.&lt;/p&gt;

&lt;p&gt;만약 실시간 시장에서의 total ‘net’ demand (총 부하에서 재생발전을 뺀 ‘순’부하) 가 ‘계획된’ 급전발전량을 초과하면 (즉 excess consumption이면), 도출된 market clearing price들에 대해 $\lambda^{B} \geq \lambda^{S}$ 가 성립한다.&lt;/p&gt;

&lt;p&gt;또한 하루전 시장에서와 실시간 시장에서의 순부하를 각각 $P_N^{S}$와 $P_N^{B}$라 할 때, 급전가능 발전기들은 전일시장에서 총합 $P_N^{S}$만큼의 전력을 공급하기로 계획되었을 것이므로, 실시간 시장에서 급전가능 발전기들이 추가로 얻는 총 매출은 $(P_N^{B}-P_N^{S}) \lambda^{B} &amp;gt; 0$ 이다.&lt;/p&gt;

&lt;p&gt;이 때 각각의 재생 (즉 급전불가능) 발전기 $j$가 실시간 시장에서 얻는 매출은 얼마일까?&lt;/p&gt;

&lt;p&gt;재생발전기 $j$가 하루전 시장에서 예상한 발전량을 $P_{Uj}^{S}$, 실시간 시장에서의 실제 발전량을 $P_{Uj}^{B}$라 하자. 그러면 실시간 시장에서의 매출은 $(P_{Uj}^{B} - P_{Uj}^{S}) \lambda^{B}$ 이다.&lt;/p&gt;

&lt;p&gt;만약 재생발전기 $j$가 ‘하루전 시장에서 예상된 발전량 대비’ 실제로 더 적게 발전했다면, 즉 $P_{Uj}^{B} &amp;lt; P_{Uj}^{S}$ 라면, 매출은 음수이다.&lt;/p&gt;

&lt;p&gt;이를 ‘급전발전기로부터 $(P_{Uj}^{B} - P_{Uj}^{S})$ 만큼의 전력을 구입해서 계획된 발전량을 맞추는 것’으로 해석한다면, $\lambda^{B} \geq \lambda^{S}$ 이므로 ‘실시간 시장에서 하루전 시장 대비 더 비싼 가격으로 전기를 구입하는’ penalty를 감수하는 셈이다. 이 penalty는 ‘재생발전기 $j$가 excess consumption을 악화시키는 역할을 했으므로’ 받는 것으로 해석할 수 있다.&lt;/p&gt;

&lt;p&gt;반대로 재생발전기 $j$가 ‘하루전 시장에서 예상된 발전량 대비’ 실제로 더 많이 발전했다면, 즉 $P_{Uj}^{B} &amp;gt; P_{Uj}^{S}$ 라면, 매출은 양수이다.&lt;/p&gt;

&lt;p&gt;이는 ‘실시간 시장에서 $(P_{Uj}^{B} - P_{Uj}^{S})$ 만큼의 전력을 하루전 시장 대비 더 비싼 가격으로 판매하는’ advantage를 얻는 셈이다. 이 advantage는 ‘재생발전기 $j$가 (비록 자기의지는 아니지만) excess consumption을 해소하는 역할을 했으므로’ 얻는 것으로 해석할 수 있다.&lt;/p&gt;

&lt;p&gt;한편 수요처 $k$에서도 하루전 시장에서 계획한 부하 $P_{Dk}^{S}$와 실시간 시장에서의 실제 부하 $P_{Dk}^{B}$가 서로 다를 수 있다. 그러면 실시간 시장에서 지불해야 하는 금액은 $(P_{Dk}^{B} - P_{Dk}^{S}) \lambda^{B}$ 이다.&lt;/p&gt;

&lt;p&gt;만약 수요처 $k$가 ‘하루전 시장에서 계획된 부하 대비’ 실제로 더 많은 에너지를 소비했다면, 즉 $P_{Dk}^{B} &amp;gt; P_{Dk}^{S}$ 라면, 지불해야 하는 금액은 양수이다.&lt;/p&gt;

&lt;p&gt;이는 부하 증가에 의한 추가적인 에너지를 ‘하루전 시장 대비 더 비싼 가격으로 구매하는’ penalty를 감수하는 셈이다. 이 penalty는 ‘부하 $k$가 excess consumption을 악화시키는 역할을 했으므로’ 받는 것으로 해석할 수 있다.&lt;/p&gt;

&lt;p&gt;반대로 수요처 $k$가 ‘하루전 시장에서 계획된 부하 대비’ 실제로 더 적은 에너지를 소비했다면, 즉 $P_{Dk}^{B} &amp;lt; P_{Dk}^{S}$ 라면, 지불해야 하는 금액은 음수이다.&lt;/p&gt;

&lt;p&gt;이는 부하 감소에 의한 잉여 에너지를 ‘하루전 시장 대비 더 비싼 가격으로 판매하는’ advantage를 얻는 셈이다. 이 advantage는 ‘부하 $k$가 excess consumption을 해소하는 역할을 했으므로’ 얻는 것으로 해석할 수 있다.&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;
지금까지의 논의와 반대로, 만약 실시간 시장에서의 total ‘net’ demand (총 부하에서 재생발전을 뺀 ‘순’부하) 가 ‘계획된’ 급전발전량보다 적으면 (즉 excess production이면), 도출된 market clearing price들에 대해 $\lambda^{B} \leq \lambda^{S}$ 가 성립한다.&lt;/p&gt;

&lt;p&gt;이 경우 급전가능 발전기들이 하루전 시장 대비 출력을 줄임으로써 시장에 되돌려줘야 하는 금액의 총 합은 $(P_N^{S}-P_N^{B}) \lambda^{B} &amp;gt; 0$ 이다.&lt;/p&gt;

&lt;p&gt;재생발전기 $j$가 ‘하루전 시장에서 예상된 발전량 대비’ 실제로 더 적게 발전했다면, 실시간 시장에서의 매출 $(P_{Uj}^{B} - P_{Uj}^{S}) \lambda^{B}$ 은 음수이다.&lt;/p&gt;

&lt;p&gt;이는 실시간 시장으로부터 $(P_{Uj}^{B} - P_{Uj}^{S})$ 만큼의 전력을 ‘더 저렴한 가격으로’ 구매하는 advantage를 얻는 셈이다. 이 advantage는 ‘재생발전기 $j$가 (비록 자기의지는 아니지만) excess production을 해소하는 역할을 했으므로’ 얻는 것으로 해석할 수 있다.&lt;/p&gt;

&lt;p&gt;반대로 재생발전기 $j$가 ‘하루전 시장에서 예상된 발전량 대비’ 실제로 더 많이 발전했다면, 실시간 시장에서의 매출 $(P_{Uj}^{B} - P_{Uj}^{S}) \lambda^{B}$ 은 양수이다.&lt;/p&gt;

&lt;p&gt;이는 실시간 시장에서 $(P_{Uj}^{B} - P_{Uj}^{S})$ 만큼의 잉여전력을 ‘더 낮은 가격에’ 판매하는 penalty를 감수하는 셈이다. 이 penalty는 ‘재생발전기 $j$가 excess production을 악화시키는 역할을 했으므로’ 받는 것으로 해석할 수 있다.&lt;/p&gt;

&lt;p&gt;한편 수요처 $k$가 실시간 시장에서 지불해야 하는 금액은 $(P_{Dk}^{B} - P_{Dk}^{S}) \lambda^{B}$ 이다.&lt;/p&gt;

&lt;p&gt;만약 수요처 $k$가 ‘하루전 시장에서 계획된 부하 대비’ 실제로 더 많은 에너지를 소비했다면, 즉 $P_{Dk}^{B} &amp;gt; P_{Dk}^{S}$ 라면, 지불해야 하는 금액은 양수이다.&lt;/p&gt;

&lt;p&gt;이는 부하 증가에 의한 추가적인 에너지를 ‘하루전 시장 대비 더 저렴한 가격으로 구매하는’ advantage를 얻는 셈이다. 이 penalty는 ‘부하 $k$가 excess production을 해소하는 역할을 했으므로’ 받는 것으로 해석할 수 있다.&lt;/p&gt;

&lt;p&gt;반대로 수요처 $k$가 ‘하루전 시장에서 계획된 부하 대비’ 실제로 더 적은 에너지를 소비했다면, 즉 $P_{Dk}^{B} &amp;lt; P_{Dk}^{S}$ 라면, 지불해야 하는 금액은 음수이다.&lt;/p&gt;

&lt;p&gt;이는 부하 감소에 의한 잉여 에너지를 ‘하루전 시장 대비 더 비싼 가격으로 판매하는’ penalty를 감수하는 셈이다. 이 advantage는 ‘부하 $k$가 excess production을 악화시키는 역할을 했으므로’ 얻는 것으로 해석할 수 있다.&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;
&lt;h2 id=&quot;재생발전의-merit-order-effect&quot;&gt;재생발전의 merit-order effect&lt;/h2&gt;

&lt;p&gt;태양광/ 풍력 등 재생발전원은 일단 설치되었다면 일반적으로 ‘1단위의 전기를 더 생산하기 위한 marginal cost’가 거의 zero이다.&lt;/p&gt;

&lt;p&gt;그러므로 급전 시 최우선순위를 부여받고, marginal cost가 상대적으로 작은 급전가능 발전기들로도 net demand를 충당할 수 있게 된다. Marginal cost가 높은 급전가능 발전기들의 순위는 밀리게 된다.&lt;/p&gt;

&lt;p&gt;그 결과, 재생발전 비중이 증가할수록 전력 도매가격이 하락하는데, 이를 merit-order effect라 한다.&lt;/p&gt;

&lt;p&gt;한편 재생발전 비중이 높으면 수요-공급 곡선에서 공급곡선 위치의 불확실성이 증가하므로, 이에 따라 수요곡선과 공급곡선이 만나는 점 및 시장가격의 불확실성도 증가한다.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/jalal/Lecture7_8.png&quot; alt=&quot;clearingexample&quot; /&gt;&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;
&lt;h2 id=&quot;flexible-demand의-수리모델&quot;&gt;Flexible demand의 수리모델&lt;/h2&gt;

&lt;p&gt;Flexible demand란, ‘일정 범위 내에서’ 전기 소비량을 결정할 수 있으며, 하루전 시장에서 계획된 부하를 실시간 시장에서 능동적으로 변경할 수 있는 전기 수요를 말한다.&lt;/p&gt;

&lt;p&gt;Flexible demand $k$에 대해, 하루전 시장에서 $t$시에 대해 계획된 부하를 $d_k(t)$, 실시간 시장에서 stochasticity scenario $\omega$가 실현된 경우의 실제 부하를 $d_{k \omega}(t)$, 계획된 부하 대비 실제 부하를 증가시킬 경우 (발전기로 치면 down-regulation) 그 증가분을 $c_{k \omega}^{D}(t)$, 계획된 부하 대비 실제 부하를 감소시킬 경우 (발전기로 치면 up-regulation) 그 감소분을 $c_{k \omega}^{U}(t)$ 라 하자.&lt;/p&gt;

&lt;p&gt;그리고 각 시간별로 flexible demand $k$의 $t$시 부하의 하한과 상한을 각각 $D_k^{min}(t)$ 와 $D_k^{max}(t)$, ‘하루 동안에 최소로 공급되어야 하는 총 에너지’를 $E_k^{day}$라 하자.&lt;/p&gt;

&lt;p&gt;그러면, 아래 수식들이 성립한다.&lt;/p&gt;

&lt;p&gt;$d_{k \omega}(t) = d_k(t) + c_{k \omega}^{D}(t) - c_{k \omega}^{U}(t) $&lt;/p&gt;

&lt;p&gt;$0 \leq c_{k \omega}^{D}(t) \leq D_k^{max}(t) - d_k(t)$&lt;/p&gt;

&lt;p&gt;$0 \leq c_{k \omega}^{U}(t) \leq d_k(t) - D_k^{min}(t) $&lt;/p&gt;

&lt;p&gt;$\sum_{t=1}^T d_{k \omega}(t) \geq E_k^{day} $&lt;/p&gt;

&lt;p&gt;만약 발전기의 ramping limit처럼 flexible demand에서도 1시간 동안 감소시키거나 증가시킬 수 있는 부하량 각각의 상한이 $D_k^{D}$와 $D_k^{U}$로 존재한다고 하면, 아래 수식들도 성립한다.&lt;/p&gt;

&lt;p&gt;$ d_{k \omega}(t) - d_{k \omega}(t-1) \leq D_k^{U}$&lt;/p&gt;

&lt;p&gt;$ d_{k \omega}(t-1) - d_{k \omega}(t) \leq D_k^{D}$&lt;/p&gt;

&lt;p&gt;Flexible demand의 최적의 스케줄 도출을 위해서는 목적함수에 flexible demand에 대한 term들을 추가해야 한다. 이 때 해당 flexible demand가 전기를 공급받아서 얻는 ‘효용 (utility)’, 그리고 실시간 시장에서 부하를 조정해서 얻는 효용을 반영해야 한다.&lt;/p&gt;

&lt;p&gt;해당 flexible demand가 단위 전기를 공급받을 때 얻는 효용을 $U_k(t)$, 실시간 시장에서 부하를 늘릴 때 (down-regulation)와 줄일 때 (up-regulation) 얻는 효용을 각각 $U_k^{D}(t)$와 $U_k^{U}(t)$라 하자. 그리고 시나리오 $\omega$의 확률을 $\pi_{\omega}$라 하자.&lt;/p&gt;

&lt;p&gt;그러면 flexible demand가 얻는 총 효용은 아래와 같다.&lt;/p&gt;

&lt;p&gt;\begin{align} 
\sum_{t=1}^T \lbrace U_k(t) d_k(t) + \sum_{\omega} \pi_{\omega} [U_k^{D}(t) c_{k \omega}^{D}(t) - U_k^{U}(t) c_{k \omega}^{U}(t)] \rbrace
\notag
\end{align}&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;
&lt;h2 id=&quot;flexible-demand-예시-thermal-comfort를-고려한-열부하의-전기-사용량&quot;&gt;Flexible demand 예시: Thermal comfort를 고려한 열부하의 전기 사용량&lt;/h2&gt;

&lt;p&gt;Demand response (DR) 모델링 시, 수요처가 부하로부터 얻는 ‘효용 (utility)’과 부하를 줄여서 얻는 보상을 비교해서 DR 스케줄을 결정하게 된다.&lt;/p&gt;

&lt;p&gt;건물에서 냉난방기기를 제어해 DR을 수행할 경우, 주로 실내온도의 함수로 주어지는 ‘thermal comfort’를 효용으로 둔다. 즉 대상 건물에서 시간별로 가장 선호되는 기준 실내온도를 정한 후, 실제 실내온도가 기준온도에서 많이 벗어날수록 효용이 적다고, 즉 thermal ‘dis’comfort가 크다고 본다.&lt;/p&gt;

&lt;p&gt;시간 $t$에서의 기준 실내온도를 $\hat{x}^{i}_t$, 실제 실내온도를 $x^{i}_t$로 두자. 그러면, ‘기준온도보다 높아도 낮아도 효용이 줄어드는’ 것을 고려해 목적함수의 thermal discomfort term을 $\sum_{t} c (x^{i}_t - \hat{x}^{i}_t)^2$ 로 둘 수 있다 ($c$는 comfort의 가치를 반영하는 계수이며, $c$가 클수록 comfort를 중요하게 생각한다).&lt;/p&gt;

&lt;p&gt;목적함수에는 thermal discomfort term 뿐 아니라, 건물 온도를 기준 온도에 가깝게 유지하는 데 드는 에너지 요금도 포함되어야 한다. 그래야 thermal comfort와 에너지 사용 간 trade-off를 구할 수 있기 때문이다.&lt;/p&gt;

&lt;p&gt;해당 건물이 난방을 전기온수보일러로 수행하고, 전기온수보일러의 시간 $t$에서의 전기 소비량 $u_t$와 온수탱크 내 온도 $x^{w}_t$ 및 실내온도 $x^{i}_t$ 간의 관계를 아래와 같은 linear state-space model로 나타낼 수 있다고 하자.&lt;/p&gt;

&lt;p&gt;\begin{align}
\begin{bmatrix}
  x^{i}_{t+1} \newline
  x^{w}_{t+1}
  \end{bmatrix} = \begin{bmatrix}
  a_{11} &amp;amp; a_{12} \newline
  0 &amp;amp; a_{22}
  \end{bmatrix} \begin{bmatrix}
  x^{i}_{t} \newline
  x^{w}_{t}
  \end{bmatrix} + \begin{bmatrix}
  0 \newline
  b_2
  \end{bmatrix} u_t
\notag
\end{align}&lt;/p&gt;

&lt;p&gt;그러면 최적화 문제는, 위 linear state-space model을 제약조건으로 하고 아래의 항을 목적함수로 하는 quadratic programming problem이 된다.&lt;/p&gt;

&lt;p&gt;$ \sum_{t} c (x^{i}_t - \hat{x}^{i}_t)^2 + \lambda^{R}_t u_t$&lt;/p&gt;

&lt;p&gt;여기서 $\lambda^{R}_t$는 시간 $t$에서의 사용량요금이다.&lt;/p&gt;
</description>
        <pubDate>Sat, 07 Oct 2023 00:00:00 +0900</pubDate>
        <link>https://song4energyndata.github.io/marketadvanced.html</link>
        <guid isPermaLink="true">https://song4energyndata.github.io/marketadvanced.html</guid>
        
        <category>전력시장</category>
        
        <category>에너지시스템</category>
        
        
        <category>market</category>
        
      </item>
    
      <item>
        <title>에너지효율 R&amp;D 투자효과 분석 (패널 데이터 기반) 연구 복원</title>
        <description>&lt;p&gt;에너지정책의 효과를 ‘정량적으로’ 분석하는 방법으로, 회귀분석의 일종인 ‘패널 분석’ (Panel data analysis) 이 있다. 이를테면 에너지경제연구원에서는 에너지효율 R&amp;amp;D 투자가 에너지소비 감소에 기여했는지 여부를 검정하기 위해, &lt;a href=&quot;https://www.keei.re.kr/main.nsf/index.html?open&amp;amp;p=/web_keei/d_results.nsf/0/BE8E066A1FCE159A49258107001E2AA9&quot;&gt;“에너지효율향상 R&amp;amp;D 투자효과 분석 및 정책방향 연구”&lt;/a&gt; 를 수행한 바 있다.&lt;/p&gt;

&lt;p&gt;해당 연구에서는 1985년부터 2013년까지 연도별로 12개 국가 각각의 에너지소비량/ R&amp;amp;D투자/ 통제대상변수들 데이터를 사용해, 에너지효율향상 R&amp;amp;D가 에너지소비량 절감에 유의미한 영향을 주었는지를 알아보았다. 이러한 데이터는 ‘여러 개체’ 를 ‘여러 시간’ 에 걸쳐 관측해 얻은 데이터이며, 이러한 데이터를 패널 데이터라고 한다.&lt;/p&gt;

&lt;p&gt;이번 포스팅에서는, 필자가 패널데이터분석 실무 공부를 위해 해당 연구 결과의 복원을 시도한 결과를 정리하였다.&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;
&lt;h2 id=&quot;연구-상세&quot;&gt;연구 상세&lt;/h2&gt;

&lt;p&gt;12개 국가 목록은 노르웨이/ 네덜란드/ 덴마크/ 독일/ 미국/ 스페인/ 스웨덴/ 영국/ 오스트리아/ 일본/ 포르투갈 이다.&lt;/p&gt;

&lt;p&gt;해당 패널분석에서 반응변수는 ‘1인당’ 에너지 소비량이다. 설명변수들은 ‘1인당’ GDP/ 에너지 가격 지수/ 난방도일/ ‘1인당’ R&amp;amp;D 투자 축적량이다. 에너지 소비량에 큰 영향을 미치는 요소로 GDP/ 에너지가격/ 난방에너지사용량/ 인구수 가 있으므로, 이들을 통제한 상태에서 R&amp;amp;D투자의 효과를 계산하기 위함이다.&lt;/p&gt;

&lt;p&gt;구체적으로는 변수들에 로그를 취해서 계수추정량이 탄력성을 의미하도록 하였다. 또한 명시적으로 반영하지 못한 변수들 (즉 오차항의 성분) 중 각 국가별로 시간에 관계없이 고유하게 가지면서 설명변수들과 상관된 요소가 존재할 수 있으므로 (이를테면 문화적 요소 등), 이를 고려한 고정효과 (fixed effect) 모델 및 1계차분 (first-order difference) 모델의 계수를 도출하였다.&lt;/p&gt;

&lt;p&gt;고정효과 모델의 수식은 아래와 같다.&lt;/p&gt;

&lt;p&gt;$\text{ln}(\frac{EC}{Pop})_{i,t} = \beta_0 + \beta_1 \text{ln}(\frac{GDP}{Pop})_{i,t} + \beta_2 \text{ln}(EP)_{i,t} + \beta_3 \text{ln}(HDD)_{i,t} + \beta_4 \text{ln}(\frac{AccRnD}{Pop})_{i,t} + u_i + e_{i,t}$&lt;/p&gt;

&lt;p&gt;첨자 $i$와 $t$는 각각 나라와 연도를 의미한다. $EC$는 에너지 소비량, $Pop$는 인구수, $GDP$는 총 GDP, $EP$는 에너지 가격 지수, $HDD$는 난방도일, $AccRnD$는 해당 연도까지의 에너지효율 R&amp;amp;D 투자액의 축적량이다 (단, 모든 연도의 투자액을 단순히 더하지 않고 감가율을 적용하였다). 오차항에서 $u_i$는 시간에 관계없는 국가 고유의 요소들 (문화적 요소 등), $e_{i,t}$는 국가 및 시간별로 변하는 요소들을 의미한다.&lt;/p&gt;

&lt;p&gt;1계차분 모델의 수식은 아래와 같다.&lt;/p&gt;

&lt;p&gt;$\Delta \text{ln}(\frac{EC}{Pop})_{i,t} = \beta_1 \Delta \text{ln}(\frac{GDP}{Pop})_{i,t} + \beta_2 \Delta \text{ln}(EP)_{i,t} + \beta_3 \Delta \text{ln}(HDD)_{i,t} + \beta_4 \Delta \text{ln}(\frac{AccRnD}{Pop})_{i,t} + \Delta e_{i,t}$&lt;/p&gt;

&lt;p&gt;해당 연구의 분석기간인 1985~2013년 중 1997년에 교토의정서가 채택되어, 해당 시기 전후로 에너지효율 R&amp;amp;D 투자에 양적/ 질적 차이가 나타날 가능성이 크다. 이를 고려해, 해당 연구에서는 1997년을 기준으로 전기와 후기를 나누어 각각에 대한 추정 및 모든 기간에 대한 변수별 계수추정을 수행하였다.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/energyeffpanel/result_original.png&quot; alt=&quot;systemscheme&quot; class=&quot;align-center&quot; /&gt;
&lt;em&gt;해당 연구의 패널 분석 결과.&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;패널분석으로 도출한 변수 별 계수의 부호를 보면, 에너지가격은 음의 계수를, 1인당 GDP와 난방도일은 양의 계수를 갖는다. 일반적으로 에너지 가격이 상승하면 에너지 소비가 감소하고, GDP와 난방도일이 증가하면 에너지 소비가 증가할 것이라 예상하는데, 패널분석 결과가 예상과 일치한다.&lt;/p&gt;

&lt;p&gt;에너지 효율 R&amp;amp;D 투자 축적은 전기에서는 계수가 통계적으로 유의하지 않았으나, 후기에서는 유의한 음의 계수를 가졌다. 이는 에너지 효율 R&amp;amp;D 투자가 에너지 절감에 기여한다는 예상과 일치하며, 그 효과가 교토의정서 채택 이후 본격적으로 나타났음을 의미한다.&lt;/p&gt;

&lt;p&gt;(단, 고정효과 회귀와 1계차분 회귀의 계수들의 값들 및 유의성은 서로 다르다. 그래서 보통 두 회귀를 모두 수행 후, 부호가 일치하는지를 본다. 그리고 모든 항들에 자연로그를 취했으므로, 계수의 값은 ‘한 나라 내에서 다른 설명변수들의 불변 가정 하에 해당 설명변수가 현재 대비 1% 증가 시 반응변수의 퍼센트 기준 증감’을 의미한다.)&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;
&lt;h2 id=&quot;복원을-위한-데이터-수집&quot;&gt;복원을 위한 데이터 수집&lt;/h2&gt;

&lt;p&gt;반응변수의 경우, &lt;a href=&quot;https://data.oecd.org/energy/primary-energy-supply.htm&quot;&gt;OECD database의 1차에너지 (primary energy supply)&lt;/a&gt; 를 사용하였다. 설명변수들 중 &lt;a href=&quot;https://data.oecd.org/gdp/gross-domestic-product-gdp.htm&quot;&gt;GDP&lt;/a&gt;, &lt;a href=&quot;https://data.oecd.org/pop/population.htm&quot;&gt;인구수&lt;/a&gt;, &lt;a href=&quot;https://stats.oecd.org/BrandedView.aspx?oecd_bv_id=enetech-data-en&amp;amp;doi=data-00488-en&quot;&gt;에너지효율 R&amp;amp;D 투자액&lt;/a&gt; 또한 OECD database에서 찾은 값들을 사용하였다. 에너지효율 R&amp;amp;D 투자액 자료를 누적 축적량으로 변환하는 방법은 에너지경제연구원 문헌에서 설명한 방법과 같다.&lt;/p&gt;

&lt;p&gt;에너지가격의 경우, 해당 연구에서 사용한 자료를 그대로는 얻을 수 없었다. &lt;a href=&quot;https://www.oecd-ilibrary.org/energy/data/iea-energy-prices-and-taxes-statistics_eneprice-data-en&quot;&gt;IEA의 Energy prices and taxes Database&lt;/a&gt;가 유료회원 전용 자료이기 때문이다.&lt;/p&gt;

&lt;p&gt;그래서, 에너지가격을 누락변수 (ommited variable) 라 할 때, 해당 누락변수와 상관관계가 있어 도구변수 (instrumental variable) 로 쓸 수 있으면서 OECD database에서 구할 수 있는 자료인, &lt;a href=&quot;https://data.oecd.org/energy/crude-oil-import-prices.htm&quot;&gt;Crude oil import prices&lt;/a&gt;를 대신 사용하였다.&lt;/p&gt;

&lt;p&gt;난방도일의 경우, 필자는 스위스/ 영국/ 일본 의 자료를 구할 수 없었다. (IHS와 IEEJ의 자료가 유료이며, 영국의 경우 EU에서 탈퇴하여 Eurostat에서 자료를 찾을 수 없었다.) 그래서, 최종적으로는 &lt;a href=&quot;https://ec.europa.eu/eurostat/web/energy/database&quot;&gt;해당 3개 국가를 제외한 나머지 9개 국가에 대한 자료&lt;/a&gt;를 사용하였다.&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;
&lt;h2 id=&quot;복원-결과&quot;&gt;복원 결과&lt;/h2&gt;

&lt;p&gt;필자가 모은 데이터로 고정효과 회귀를 수행해 도출한 계수별 부호가, 기존 연구 결과와 일치하였다. 교토의정서 이후 기간과 전체 기간에 대해, R&amp;amp;D 투자액 축적과 에너지가격에 대해서는 음의 계수가, GDP와 난방도일에 대해서는 양의 계수가 유의미하게 도출되었다 (클러스터 표준오차 기준).&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/energyeffpanel/result_fe_later.png&quot; alt=&quot;systemscheme&quot; class=&quot;align-center&quot; width=&quot;80%&quot; /&gt;
&lt;img src=&quot;/assets/images/energyeffpanel/result_fe_whole.png&quot; alt=&quot;systemscheme&quot; class=&quot;align-center&quot; width=&quot;80%&quot; /&gt;
&lt;em&gt;필자가 모은 데이터로 fixed effect 회귀를 수행한 결과. (위: 교토의정서 이후 기간, 아래: 전체기간)&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;Hausman test를 통해, 임의효과 (random effect) 가 아닌 고정효과 회귀를 수행해야 함도 확인하였다.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/energyeffpanel/result_hausman.png&quot; alt=&quot;systemscheme&quot; class=&quot;align-center&quot; width=&quot;80%&quot; /&gt;
&lt;em&gt;필자가 모은 데이터로 fixed effect 회귀를 수행한 결과. (위: 교토의정서 이후 기간, 아래: 전체기간)&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;필자가 모은 데이터의 경우, 일계차분 회귀에서는 R&amp;amp;D 투자액 축적의 계수가 작아 유의미하지 않았다. 그러므로 일단은, 필자가 복원한 고정효과 모델에서 관측한 변수별 계수 부호가, 에너지경제연구원의 연구 원본에서의 그것과 같음을 확인했음에 의의를 둔다.&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;
&lt;h2 id=&quot;코드&quot;&gt;코드&lt;/h2&gt;

&lt;p&gt;패널 분석에 사용한 R 코드는 아래와 같다. 필자가 사용한 데이터셋은 &lt;a href=&quot;https://github.com/song4energyndata/Codes/tree/main/paneldata/energyeffrnd&quot;&gt;GitHub Repo&lt;/a&gt;에 있다. Input 데이터 ($\texttt{energyrnd_rndpercapita.csv}$) 에서 첫 번째 열은 각 국가의 인덱스이며 (즉 서로 다른 숫자가 서로 다른 국가를 의미), 두 번째 열은 연도이다.&lt;/p&gt;

&lt;div class=&quot;language-r highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;rm&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;list&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ls&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;())&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;setwd&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dirname&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rstudioapi&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;getActiveDocumentContext&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;$&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;path&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;scriptpath&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;getwd&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cat&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;\014&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;

&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;library&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;plm&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;library&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;lmtest&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;library&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sandwich&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;library&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;multiwayvcov&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;

&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;energyrnddat&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;read.csv&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&apos;energyrnd_rndpercapita.csv&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;energyrnddat.former&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;energyrnddat&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;energyrnddat&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;$&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;year&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;1998&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,]&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# 교토의정서 이전 기간&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;energyrnddat.later&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;energyrnddat&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;energyrnddat&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;$&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;year&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;1997&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,]&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# 교토의정서 이후 기간&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;


&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;model.FE.former&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;plm&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ecperpop&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;~&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;gdpperpop&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;eprice&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;hdd&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;accrndperpop&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;energyrnddat.former&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;within&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;summary&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;model.FE.former&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# Fixed effect regression&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;coeftest&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;model.FE.former&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;vcov&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;vcovHC&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;model.FE.former&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;type&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;sss&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cluster&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;group&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# 클러스터 표준오차&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pwartest&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;model.FE.former&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;

&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;model.FE.later&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;plm&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ecperpop&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;~&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;gdpperpop&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;eprice&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;hdd&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;accrndperpop&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;energyrnddat.later&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;within&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;summary&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;model.FE.later&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;coeftest&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;model.FE.later&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;vcov&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;vcovHC&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;model.FE.later&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;type&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;sss&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cluster&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;group&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; 
&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pwartest&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;model.FE.later&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;

&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;model.FE.whole&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;plm&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ecperpop&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;~&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;gdpperpop&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;eprice&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;hdd&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;accrndperpop&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;energyrnddat&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;within&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;summary&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;model.FE.whole&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;coeftest&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;model.FE.whole&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;vcov&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;vcovHC&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;model.FE.whole&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;type&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;sss&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cluster&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;group&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; 
&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pwartest&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;model.FE.whole&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;


&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;model.RE.former&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;plm&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ecperpop&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;~&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;gdpperpop&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;eprice&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;hdd&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;accrndperpop&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;energyrnddat.former&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;random&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;phtest&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;model.FE.former&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;model.RE.former&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# Hausman test&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;

&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;model.RE.later&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;plm&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ecperpop&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;~&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;gdpperpop&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;eprice&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;hdd&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;accrndperpop&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;energyrnddat.later&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;random&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;phtest&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;model.FE.later&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;model.RE.later&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;


&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;model.FD.former&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;plm&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ecperpop&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;~&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;gdpperpop&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;eprice&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;hdd&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;accrndperpop&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;energyrnddat.former&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;fd&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;summary&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;model.FD.former&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# First-order difference regression&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;

&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;model.FD.later&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;plm&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ecperpop&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;~&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;gdpperpop&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;eprice&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;hdd&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;accrndperpop&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;energyrnddat.later&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;fd&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;summary&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;model.FD.later&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;

&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;model.FD.whole&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;plm&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ecperpop&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;~&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;gdpperpop&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;eprice&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;hdd&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;accrndperpop&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;energyrnddat&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;fd&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;summary&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;model.FD.whole&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;(위 R 코드 내 메서드들이, &lt;a href=&quot;https://product.kyobobook.co.kr/detail/S000001681310&quot;&gt;한치록 교수의 “패널데이터강의”&lt;/a&gt; 에 나오는 Stata 코드 기반 예제들에 대해 같은 데이터로 같은 결과를 도출함을 확인하였다.)&lt;/p&gt;
</description>
        <pubDate>Sun, 24 Sep 2023 00:00:00 +0900</pubDate>
        <link>https://song4energyndata.github.io/energyeffpanel.html</link>
        <guid isPermaLink="true">https://song4energyndata.github.io/energyeffpanel.html</guid>
        
        <category>에너지정책</category>
        
        <category>에너지효율</category>
        
        <category>회귀분석</category>
        
        
        <category>policy</category>
        
      </item>
    
      <item>
        <title>논문 소개: Virtual power plant의 하루전시장 입찰 결정 (stochastic programming 기반)</title>
        <description>&lt;p&gt;Virtual power plant (VPP, 가상발전소) 는 급전가능발전원 (가스터빈 등), 급전불가능발전원 (태양광/ 풍력 등), 에너지저장장치 (배터리/ 양수발전 등) 등 여러 발전/ 전력저장 설비들을 클라우드 등 IT기술 기반으로 한꺼번에 제어해 단일 주체로써 전력시장에 입찰하는 방법이다.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/vppintro/vppconcept.png&quot; alt=&quot;systemscheme&quot; class=&quot;align-center&quot; /&gt;
&lt;em&gt;가상발전소 개념도. (출처: 한국전기연구원)&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;VPP를 통해 다수의 분산전원 사업자들이 보다 쉽게 전력시장에 참여할 수 있고, 급전가능발전원 및 에너지장치를 포함시켜 공급 당일 실제 발전량을 하루전 시장에서의 입찰 전력량과 일치시킬 수 있으며, 필요시 VPP 전체가 주파수 변동 억제 등의 계통안정도 관련 보조서비스를 제공할 수도 있다.&lt;/p&gt;

&lt;p&gt;이 포스팅에서는, VPP가 하루전시장과 실시간시장으로 이루어진 전력시장에 입찰 시 시간별 발전량을 결정하는 방법에 대한 대표적 논문을 소개한다. Applied Energy에서 2013년에 출판된 &lt;a href=&quot;https://doi.org/10.1016/j.apenergy.2012.12.077&quot;&gt;“Offering model for a virtual power plant based on stochastic programming”&lt;/a&gt; 이다.&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;
&lt;h2 id=&quot;경제성-관점에서-vpp의-필요성&quot;&gt;경제성 관점에서 VPP의 필요성&lt;/h2&gt;
&lt;p&gt;VPP가 하루전시장과 실시간시장으로 이루어진 전력시장에 입찰할 경우, 하루전시장에 ‘내일 24시간의 각 시간 별 발전량’ 을 제출한다. VPP는 급전 당일에 재생발전원의 실제 발전량을 관측하고 급전가능발전원과 에너지저장장치를 제어하여, 총 발전량이 하루전시장에 제출했던 시간별 발전량과 일치하도록 한다 (balancing).&lt;/p&gt;

&lt;p&gt;그러나, 만약 재생발전원의 용량은 큰데 급전가능발전원 및 에너지저장장치가 부족하거나 심지어는 없다면, 공급 당일의 총 발전량이 하루전에 제출된 발전량과 다를 것이다. 이러한 차이는 경제적 손실을 야기한다.&lt;/p&gt;

&lt;p&gt;이를테면 특정 시간에 대해 하루전 제출된 급전량은 큰데 풍력발전량이 예상보다 너무 낮아서, 가스터빈을 최대출력으로 가동하고 에너지저장장치를 최대로 방전시켜도 하루전 제출된 발전량보다 부족할 수 있다. 이 경우 balancing을 위해 전력부족분을 실시간 시장에서 더 높은 가격에 구입하므로, 하루전시장에서 전력부족분만큼을 덜 입찰했을 경우와 비교하면 경제적 손실을 본다.&lt;/p&gt;

&lt;p&gt;반대로 특정 시간에 대해 하루전 제출된 발전량은 작은데 풍력발전량이 예상보다 너무 높아서, 가스터빈을 가동하지 않고 에너지저장장치를 최대로 충전시켜도 하루전 제출된 발전량을 초과할 수 있다. 이 경우 balancing을 위해 잉여전력을 실시간 시장에서 더 낮은 가격에 판매하므로, 하루전시장에서 잉여전력분만큼을 더 입찰했을 경우와 비교하면 경제적 손실을 본다.&lt;/p&gt;

&lt;p&gt;가상발전소는 이러한 ‘하루전에 제출된 발전량과 실제 발전량의 차이’를 줄여 수익을 증가시킬 수 있다. 재생발전원 단독으로는 아무리 예측을 잘 해도 하루전 제출 발전량과 실제 발전량 간에 차이가 있다. 이러한 차이가 실시간 시장에서의 balancing에 의한 경제적 손실을 야기하므로, 급전가능발전원 및 에너지저장장치와 연계해 그 차이를 없애고자 하는 것이다.&lt;/p&gt;

&lt;p&gt;(이러한 차이를 줄일 경우, 국가적으로는 중앙급전 발전원들의 발전량을 보다 정확하게 산정할 수 있다는 편익도 있다.)&lt;/p&gt;

&lt;p&gt;위 논문의 case study에서 다루는 가상발전소도 9.6MW급 풍력터빈에 더해 40MWh급 양수에너지저장소와 5.67MW급 급전가능 가스터빈으로 구성된다.&lt;/p&gt;

&lt;p&gt;참고로 우리나라의 경우 아직 실시간 시장이 없으며, 현재 VPP의 수익원 대부분은 &lt;a href=&quot;https://www.electimes.com/news/articleView.html?idxno=320020&quot;&gt;재생발전량을 정확하게 예측할 경우 받는 정산금&lt;/a&gt;이다. 그러나 &lt;a href=&quot;https://www.electimes.com/news/articleView.html?idxno=325061&quot;&gt;실시간 시장이 2024년 2월부터 제주도에 시범적으로 개설되며 2025년에는 육지에도 적용될 예정&lt;/a&gt;이므로, 향후 몇 년 내로 VPP 사업이 활성화될 수 있을 것으로 보인다.&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;
&lt;h2 id=&quot;vpp의-offer-curve-급전량을-미래의-시장가격의-함수로-결정&quot;&gt;VPP의 offer curve: 급전량을 미래의 시장가격의 함수로 결정&lt;/h2&gt;

&lt;p&gt;하루전시장에 제출할 시간별 급전량을 최적화 문제를 풀어 결정하려면, 하루전 시장에서의 시간별 시장가격 및 실시간 시장에서의 시간별 시장가격을 알아야 한다 (VPP는 시장가격을 정해진 그대로 받아들이며 시장가격에 영향을 미치지 못하는 price taker라고 가정).&lt;/p&gt;

&lt;p&gt;그러나 실제로는 다음날의 시간별 시장가격을 모르므로, ‘하루전 시장에서의 $t$시의 시장가격이 $\lambda(t)$이면 우리 VPP는 $G(t)$ 만큼 발전할 것’ 이라는 계획을 제출한다. 즉 시간별 발전량이 해당 시간의 시장가격의 함수이다. 이를 ‘offer curve’라 한다.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/vppintro/offercurve.png&quot; alt=&quot;systemscheme&quot; class=&quot;align-center&quot; /&gt;
&lt;em&gt;Offer curve (출처: 소개 논문).&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;위 그림에서 각 curve는 하나의 시간에 대응하며, 해당 시간의 시장가격(가로축)에 대응하는 VPP의 발전량(세로축) 을 보여준다. 음의 발전량은 에너지저장장치 충전을 의미한다 (부하가 적어 상대적으로 시장가격이 저렴한 시간대에 충전 후 낮 시간에 방전한다).&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;
&lt;h2 id=&quot;불확실성을-고려한-stochastic-programming-기반-offer-curve-도출&quot;&gt;불확실성을 고려한 stochastic programming 기반 offer curve 도출&lt;/h2&gt;

&lt;p&gt;여기서 난점은, 재생발전원의 다음날 시간별 발전량 또한 불확실하다는 것이다. 그러므로 ‘stochastic programming’ 문제가 된다.&lt;/p&gt;

&lt;p&gt;보통 이러한 multi-period (여기서는 24시간) stochastic programming에서는, 다음날의 시간별 시장가격과 재생발전량 ‘시나리오’들을 아래와 같이 만든다.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/vppintro/scenario_dayahead.png&quot; alt=&quot;systemscheme&quot; class=&quot;align-center&quot; /&gt;
&lt;img src=&quot;/assets/images/vppintro/scenario_balancing.png&quot; alt=&quot;systemscheme&quot; class=&quot;align-center&quot; /&gt;
&lt;em&gt;시간별 시장가격 시나리오 (위: 하루전시장, 아래: 실시간시장. 출처: 소개 논문).&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/vppintro/scenario_wind.png&quot; alt=&quot;systemscheme&quot; class=&quot;align-center&quot; /&gt;
&lt;em&gt;시간별 풍력 발전량 시나리오 (출처: 소개 논문).&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;각 시나리오는 24시간 동안의 시간별 수치들의 집합 즉 ‘trajectory’이다. 이렇게 trajectory를 쓰는 이유는, 해당 시계열 데이터들이 시간에 따른 자기상관관계 (autocorrelation) 를 가질 것이기 때문이다.&lt;/p&gt;

&lt;p&gt;또한 각 시나리오별 확률도 사전에 결정해야 한다 (해당 논문에서는 편의상 각 시나리오 별 확률이 같다고 (equiprobable) 가정했다).&lt;/p&gt;

&lt;p&gt;시간별 시장가격의 시나리오 인덱스를 $p$, 풍력발전량의 시나리오 인덱스를 $w$라 하자. 최적화 문제에서는 ‘각 시나리오 별 하루전 시장에서의 시간 $t$에 대한 발전량 제출’ $G_{wp}(t)$를 결정한다.&lt;/p&gt;

&lt;p&gt;실시간 시장에서의 balancing에 대한 제약조건은 아래와 같다.&lt;/p&gt;

&lt;p&gt;$G_{wp}(t) = g_w(t) + g_{wp}^c (t) + g_{wp}^t (t) + bm_{wp}^{up}(t) - g_{wp}^p(t)/\eta - bm_{wp}^{down}(t) \quad \forall w,p,t$&lt;/p&gt;

&lt;p&gt;각 시간 $t$에 대해 어떤 시나리오 $wp$ 하에서도, $G_{wp}(t)$는 당일의 풍력 발전량 $g_w(t)$, 가스터빈 발전량 $g_{wp}^c (t)$, 양수에너지저장소의 터빈에 의한 발전량 $g_{wp}^t (t)$, 당일 시장에서 필요 시 추가로 구입하는 에너지 $bm_{wp}^{up}(t) $ 의 합으로부터, 양수에너지저장소의 펌프 가동 에너지 $g_{wp}^p (t)$ 에 efficiency factor $\eta$를 곱한 값과 당일 시장에서 필요 시 재판매하는 에너지 $bm_{wp}^{down}(t) $ 을 뺀 값과 같아야 한다.&lt;/p&gt;

&lt;p&gt;그런데, offer curve에서 시간별 급전량은 시장가격의 함수이기는 하지만 풍력발전량의 함수는 아니다. 다음날의 풍력발전량을 ‘모르는’ 상태에서 시간별 급전량을 동일시간의 시장가격의 함수로 결정하기 때문이다. 그러므로, 하나의 $(p,t)$ 순서쌍이 주어지면 $G_{wp}(t)$는 모든 $w$에 대해 같아야 한다. 즉, 아래 제약조건이 추가로 필요하다.&lt;/p&gt;

&lt;p&gt;$G_{w_{1} p}(t) = G_{w_{2} p}(t) = \cdots = G_{w_{n} p}(t)$  ($w_1, \dots,w_n$은 풍력발전 시나리오들)&lt;/p&gt;

&lt;p&gt;Stochastic programming에서는 위 수식처럼 여러 시나리오들에 대해 변수가 같다는 제약조건을 ‘non-anticipativity constraint’ 라고 한다. Anticipate가 ‘예측하다’ 라는 뜻인데, 여기서는 다음날의 풍력발전을 정확히 예측하지 못한다는 의미이다.&lt;/p&gt;

&lt;p&gt;그 외의 제약조건들은 필자의 최적화문제 소개글들에 있는 &lt;a href=&quot;https://song4energyndata.github.io/linprogten.html&quot;&gt;출력조정 제약&lt;/a&gt;, &lt;a href=&quot;https://song4energyndata.github.io/linprogtwo.html&quot;&gt;에너지저장장치 충방전에 대한 제약&lt;/a&gt; 등이다.&lt;/p&gt;

&lt;p&gt;목적함수는 아래와 같다. $\pi$는 시나리오 별 확률을 의미하며, 각 시나리오 별 총 수익은 하루전 시장에서의 입찰에 의한 수익 $\lambda_p(t)G_{wp}(t)$에 실시간 시장에서 balancing을 위해 추가적으로 판매하는 잉여전력의 수익 및 추가적으로 구입하는 전력부족분의 비용 (음의 수익) 을 더하고 가스터빈 구동에 드는 연료비 $C_{wp}^c(t)$ 및 시동비용 $SUC^c v_{wp}^c (t)$ 를 뺀 값이다.&lt;/p&gt;

&lt;p&gt;$ \sum_t \sum_w \pi_w \sum_p \pi_p \sum_{r^{down}} \pi_r^{down} \sum_{r^{up}} \pi_r^{up} [\lambda_p(t) (G_{wp}(t) + bm_{wp}^{down}(t) \psi_r^{down}(t) - bm_{wp}^{up}(t) \psi_r^{up}(t) ) - C_{wp}^c(t) - SUC^c v_{wp}^c (t)] $&lt;/p&gt;

&lt;p&gt;문제를 풀면, 위 시나리오들을 고려할 때의 ‘총 수익의 기대값’을 최대화하도록 offer curve가 결정된다.&lt;/p&gt;

&lt;p&gt;위 연구는 stochastic programming 기반으로 재생발전 비중이 높은 VPP의 입찰량을 계산하는 방법의 baseline으로써 가치가 있다 (해당 논문은 인용횟수가 300회를 넘는다).&lt;/p&gt;
</description>
        <pubDate>Sun, 10 Sep 2023 00:00:00 +0900</pubDate>
        <link>https://song4energyndata.github.io/vppintro.html</link>
        <guid isPermaLink="true">https://song4energyndata.github.io/vppintro.html</guid>
        
        <category>전력시장</category>
        
        <category>에너지시스템</category>
        
        <category>VPP</category>
        
        
        <category>market</category>
        
      </item>
    
      <item>
        <title>에너지시스템 최적화/게임이론 강의: 12) Variants of ADMM and applications</title>
        <description>&lt;p&gt;이 포스팅은, Technical University of Denmark의 박사과정 과목 “Advanced Optimization and Game Theory for Energy Systems” (Prof. Jalal Kazempour) 의 12강을 필자가 요약한 내용이다.&lt;/p&gt;

&lt;!-- Courtesy of embedresponsively.com --&gt;

&lt;div class=&quot;responsive-video-container&quot;&gt;
    &lt;iframe src=&quot;https://www.youtube-nocookie.com/embed/MWPJAl84Sac&quot; frameborder=&quot;0&quot; webkitallowfullscreen=&quot;&quot; mozallowfullscreen=&quot;&quot; allowfullscreen=&quot;&quot;&gt;&lt;/iframe&gt;
  &lt;/div&gt;

&lt;p&gt;(&lt;a href=&quot;https://www.jalalkazempour.com/teaching&quot;&gt;Course slides 링크&lt;/a&gt;)&lt;/p&gt;

&lt;h2 id=&quot;economic-dispatch&quot;&gt;Economic dispatch&lt;/h2&gt;

&lt;p&gt;여러 대의 발전기로 시간별 수요를 만족시키는 최소비용의 스케줄을 구하는 문제에서는, 각 수요-공급 일치 조건이 complicating constraint이다. 해당 제약조건에 모든 발전기의 출력 항들이 포함되기 때문으로, 해당 제약조건을 relax하면 각 발전기 별 subproblem으로 나눌 수 있다.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/jalal/Lecture12_25.png&quot; alt=&quot;clearingexample&quot; /&gt;&lt;/p&gt;

&lt;p&gt;위 예제에서는 목적함수가 quadratic function이므로, Lagrangian Relaxation (LR) 을 적용할 수 있다.&lt;/p&gt;

&lt;p&gt;Complicating constraint인 수요-공급 일치 제약에 dual variable $\lambda$을 곱한 항을 목적함수에 추가하고, dual variable의 값을 $\bar{\lambda}$ 로 고정하면, 각 발전기 별 subproblem으로 나눌 수 있다.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/jalal/Lecture12_27.png&quot; alt=&quot;clearingexample&quot; /&gt;&lt;/p&gt;

&lt;p&gt;그리고 각 발전기 별 subproblem을 풀어 $v$번째 iteration 기준 $p_g^{(v)}$를 구하고, 이를 통해 아래와 같이 $\bar{\lambda}^{(v)}$를 $\bar{\lambda}^{(v+1)}$로 업데이트한다.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/jalal/Lecture12_35.png&quot; alt=&quot;clearingexample&quot; /&gt;&lt;/p&gt;

&lt;p&gt;이 때 $\bar{\lambda}^{(v)}$는 수요-공급 일치 제약에 대한 dual variable이므로 ‘가격’이기도 하다. 여기서는 각 발전기 별로 자신의 이익을 최대화하는 발전량을 설정하고, 이를 모두 취합한 market operator가 가격을 업데이트한 후 다시 발전기들에게 통보한다. 그리고 각 발전기는 수정된 가격에 대해 발전량을 재설정하고, market operator는 이를 다시 취합해 가격을 업데이트하는 과정을 수렴할 때까지 반복한다.&lt;/p&gt;

&lt;p&gt;이런 식으로 가격을 iterative하게 결정하는 시장을 Walrasian auction이라고 한다.&lt;/p&gt;

&lt;p&gt;이러한 ‘distributed’ technique 기반으로 가격을 결정하는 방법은, 시장에 여러 가지 externalities가 추가되어 시장 균형 문제가 더 이상 동치인 최적화 문제를 갖지 않는 경우에 특히 유용한 것으로 알려져 있다.&lt;/p&gt;

&lt;h2 id=&quot;market-clearing-with-linear-offers&quot;&gt;Market clearing (with linear offers)&lt;/h2&gt;

&lt;p&gt;Market clearing problem에서도 수요-공급 일치 조건이 complicating constraint이다.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/jalal/Lecture12_42.png&quot; alt=&quot;clearingexample&quot; /&gt;&lt;/p&gt;

&lt;p&gt;만약 위 예제처럼 목적함수가 quadratic이 아니라 linear function이면, ‘augmented’ LR을 사용해야 한다. 그러므로 목적함수에 complicating constraint의 제곱항을 추가한다 (regulization coefficient $\gamma/2$를 곱해서).&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/jalal/Lecture12_45.png&quot; alt=&quot;clearingexample&quot; /&gt;&lt;/p&gt;

&lt;p&gt;단, 이 경우 $\lambda$의 값을 $\bar{\lambda}$로 고정해도 각 발전기 별 subproblem으로 바로 나눌 수 없다. Complicating constraint의 제곱항 내에 변수들 간 product term이 있기 때문이다. 그러므로 각 발전기에 대해, 나머지 발전기들의 발전량을 고정하여 구성한 문제를 푼다 (ADMM). 각 발전기 별 최적의 발전량을 기반으로, $\bar{\lambda}$가 업데이트된다.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/jalal/Lecture12_50.png&quot; alt=&quot;clearingexample&quot; /&gt;&lt;/p&gt;

&lt;h2 id=&quot;privacy-이슈를-고려한-exchange-admm&quot;&gt;Privacy 이슈를 고려한 Exchange ADMM&lt;/h2&gt;

&lt;p&gt;위 슬라이드의 ADMM에는 한 가지 ‘실질적인’ 문제가 있다. 발전기 1번의 ($v$번째 iteration에서의) 발전량을 계산하려면 발전기 2와 발전기 3의 ($v-1$번째 iteration에서의) 발전량 정보가 발전기 1에 전달되어야 하는데, 이는 ‘privacy 침해’로 볼 수 있기 때문이다.&lt;/p&gt;

&lt;p&gt;그러나 문제의 식을 아래 슬라이드와 같이 ‘모든 발전기들의 발전량들의 평균’을 도입해 변형하면, 이러한 ‘privacy 침해’ 문제를 완화할 수 있다.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/jalal/Lecture12_59.png&quot; alt=&quot;clearingexample&quot; /&gt;&lt;/p&gt;

&lt;p&gt;각 발전기는 $v-1$번째 iteration에서의 자기 자신의 발전량 $x_i^{(v-1)}$ 및 ‘모든 발전기들의 발전량들의 평균’ $\bar{x}^{(v-1)}$ 을 알면, $x_i^{(v)}$를 계산할 수 있다. 즉 각자의 발전량 정보는 market operator에게는 전달되지만, 다른 개별 발전기들에게는 전달되지 않기 때문에 privacy 침해 문제가 완화된다. 이를 ‘exchange’ ADMM이라 한다.&lt;/p&gt;

&lt;h2 id=&quot;consensus-admm&quot;&gt;Consensus ADMM&lt;/h2&gt;

&lt;p&gt;모든 subproblem들에 공통으로 포함된 complicating variable이 있을 경우 이를 Bender’s decomposition으로 푸는 대신, ADMM 방식으로 풀 수도 있다.&lt;/p&gt;

&lt;p&gt;아래 슬라이드에서는, 원래 문제에서의 complicating variable $x$를 각 subproblem $i$ 별로 $x_i$라는 변수로 두고, 대신 $x_i$가 공통의 값 $z$와 같다는 제약을 추가했다. 이 문제에서 $z$는 parameter가 아닌 변수임에 주의한다.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/jalal/Lecture12_67.png&quot; alt=&quot;clearingexample&quot; /&gt;&lt;/p&gt;

&lt;p&gt;$x_i=z$는 complicating constraint이다. 그러므로, 각 subproblem별 목적함수에 제약 $x_i-z=0$의 좌변에 dual variable을 곱한 항과 좌변의 제곱에 regularization coefficient를 곱한 항을 추가 후 dual variable과 $z$의 값을 고정해 ADMM 스타일의 문제를 아래와 같이 구성할 수 있다.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/jalal/Lecture12_71.png&quot; alt=&quot;clearingexample&quot; /&gt;&lt;/p&gt;

&lt;p&gt;각각의 $x_i$가 전부 특정 값 $z$로 같아야 한다는, 즉 ‘consensus를 이뤄야 한다는’ 제약이 있어, 이를 consensus ADMM이라 한다.&lt;/p&gt;

&lt;p&gt;여기서 난점은, $\bar{\lambda}$ 뿐 아니라 complicating variable이 최종적으로 가져야 할 값 $z$도 업데이트해야 한다는 것이다.&lt;/p&gt;

&lt;p&gt;다행히도, $z$를 업데이트하는 문제는 아래와 같이 analytic solution을 가진다.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/jalal/Lecture12_74.png&quot; alt=&quot;clearingexample&quot; /&gt;&lt;/p&gt;

&lt;p&gt;$N^{-1} \sum_{i=1}^N x_i^{(v)}$를 $\bar{x}^{(v)}$로 쓰면, 아래와 같다.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/jalal/Lecture12_78.png&quot; alt=&quot;clearingexample&quot; /&gt;&lt;/p&gt;

&lt;p&gt;이 식들을 적절히 결합하면, 최종적으로 $z$가 사라진 아래와 같은 알고리즘을 얻는다.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/jalal/Lecture12_84.png&quot; alt=&quot;clearingexample&quot; /&gt;&lt;/p&gt;

&lt;p&gt;즉 $v$번째 iteration에서 각 $x_i^{(v)}$는, $v-1$번째 iteration에서의 $x_i^{(v-1)}$들의 평균 $\bar{x}^{(v-1)}$ 으로부터 멀어질수록 penalty를 가하는 목적함수에 의해 결정된다. 이 penalty가 zero가 되는 시점은 모든 $x_i^{(v)}$들이 같아질 때, 즉 consensus를 이룰 때이다. (이러한 방법을 progressive hedging이라고도 한다.)&lt;/p&gt;

&lt;p&gt;Consensus ADMM은 stochastic market clearing에서 하루전 시장에서의 급전변수들을 결정할 때, 전력 네트워크에 여러 개의 node들이 있을 때 각 node 개별의 ‘distributed optimal power flow’ 문제들로 나눌 때 쓸 수 있다.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/jalal/Lecture12_91.png&quot; alt=&quot;clearingexample&quot; /&gt;&lt;/p&gt;

&lt;div class=&quot;notice--info&quot;&gt;

Advanced Optimization and Game Theory for Energy Systems 강의 요약&lt;br /&gt;&lt;br /&gt;

01) &lt;a href=&quot;/jalalone.html&quot;&gt; Market clearing as an optimization problem&lt;/a&gt; &lt;br /&gt;
02) &lt;a href=&quot;/jalaltwo.html&quot;&gt; Market clearing as an equilibrium problem&lt;/a&gt; &lt;br /&gt;
03) &lt;a href=&quot;/jalalthree.html&quot;&gt; Desirable properties of market-clearing mechanisms&lt;/a&gt; &lt;br /&gt;
04) Market clearing using a cooperative game approach &lt;br /&gt;
05) &lt;a href=&quot;/jalalfive.html&quot;&gt; Stochastic market clearing&lt;/a&gt; &lt;br /&gt;
06) &lt;a href=&quot;/jalalsix.html&quot;&gt; Robust approaches for market clearing&lt;/a&gt; &lt;br /&gt;
07) &lt;a href=&quot;/jalalseven.html&quot;&gt; Bilevel programming in energy systems&lt;/a&gt; &lt;br /&gt;
08) &lt;a href=&quot;/jalalgeight.html&quot;&gt; Optimization problems with decomposable structure&lt;/a&gt; &lt;br /&gt;
09) &lt;a href=&quot;/jalalgnine.html&quot;&gt; Benders’ decomposition: Theory&lt;/a&gt; &lt;br /&gt;
10) &lt;a href=&quot;/jalalten.html&quot;&gt; Benders’ decomposition: Applications&lt;/a&gt; &lt;br /&gt;
11) &lt;a href=&quot;/jalaleleven.html&quot;&gt; Augmented Lagrangian relaxation&lt;/a&gt; &lt;br /&gt;
12) &lt;b&gt; Variants of ADMM and applications&lt;/b&gt;
&lt;/div&gt;
</description>
        <pubDate>Sun, 03 Sep 2023 00:00:00 +0900</pubDate>
        <link>https://song4energyndata.github.io/jalaltwelve.html</link>
        <guid isPermaLink="true">https://song4energyndata.github.io/jalaltwelve.html</guid>
        
        <category>최적화</category>
        
        <category>게임이론</category>
        
        <category>에너지시스템</category>
        
        
        <category>market</category>
        
      </item>
    
      <item>
        <title>에너지시스템 최적화/게임이론 강의: 11) (Augmented) Lagrangian relaxation</title>
        <description>&lt;p&gt;이 포스팅은, Technical University of Denmark의 박사과정 과목 “Advanced Optimization and Game Theory for Energy Systems” (Prof. Jalal Kazempour) 의 11강을 필자가 요약한 내용이다.&lt;/p&gt;

&lt;!-- Courtesy of embedresponsively.com --&gt;

&lt;div class=&quot;responsive-video-container&quot;&gt;
    &lt;iframe src=&quot;https://www.youtube-nocookie.com/embed/MWPJAl84Sac&quot; frameborder=&quot;0&quot; webkitallowfullscreen=&quot;&quot; mozallowfullscreen=&quot;&quot; allowfullscreen=&quot;&quot;&gt;&lt;/iframe&gt;
  &lt;/div&gt;

&lt;p&gt;(&lt;a href=&quot;https://www.jalalkazempour.com/teaching&quot;&gt;Course slides 링크&lt;/a&gt;)&lt;/p&gt;

&lt;h2 id=&quot;complicating-constraint가-있을-경우의-lagrangian-relaxation-lr&quot;&gt;Complicating constraint가 있을 경우의 Lagrangian Relaxation (LR)&lt;/h2&gt;

&lt;p&gt;에너지시스템 최적화 문제에서는 수요-공급 일치 조건, ramping limit 조건, 두 지역을 잇는 송전선 관련 조건 등이, ‘여러 소문제들의 변수들을 포함하는’ complicating constraint로써 포함되곤 한다. 해당 제약을 relax해서 큰 문제 대신 작은 subproblem들을 풀 수 있다.&lt;/p&gt;

&lt;p&gt;(이를테면 여러 지역을 잇는 송전 제약을 relax하면, 각 지역 별 market clearing problem을 따로 푸는 문제로 변환될 수 있다.)&lt;/p&gt;

&lt;p&gt;핵심은, 아래와 같이 complicating constraint들을 dual variable을 곱한 term으로 목적함수에 포함시키는 것, 그리고 dual variable들을 특정 값으로 고정하는 것이다.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/jalal/Lecture11_20.png&quot; alt=&quot;clearingexample&quot; /&gt;
&lt;img src=&quot;/assets/images/jalal/Lecture11_24.png&quot; alt=&quot;clearingexample&quot; /&gt;
&lt;img src=&quot;/assets/images/jalal/Lecture11_28.png&quot; alt=&quot;clearingexample&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Complicating constraint가 아닌 constraint는 그대로 두고 complicating constraint들만을 목적함수에 포함시키므로, 이는 ‘partial’ Lagrangian으로 볼 수 있다. 그래서 이 기법의 이름이 Lagrangian Relaxation (LR) 이다.&lt;/p&gt;

&lt;p&gt;Dual variable의 값을 고정함으로써, 위 예시 기준으로 각 $i$별 subproblem들이 구성된다. 단, 해당 고정값이 최적의 값인지 모르므로, iteration을 통해 최적의 값에 가까워지게 해야 한다.&lt;/p&gt;

&lt;p&gt;간단한 예시는 아래와 같다.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/jalal/Lecture11_34.png&quot; alt=&quot;clearingexample&quot; /&gt;
&lt;img src=&quot;/assets/images/jalal/Lecture11_35.png&quot; alt=&quot;clearingexample&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Complicating constraint $-x-y+4=0$에 dual variable $\mu$를 곱한 값을 목적함수에 더한 후 $\mu$의 값을 $\bar{\mu}$로 고정 후 $x$와 $y$ 각각에 대한 subproblem을 푼다. 그 결과 얻은 variable들의 값들 $x^{(v)}$와 $y^{(v)}$에 기반해 $\bar{\mu}$를 업데이트한다.&lt;/p&gt;

&lt;p&gt;이 때 $a$와 $b$는 일종의 hyperparameter로, 그 값에 따라 수렴 속도 및 안정성이 달라진다. (Bender’s decomposition에서는 이런 hyperparamter가 없었다. 그래서 필자가 보기엔 LR은 약간은 ‘learning’ 요소가 있는 기법이다.)&lt;/p&gt;

&lt;h2 id=&quot;목적함수가-linear-function일-때의-augmented-lr&quot;&gt;목적함수가 linear function일 때의 ‘Augmented’ LR&lt;/h2&gt;

&lt;p&gt;주의할 점은, LR을 그대로 쓰려면 목적함수의 first derivative가 연속함수여야 한다는 것이다. 이 연속함수는 상수함수를 포함하지 않는다. 따라서 위 예제처럼 목적함수가 quadratic function인 경우 LR을 쓸 수 있지만, 만약 목적함수가 linear function이라면 LR을 쓸 수 없다 (정확히는 쓰더라도 수렴이 보장되지 않는다).&lt;/p&gt;

&lt;p&gt;목적함수가 linear function이지만 complicating constraint를 relax해 subproblem들로 쪼개고 싶은 경우 쓸 수 있는 방법으로, ‘Augmented’ Lagrangian Relaxation (ALR) 이 있다.&lt;/p&gt;

&lt;p&gt;ALR에서는 목적함수를 확실하게 quadratic function으로 만들기 위해, complicating constraint의 제곱항을 추가한다. 예시는 아래와 같다.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/jalal/Lecture11_41.png&quot; alt=&quot;clearingexample&quot; /&gt;&lt;/p&gt;

&lt;p&gt;(위 예시에서 목적함수가 이미 quadratic이므로 굳이 ALR을 쓸 필요가 없지만, 이해를 돕기 위해 앞의 LR 예시와 같은 예시로 설명하였다.)&lt;/p&gt;

&lt;p&gt;어차피 optimal point에서는 $-x-y+4=0$이므로, 위 항을 추가해도 여전히 같은 문제를 푸는 셈이다. 위 식에서 $\gamma$는 regularization hyperparameter로 볼 수 있다.&lt;/p&gt;

&lt;p&gt;단, 위 문제에서는 $\lambda$를 고정시키더라도 $x$와 $y$ 각각의 subproblem으로 쪼갤 수 없다. $(-x-y+4)^2$ 가 $xy$, 즉 product term을 포함하기 때문이다.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/jalal/Lecture11_43.png&quot; alt=&quot;clearingexample&quot; /&gt;&lt;/p&gt;

&lt;h2 id=&quot;alternating-direction-method-of-multipliers-admm&quot;&gt;Alternating Direction Method of Multipliers (ADMM)&lt;/h2&gt;

&lt;p&gt;Product term 때문에 문제를 쪼갤 수 없다면, 차선책은 product term에 있는 변수 중 하나를 고정시키고 나머지 변수에 대한 문제를 푸는 것이다. 이러한 방법을 alternating direction method of multipliers (ADMM) 이라 한다.&lt;/p&gt;

&lt;p&gt;위 예시에 ADMM을 적용하는 과정은 아래와 같다.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/jalal/Lecture11_55.png&quot; alt=&quot;clearingexample&quot; /&gt;&lt;/p&gt;

&lt;p&gt;여기서 윗첨자가 $(v)$인 항들이 변수이고, 윗첨자가 $(v-1)$인 항들은 parameter들이다 (이전 iteration에서 구한 값들). Optimal point에서는 $-x-y+4=0$ 이므로, $\lambda^{(v)} \approx \lambda^{(v-1)}$ 이면 optimal point에 수렴한 것으로 본다.&lt;/p&gt;

&lt;p&gt;$\gamma$가 일종의 learing rate 역할을 하므로, 이를 너무 크거나 작지 않게 적절히 결정해 주어야 한다.&lt;/p&gt;

&lt;div class=&quot;notice--info&quot;&gt;

Advanced Optimization and Game Theory for Energy Systems 강의 요약&lt;br /&gt;&lt;br /&gt;

01) &lt;a href=&quot;/jalalone.html&quot;&gt; Market clearing as an optimization problem&lt;/a&gt; &lt;br /&gt;
02) &lt;a href=&quot;/jalaltwo.html&quot;&gt; Market clearing as an equilibrium problem&lt;/a&gt; &lt;br /&gt;
03) &lt;a href=&quot;/jalalthree.html&quot;&gt; Desirable properties of market-clearing mechanisms&lt;/a&gt; &lt;br /&gt;
04) Market clearing using a cooperative game approach &lt;br /&gt;
05) &lt;a href=&quot;/jalalfive.html&quot;&gt; Stochastic market clearing&lt;/a&gt; &lt;br /&gt;
06) &lt;a href=&quot;/jalalsix.html&quot;&gt; Robust approaches for market clearing&lt;/a&gt; &lt;br /&gt;
07) &lt;a href=&quot;/jalalseven.html&quot;&gt; Bilevel programming in energy systems&lt;/a&gt; &lt;br /&gt;
08) &lt;a href=&quot;/jalalgeight.html&quot;&gt; Optimization problems with decomposable structure&lt;/a&gt; &lt;br /&gt;
09) &lt;a href=&quot;/jalalgnine.html&quot;&gt; Benders’ decomposition: Theory&lt;/a&gt; &lt;br /&gt;
10) &lt;a href=&quot;/jalalten.html&quot;&gt; Benders’ decomposition: Applications&lt;/a&gt; &lt;br /&gt;
11) &lt;b&gt; Augmented Lagrangian relaxation&lt;/b&gt; &lt;br /&gt;
12) &lt;a href=&quot;/jalaltwelve.html&quot;&gt; Variants of ADMM and applications&lt;/a&gt;
&lt;/div&gt;
</description>
        <pubDate>Sat, 02 Sep 2023 00:00:00 +0900</pubDate>
        <link>https://song4energyndata.github.io/jalaleleven.html</link>
        <guid isPermaLink="true">https://song4energyndata.github.io/jalaleleven.html</guid>
        
        <category>최적화</category>
        
        <category>게임이론</category>
        
        <category>에너지시스템</category>
        
        
        <category>market</category>
        
      </item>
    
      <item>
        <title>에너지시스템 최적화/게임이론 강의: 10) Applications of Bender&apos;s decomposition</title>
        <description>&lt;p&gt;이 포스팅은, Technical University of Denmark의 박사과정 과목 “Advanced Optimization and Game Theory for Energy Systems” (Prof. Jalal Kazempour) 의 10강을 필자가 요약한 내용이다.&lt;/p&gt;

&lt;!-- Courtesy of embedresponsively.com --&gt;

&lt;div class=&quot;responsive-video-container&quot;&gt;
    &lt;iframe src=&quot;https://www.youtube-nocookie.com/embed/NOBde8kEOj0&quot; frameborder=&quot;0&quot; webkitallowfullscreen=&quot;&quot; mozallowfullscreen=&quot;&quot; allowfullscreen=&quot;&quot;&gt;&lt;/iframe&gt;
  &lt;/div&gt;

&lt;p&gt;(&lt;a href=&quot;https://www.jalalkazempour.com/teaching&quot;&gt;Course slides 링크&lt;/a&gt;)&lt;/p&gt;

&lt;h2 id=&quot;generation-expansion-planning&quot;&gt;Generation expansion planning&lt;/h2&gt;

&lt;p&gt;아래 문제는 기존 두 개의 발전기에 더해 새로 도입되는 세 번째 발전기의 용량 $x_3$을 결정하되, 각 시간별 수요-공급 일치 및 발전기 별 운전 범위 조건을 만족시키면서 ‘발전기 건설비와 모든 시간의 운영비용의 합’을 최소화하도록 결정하는 설비 확장 (generation expansion) 문제이다.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/jalal/Lecture10a_8.png&quot; alt=&quot;clearingexample&quot; /&gt;&lt;/p&gt;

&lt;p&gt;$x_3$의 값을 고정하면, 각 시간 ($h$) 별로 subproblem을 구성할 수 있다. 주어진 $x_3$에 대해 각 시간 별 발전기들의 최적 출력을 결정하는 subproblem은 아래와 같다.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/jalal/Lecture10a_11.png&quot; alt=&quot;clearingexample&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Master problem의 optimality cut을 compact form으로 구성하기 위해, $x_3^{(i)}$을 변수로 두되 해당 변수의 값을 고정하는 제약조건 $x_3^{(i)} = x_3^{fixed}$ 를 두었다. 해당 제약에 대응하는 dual variable $\lambda_h$가 $h$별로 다른데, 이는 각 시간 별 전기부하 $D_h$가 얼마냐에 따라 optimal solution이 달라지므로 dual variable도 $h$별로 다르기 때문이다.&lt;/p&gt;

&lt;p&gt;$x_3$의 값을 업데이트하기 위한 master problem은 아래와 같다.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/jalal/Lecture10a_18.png&quot; alt=&quot;clearingexample&quot; /&gt;&lt;/p&gt;

&lt;p&gt;$\alpha^{(i)}$에 대한 제약조건의 우변이 모든 $h$에 대한 합임에 주의한다. $\alpha^{(i)}$가 목적함수의 $x$를 제외한 변수들에 대한 항들을 대신하는 auxiliary variable인데, 해당 항들은 ‘모든 시간에 대한 운영비용의 합’이기 때문이다.&lt;/p&gt;

&lt;p&gt;또한 제약조건이 총 $i-1$개임에 주의한다 (1번째, 2번째, …, $i-1$번째 iteration에서의 값들)&lt;/p&gt;

&lt;h2 id=&quot;scenario-based-stochastic-programming&quot;&gt;Scenario based stochastic programming&lt;/h2&gt;

&lt;p&gt;불확실성이 큰 재생발전기가 있을 때, 하루전 시장에 대해서는 재생발전기 발전량 시나리오에 관계없이 단일한 급전계획을 도출하고, 실시간 시장에 대해서는 각 시나리오 별 급전 수정 계획을 도출함을 이전 강의에서 설명하였다.&lt;/p&gt;

&lt;p&gt;아래 슬라이드를 보면, stochastic market clearing problem에서 complicating variables는 하루전 (Day-Ahead) 시장에 대한 변수들이고 (파란색으로 표기됨), 해당 변수들을 고정하면 각 시나리오 별 subproblem들을 구성할 수 있다.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/jalal/Lecture10a_68.png&quot; alt=&quot;clearingexample&quot; /&gt;&lt;/p&gt;

&lt;p&gt;각 시나리오 별 subproblem은 아래와 같다.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/jalal/Lecture10a_70.png&quot; alt=&quot;clearingexample&quot; /&gt;&lt;/p&gt;

&lt;p&gt;목적함수를 보면 0.25가 곱해져 있다. 이는 해당 시나리오의 확률이다. 각 subproblem별 목적함수에는 대응하는 시나리오의 확률을 곱해주도록 한다.&lt;/p&gt;

&lt;p&gt;Master problem은 아래와 같다.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/jalal/Lecture10a_75.png&quot; alt=&quot;clearingexample&quot; /&gt;&lt;/p&gt;

&lt;p&gt;여기서 주의할 점은, $\alpha^{(\theta)}$에 대한 제약조건의 우변에서, subproblem의 목적함수에 대응하는 부분에는 각 시나리오 별 확률을 곱해주지만, 그 뒤의 complicating variable들에 대한 부분에는 각 시나리오별 확률을 곱해주지 않는다는 것이다.&lt;/p&gt;

&lt;p&gt;이는 subproblem의 목적함수에 이미 각 시나리오 별 확률이 곱해져 있었기 때문에, complicating variable을 고정하는 제약에 대한 dual variable들 $\rho$가 ‘시나리오 별 확률만큼 scaling된’ sensitivity를 의미하기 때문이다. 그러므로 dual variable들을 전부 합하기만 해도, 각 시나리오 별 확률을 가중치로 하는 가중평균 sensitivity를 반영한 optimality cut을 생성하는 셈이 된다.&lt;/p&gt;

&lt;p&gt;위의 4개 시나리오에 대한 stochastic market clearing 문제를 Bender’s decomposition으로 풀면, 아래와 같이 5번의 iteartion으로 해를 얻는다.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/jalal/Lecture10a_79.png&quot; alt=&quot;clearingexample&quot; /&gt;&lt;/p&gt;

&lt;h2 id=&quot;정수-변수가-있을-경우에는&quot;&gt;정수 변수가 있을 경우에는?&lt;/h2&gt;

&lt;p&gt;에너지시스템 최적화 문제에는 정수가 많이 등장한다. 설비규모 변수가 용량 자체가 아닌 기기 숫자일 수 있고 (풍력터빈이 몇 대이냐 등), 각 시간별 subproblem을 기동/정지 여부를 나타내는 이진변수를 포함하는 unit commitment 문제로 고려해야 할 수도 있다.&lt;/p&gt;

&lt;p&gt;만약 Master problem에는 정수 변수가 있지만 subproblem들에는 정수 변수가 없을 경우, Bender’s decomposition을 적용할 수는 있다. 단, 이 경우 global optimum으로의 수렴이 보장되지 않음에 주의한다.&lt;/p&gt;

&lt;p&gt;만약 subproblem에 정수 변수가 있으면, 안타깝게도 Bender’s decomposition을 적용할 수 ‘없다’. 정수 변수가 포함된 문제를 풀 경우 dual variable을 계산할 수 없어, master problem에서 complicating variable의 sensitivity 기반의 optimality cut을 생성할 수 없기 때문이다.&lt;/p&gt;

&lt;p&gt;(필자도 개인적으로 관심을 갖는 주제 중 하나가 ‘unit commitment 제약을 고려한’ generation expanstion planning problem 풀이라서, 처음 이 사실을 알았을 때 좀 슬펐(?)다.)&lt;/p&gt;

&lt;p&gt;이러한 경우 사용할 수 있는 방법론으로 primal-Benders, Dantzig-Wolfe decomposition 등이 있다고 알려져 있으나, 매우 복잡한 방법들이다.&lt;/p&gt;

&lt;p&gt;현실적으로는 unit commitment 제약들을 ‘정수만 실수로 바꾸어서’ 구성한 문제를 풀어 용량변수의 값들을 도출 후, 해당 용량변수를 고정하고 일정 기간 (24시간 또는 48시간 정도) 동안의 unit commitment problem을 rolling 방식으로 푸는 것이 그나마 가능성 있는 방법으로 보인다. (단, 이 경우 용량변수의 값이 optimistic하게 계산되므로, 혹시라도 subproblem이 infeasible problem이 될 수 있으니 주의해야 한다.)&lt;/p&gt;

&lt;div class=&quot;notice--info&quot;&gt;

Advanced Optimization and Game Theory for Energy Systems 강의 요약&lt;br /&gt;&lt;br /&gt;

01) &lt;a href=&quot;/jalalone.html&quot;&gt; Market clearing as an optimization problem&lt;/a&gt; &lt;br /&gt;
02) &lt;a href=&quot;/jalaltwo.html&quot;&gt; Market clearing as an equilibrium problem&lt;/a&gt; &lt;br /&gt;
03) &lt;a href=&quot;/jalalthree.html&quot;&gt; Desirable properties of market-clearing mechanisms&lt;/a&gt; &lt;br /&gt;
04) Market clearing using a cooperative game approach &lt;br /&gt;
05) &lt;a href=&quot;/jalalfive.html&quot;&gt; Stochastic market clearing&lt;/a&gt; &lt;br /&gt;
06) &lt;a href=&quot;/jalalsix.html&quot;&gt; Robust approaches for market clearing&lt;/a&gt; &lt;br /&gt;
07) &lt;a href=&quot;/jalalseven.html&quot;&gt; Bilevel programming in energy systems&lt;/a&gt; &lt;br /&gt;
08) &lt;a href=&quot;/jalaleight.html&quot;&gt; Optimization problems with decomposable structure&lt;/a&gt; &lt;br /&gt;
09) &lt;a href=&quot;/jalalnine.html&quot;&gt; Benders’ decomposition: Theory&lt;/a&gt; &lt;br /&gt;
10) &lt;b&gt; Benders’ decomposition: Applications&lt;/b&gt; &lt;br /&gt;
11) &lt;a href=&quot;/jalaleleven.html&quot;&gt; Augmented Lagrangian relaxation&lt;/a&gt; &lt;br /&gt;
12) &lt;a href=&quot;/jalaltwelve.html&quot;&gt; Variants of ADMM and applications&lt;/a&gt;
&lt;/div&gt;
</description>
        <pubDate>Sun, 27 Aug 2023 00:00:00 +0900</pubDate>
        <link>https://song4energyndata.github.io/jalalten.html</link>
        <guid isPermaLink="true">https://song4energyndata.github.io/jalalten.html</guid>
        
        <category>최적화</category>
        
        <category>게임이론</category>
        
        <category>에너지시스템</category>
        
        
        <category>market</category>
        
      </item>
    
      <item>
        <title>에너지시스템 최적화/게임이론 강의: 9) Bender&apos;s decomposition</title>
        <description>&lt;p&gt;이 포스팅은, Technical University of Denmark의 박사과정 과목 “Advanced Optimization and Game Theory for Energy Systems” (Prof. Jalal Kazempour) 의 9강을 필자가 요약한 내용이다.&lt;/p&gt;

&lt;!-- Courtesy of embedresponsively.com --&gt;

&lt;div class=&quot;responsive-video-container&quot;&gt;
    &lt;iframe src=&quot;https://www.youtube-nocookie.com/embed/bJy4373v7Uo&quot; frameborder=&quot;0&quot; webkitallowfullscreen=&quot;&quot; mozallowfullscreen=&quot;&quot; allowfullscreen=&quot;&quot;&gt;&lt;/iframe&gt;
  &lt;/div&gt;

&lt;p&gt;(&lt;a href=&quot;https://www.jalalkazempour.com/teaching&quot;&gt;Course slides 링크&lt;/a&gt;)&lt;/p&gt;

&lt;h2 id=&quot;complicating-variable의-값을-찾는-원리&quot;&gt;Complicating variable의 값을 찾는 원리&lt;/h2&gt;

&lt;p&gt;Bender’s decomposition은, 모든 소문제에 공통적으로 포함되는 ‘변수’인 complicating ‘variable’이 있을 때 사용하는 decomposition method이다.&lt;/p&gt;

&lt;p&gt;Complicating variable이 포함된 큰 문제를 여러 subproblem들로 쪼개기 위해서는, complicating variable의 값을 고정해야 한다. 그러면 그 고정값을 얼마로 해야 될까?&lt;/p&gt;

&lt;p&gt;Complicating variable을 $x$라 할 때, $x$가 가질 수 있는 각 값들 별로 나머지 변수들에 대해 문제를 풀어 얻은 목적함수 값들을 아래 슬라이드와 같이 plot할 수 있다고 하면, 목적함수가 최소가 되는 $x$값을 선택하면 된다.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/jalal/Lecture9_15.png&quot; alt=&quot;clearingexample&quot; /&gt;&lt;/p&gt;

&lt;p&gt;$x$가 ‘신규’ 발전설비의 용량이고 위 plot에서의 목적함수가 총 비용 (건설비용과 운영비용의 합) 이라 하면,
$x$가 작아서 목적함수의 값이 큰 상황은 ‘발전설비 부족으로 전력 공급에 어려움을 겪을 경우의 운영비용 증가’,
$x$가 커서 목적함수의 값이 큰 상황은 ‘발전설비를 필요 이상으로 과하게 건설할 경우의 고정비용 증가’ 로 볼 수 있다.&lt;/p&gt;

&lt;p&gt;실제로는 위와 같은 plot을 미리 알 수 없다. 그러나 다행히도, 위 plot을 piecewise-linear function으로 근사하는 방법이 있다.&lt;/p&gt;

&lt;p&gt;먼저 $x$의 initial point를 정하고, 해당 $x$값으로 고정 후 목적함수를 계산한다.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/jalal/Lecture9_18.png&quot; alt=&quot;clearingexample&quot; /&gt;
&lt;img src=&quot;/assets/images/jalal/Lecture9_19.png&quot; alt=&quot;clearingexample&quot; /&gt;&lt;/p&gt;

&lt;p&gt;다음으로 해당 $x$값에서 목적함수의 sensitivity 값 기반으로 접선을 계산한다 (subproblem의 dual variable을 계산해 얻으며, 자세한 내용은 뒤에서 설명한다).&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/jalal/Lecture9_20.png&quot; alt=&quot;clearingexample&quot; /&gt;&lt;/p&gt;

&lt;p&gt;이 접선을 기준으로 목적함수를 최소화하는 $x$값을 구하고, 해당 $x$에 대해 위 과정을 다시 수행한다.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/jalal/Lecture9_21.png&quot; alt=&quot;clearingexample&quot; /&gt;
&lt;img src=&quot;/assets/images/jalal/Lecture9_22.png&quot; alt=&quot;clearingexample&quot; /&gt;&lt;/p&gt;

&lt;p&gt;그러면 접선 두 개가 이루는 piecewise-linear function이 생기는데, 해당 function을 기준으로 목적함수를 최소화하는 $x$값을 구하고, 해당 $x$에 대해 위 과정을 다시 수행한다.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/jalal/Lecture9_23.png&quot; alt=&quot;clearingexample&quot; /&gt;
&lt;img src=&quot;/assets/images/jalal/Lecture9_24.png&quot; alt=&quot;clearingexample&quot; /&gt;&lt;/p&gt;

&lt;p&gt;이 과정을 반복할수록, piecewise-linear function이 $x$값과 목적함수 간의 실제 관계와 유사해진다. 그러므로 이 과정을 수렴 조건이 만족될 때까지 반복한다.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/jalal/Lecture9_26.png&quot; alt=&quot;clearingexample&quot; /&gt;&lt;/p&gt;

&lt;p&gt;(단, $x$값과 목적함수 간의 관계가 convex임을 전제로 한다. non-convex인 경우 local optimum에 도달할 수 있다. $x$가 벡터인 경우에도 $x$의 원소 각각에 대해 convex여야 한다.)&lt;/p&gt;

&lt;h2 id=&quot;benders-decomposition-알고리즘&quot;&gt;Bender’s decomposition 알고리즘&lt;/h2&gt;

&lt;p&gt;아래 슬라이드의 예제를 Bender’s decomposition으로 푼다고 하자. 여기서 $x$를 complicating variable로 본다.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/jalal/Lecture9_31.png&quot; alt=&quot;clearingexample&quot; /&gt;&lt;/p&gt;

&lt;p&gt;그러면 $x$를 고정했을 때의 $y$에 대한 subproblem과, subproblem의 dual variable들 기반으로 구성할 수 있는 $x$에 대한 master problem은 아래 슬라이드와 같다.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/jalal/Lecture9_36.png&quot; alt=&quot;clearingexample&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Master problem에서 $\alpha^{(i)}$는 원래 문제의 목적함수에서의 $y$에 대한 term ($-y$) 을 대체하는 auxiliary variable이고, $i$는 iteration index이다 (여기서는 $i$가 1부터 시작한다고 둠). $\alpha^{down}$은 첫 번째 iteration에서 master problem을 bounded problem으로 만들기 위한 상수로, 크기가 매우 큰 음수이다.&lt;/p&gt;

&lt;p&gt;$\pi^{(k)}$, $\mu^{(k)}$, $\sigma^{(k)}$, $\gamma^{(k)}$ 는 $k$번째 iteration에서의 subproblem의 dual variable의 값들이다. 이 때 $k=1,2,\cdots,i-1$, 즉 직전 iteration까지의 ‘모든 iteration 각각에 대한’ 값들을 전부 모은 것임에 주의한다. 즉 $\alpha^{(i)}$에 대한 부등호 제약조건이 $i-1$개가 있는 것이다. 그리고 첨자 $(i)$만이 변수이고 첨자 $(k)$는 전부 parameter들임에 주의한다.&lt;/p&gt;

&lt;p&gt;$\alpha^{(i)}$에 대한 부등호 제약의 우변은 subproblem의 dual objective function이다. 실제로 $y$에 대한 subproblem의 Lagrangian을 쓰고 $y$ term들을 제거하면 ($y$ term들을 제거하지 않으면 unbounded problem이 됨), dual objective를 우변과 같이 얻는다. 그리고 $\alpha^{(i)}$는 최소화 대상이므로, $\alpha^{(i)}$는 $i-1$개의 dual objective 중 적어도 하나와 같은 값이 된다.&lt;/p&gt;

&lt;p&gt;Duality theorem에 의해 primal problem의 목적함수 (여기서는 $-y$)는 dual problem의 목적함수 ($\alpha^{(i)}$에 대한 부등호 제약의 우변) 보다 크거나 같다. 그러므로 subproblem을 풀어 얻은 subproblem의 목적함수의 값은 $\alpha^{(i)}$보다 크거나 같다.&lt;/p&gt;

&lt;p&gt;또한 subproblem이 linear programming problem이므로, optimal point에서는 primal problem의 목적함수와 $\alpha^{(i)}$가 서로 같을 것이다.&lt;/p&gt;

&lt;p&gt;그러므로 primal problem의 목적함수를 UB (upper bound) 로, $\alpha^{(i)}$를 LB (lower bound) 로 두고, $\vert UB - LB \vert \leq \epsilon$ 이 될 때까지 반복한다. 알고리즘은 아래와 같다.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/jalal/Lecture9_37.png&quot; alt=&quot;clearingexample&quot; /&gt;&lt;/p&gt;

&lt;h2 id=&quot;제약조건을-보다-간단히-쓰는-compact-form&quot;&gt;제약조건을 보다 간단히 쓰는 Compact form&lt;/h2&gt;

&lt;p&gt;위 설명대로라면, master problem의 $\alpha^{(i)}$에 대한 부등호 제약의 우변은 subproblem의 제약조건이 많을수록 매우 복잡해질 것이다 (dual variable 수가 늘어나므로). 게다가, 서두에 언급했던 $x$의 sensitivity를 기반으로 계산하는 방법도 아니다.&lt;/p&gt;

&lt;p&gt;$\alpha^{(i)}$에 대한 부등호 제약의 우변을 보다 간단하게 쓰는 compact form은 아래와 같다.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/jalal/Lecture9_42.png&quot; alt=&quot;clearingexample&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Subproblem에서 $x^{(i)}$를 형식적으로는 변수로 두되 맨 마지막 제약조건을 통해 그 값을 master problem에서 얻은 값으로 고정한다. 이 경우 어쨌든 제약조건은 맞으므로 $x^{(i)}$에 대한 sensitivity $\rho^{(i)}$를 구할 수 있다.&lt;/p&gt;

&lt;p&gt;Master problem에서는 subproblem의 목적함수 (여기서는 $-y^{(k)}$) 및 $x^{(k)}$에 대한 sensitivity $\rho^{(k)}$를 이용해서 $\alpha^{(i)}$에 대한 부등호 제약의 우변을 구성한다. 이는 훨씬 간단해진 compact form이자, 서두에 언급했듯 $x$의 sensitivity를 기울기로 하는 접선 계산이기도 하다.&lt;/p&gt;

&lt;p&gt;Compact form의 $\alpha^{(i)}$에 대한 부등호 제약의 우변이 original subproblem의 dual objective와 동치 (equivalent) 임은 KKT condition 비교를 통해 확인할 수 있다.&lt;/p&gt;

&lt;div class=&quot;notice--info&quot;&gt;

Advanced Optimization and Game Theory for Energy Systems 강의 요약&lt;br /&gt;&lt;br /&gt;

01) &lt;a href=&quot;/jalalone.html&quot;&gt; Market clearing as an optimization problem&lt;/a&gt; &lt;br /&gt;
02) &lt;a href=&quot;/jalaltwo.html&quot;&gt; Market clearing as an equilibrium problem&lt;/a&gt; &lt;br /&gt;
03) &lt;a href=&quot;/jalalthree.html&quot;&gt; Desirable properties of market-clearing mechanisms&lt;/a&gt; &lt;br /&gt;
04) Market clearing using a cooperative game approach &lt;br /&gt;
05) &lt;a href=&quot;/jalalfive.html&quot;&gt; Stochastic market clearing&lt;/a&gt; &lt;br /&gt;
06) &lt;a href=&quot;/jalalsix.html&quot;&gt; Robust approaches for market clearing&lt;/a&gt; &lt;br /&gt;
07) &lt;a href=&quot;/jalalseven.html&quot;&gt; Bilevel programming in energy systems&lt;/a&gt; &lt;br /&gt;
08) &lt;a href=&quot;/jalaleight.html&quot;&gt; Optimization problems with decomposable structure&lt;/a&gt; &lt;br /&gt;
09) &lt;b&gt; Benders’ decomposition: Theory&lt;/b&gt; &lt;br /&gt;
10) &lt;a href=&quot;/jalalten.html&quot;&gt; Benders’ decomposition: Applications&lt;/a&gt; &lt;br /&gt;
11) &lt;a href=&quot;/jalaleleven.html&quot;&gt; Augmented Lagrangian relaxation&lt;/a&gt; &lt;br /&gt;
12) &lt;a href=&quot;/jalaltwelve.html&quot;&gt; Variants of ADMM and applications&lt;/a&gt;
&lt;/div&gt;
</description>
        <pubDate>Sat, 26 Aug 2023 00:00:00 +0900</pubDate>
        <link>https://song4energyndata.github.io/jalalnine.html</link>
        <guid isPermaLink="true">https://song4energyndata.github.io/jalalnine.html</guid>
        
        <category>최적화</category>
        
        <category>게임이론</category>
        
        <category>에너지시스템</category>
        
        
        <category>market</category>
        
      </item>
    
      <item>
        <title>에너지시스템 최적화/게임이론 강의: 8) Optimization problems with decomposable structure</title>
        <description>&lt;p&gt;이 포스팅은, Technical University of Denmark의 박사과정 과목 “Advanced Optimization and Game Theory for Energy Systems” (Prof. Jalal Kazempour) 의 8강을 필자가 요약한 내용이다.&lt;/p&gt;

&lt;!-- Courtesy of embedresponsively.com --&gt;

&lt;div class=&quot;responsive-video-container&quot;&gt;
    &lt;iframe src=&quot;https://www.youtube-nocookie.com/embed/kluugyDZ8qs&quot; frameborder=&quot;0&quot; webkitallowfullscreen=&quot;&quot; mozallowfullscreen=&quot;&quot; allowfullscreen=&quot;&quot;&gt;&lt;/iframe&gt;
  &lt;/div&gt;

&lt;p&gt;(&lt;a href=&quot;https://www.jalalkazempour.com/teaching&quot;&gt;Course slides 링크&lt;/a&gt;)&lt;/p&gt;

&lt;h2 id=&quot;큰-문제를-작은-문제들로-쪼개기&quot;&gt;큰 문제를 작은 문제’들’로 쪼개기&lt;/h2&gt;

&lt;p&gt;에너지 시스템에 대한 최적화 문제는 종종 그 크기가 크다. 매우 많은 시간들을 포함하기 때문일 수도 있고, stochastic programming에서 매우 많은 시나리오들을 고려하기 때문일 수도 있다.&lt;/p&gt;

&lt;p&gt;문제의 크기가 극단적으로 크면 현재의 컴퓨터로 풀지 못하는 (intractable) 문제가 될 수 있으며, 풀리긴 하더라도 필요한 시간 내에 풀어야만 할 수도 있다. 이를테면 하루전 시장에서의 급전계획을 결정하는 문제의 경우, 몇 시간 안에는 풀려야 다음 날의 실시간 시장에 결과 반영이 가능하다.&lt;/p&gt;

&lt;p&gt;그런데 에너지 분야에서는, 큰 최적화 문제가 종종 작은 최적화 문제들로 쪼개질 수 있다. 매우 많은 시간들을 포함하는 문제를 시간별 소문제들로 쪼갠다든지, 매우 많은 시나리오들을 고려하는 문제를 시나리오별 소문제들로 쪼갤 수 있다. 당연히 각 소문제는 원래 문제 대비 쉽게 풀린다.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/jalal/Lecture8_4.png&quot; alt=&quot;clearingexample&quot; /&gt;&lt;/p&gt;

&lt;p&gt;작은 문제들로 쪼갤 수 있는 구조를 갖고 있지만 그 자체로는 큰 단일 문제인 최적화 문제의 경우, 바로 작은 문제들로 쪼개지 못하도록 만드는 변수 (complicating variables) 혹은 제약조건 (complicating constraints) 이 있다. 아래 두 슬라이드가 각각의 예시를 보여준다.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/jalal/Lecture8_16.png&quot; alt=&quot;clearingexample&quot; /&gt;
&lt;img src=&quot;/assets/images/jalal/Lecture8_24.png&quot; alt=&quot;clearingexample&quot; /&gt;&lt;/p&gt;

&lt;p&gt;에너지 분야에 대한 간단한 예시들은 아래와 같다.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/jalal/Lecture8_37.png&quot; alt=&quot;clearingexample&quot; /&gt;
&lt;img src=&quot;/assets/images/jalal/Lecture8_41.png&quot; alt=&quot;clearingexample&quot; /&gt;
&lt;img src=&quot;/assets/images/jalal/Lecture8_50.png&quot; alt=&quot;clearingexample&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Generation expansion problem에서는, 일반적으로 investment variable (설비 용량 등) 을 complicating variable로 보고 fix하는 것이 좋다.&lt;/p&gt;

&lt;div class=&quot;notice--info&quot;&gt;

Advanced Optimization and Game Theory for Energy Systems 강의 요약&lt;br /&gt;&lt;br /&gt;

01) &lt;a href=&quot;/jalalone.html&quot;&gt; Market clearing as an optimization problem&lt;/a&gt; &lt;br /&gt;
02) &lt;a href=&quot;/jalaltwo.html&quot;&gt; Market clearing as an equilibrium problem&lt;/a&gt; &lt;br /&gt;
03) &lt;a href=&quot;/jalalthree.html&quot;&gt; Desirable properties of market-clearing mechanisms&lt;/a&gt; &lt;br /&gt;
04) Market clearing using a cooperative game approach &lt;br /&gt;
05) &lt;a href=&quot;/jalalfive.html&quot;&gt; Stochastic market clearing&lt;/a&gt; &lt;br /&gt;
06) &lt;a href=&quot;/jalalsix.html&quot;&gt; Robust approaches for market clearing&lt;/a&gt; &lt;br /&gt;
07) &lt;a href=&quot;/jalalseven.html&quot;&gt; Bilevel programming in energy systems&lt;/a&gt; &lt;br /&gt;
08) &lt;b&gt; Optimization problems with decomposable structure&lt;/b&gt; &lt;br /&gt;
09) &lt;a href=&quot;/jalalnine.html&quot;&gt; Benders’ decomposition: Theory&lt;/a&gt; &lt;br /&gt;
10) &lt;a href=&quot;/jalalten.html&quot;&gt; Benders’ decomposition: Applications&lt;/a&gt; &lt;br /&gt;
11) &lt;a href=&quot;/jalaleleven.html&quot;&gt; Augmented Lagrangian relaxation&lt;/a&gt; &lt;br /&gt;
12) &lt;a href=&quot;/jalaltwelve.html&quot;&gt; Variants of ADMM and applications&lt;/a&gt;
&lt;/div&gt;
</description>
        <pubDate>Fri, 25 Aug 2023 00:00:00 +0900</pubDate>
        <link>https://song4energyndata.github.io/jalaleight.html</link>
        <guid isPermaLink="true">https://song4energyndata.github.io/jalaleight.html</guid>
        
        <category>최적화</category>
        
        <category>게임이론</category>
        
        <category>에너지시스템</category>
        
        
        <category>market</category>
        
      </item>
    
  </channel>
</rss>
