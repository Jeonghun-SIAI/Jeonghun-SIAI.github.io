<?xml version="1.0" encoding="UTF-8"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>에너지엔데이터연구소</title>
    <description>공학박사 과정에서 쌓은 에너지 시스템 전문성에 데이터 사이언스 석사를 더하며 쌓은 계산통계학 활용 역량을 결합하여, 데이터 기반의 에너지 시스템/ 정책/ 시장 관련 솔루션 도출을 올바르게 할 수 있도록 돕습니다.</description>
    <link>https://song4energyndata.github.io/</link>
    <atom:link href="https://song4energyndata.github.io/feed.xml" rel="self" type="application/rss+xml"/>
    <pubDate>Wed, 20 Dec 2023 16:22:30 +0900</pubDate>
    <lastBuildDate>Wed, 20 Dec 2023 16:22:30 +0900</lastBuildDate>
    <generator>Jekyll v4.3.2</generator>
    
      <item>
        <title>논문 소개: 태양광 패널 이상 탐지를 위한 합성곱 신경망(CNN)의 적용</title>
        <description>&lt;p&gt;대규모 태양광 단지의 수많은 패널 중 어딘가에 이상이 있는지 여부를/ 이상이 있다면 이상 유형과 위치를 자동으로 탐지하기 위해, 태양광 패널 사진을 입력받는 합성곱 신경망 (Convolutional Neural Network, CNN) 을 활용할 수 있다.&lt;/p&gt;

&lt;p&gt;이 포스팅에서는, 태양광 패널을 포함하는 이미지를 입력받아 분류 작업을 수행하는 CNN 모델들에 대해 다룬 논문 몇 개를 리뷰한다.&lt;/p&gt;

&lt;p&gt;(이 포스팅의 모든 그림들 (teaser 포함) 은, 포스팅에서 소개하는 논문들의 figure들임을 밝힌다.)&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;
&lt;h2 id=&quot;태양광-패널-존재-여부-판별&quot;&gt;태양광 패널 존재 여부 판별&lt;/h2&gt;

&lt;p&gt;가장 간단한 case는, 인공위성 등으로 촬영한 저화질 사진을 입력받아 해당 장소 내 태양광 패널의 존재 여부를 판별하는 것이다.&lt;/p&gt;

&lt;p&gt;논문 &lt;a href=&quot;https://ieeexplore.ieee.org/abstract/document/8094501&quot;&gt;Convolutional neural network based solar photovoltaic panel detection in satellite photos (2017)&lt;/a&gt; 에서는, 도심지에 대한 Google Map 사진 3,347개로 이진 분류 CNN 모델을 훈련 및 검증하였다.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/cnnforpv/rooftop.png&quot; alt=&quot;Rooftop images&quot; class=&quot;align-center&quot; /&gt;
&lt;em&gt;태양광이 설치된 지붕 사진들과 설치되지 않은 지붕 사진들.&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;3,347개의 사진들 중 1,643개 사진은 지붕 태양광 패널을 포함하였고, 나머지는 포함하지 않았다. 훈련 세트는 전체 데이터의 80%였다.&lt;/p&gt;

&lt;p&gt;CNN 구조는 전형적인 구조 (Convolutional layer들과 Fully connected layer들의 순차적 조합 및 각 layer의 output에 ReLU activation function을 적용) 를 따랐으며, 훈련 과정에 dropout을 적용하였다.&lt;/p&gt;

&lt;p&gt;해당 모델은 검증 세트 (태양광 포함한 사진 313개와 태양광 포함하지 않은 사진 357개) 에 대해 accuracy 87%, F-measure 86%라는 준수한 성능을 보였다.&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;
&lt;h2 id=&quot;태양광-패널-이상-탐지-및-이상-유형-판별&quot;&gt;태양광 패널 이상 탐지 및 이상 유형 판별&lt;/h2&gt;

&lt;p&gt;태양광 패널이 기대출력을 내지 못하는 원인은 여러 가지가 있다. 다른 물체의 그림자 혹은 쌓인 먼지에 의해 패널이 가려지거나, 태양광 패널 일부가 파손되거나, 국소적으로 온도가 높은 hot spot이 발생하거나 하면 출력이 감소한다.&lt;/p&gt;

&lt;p&gt;태양광 패널을 포함하는 사진이 있을 때, 해당 사진 내 패널의 이상 여부를 탐지할 뿐 아니라 이상 유형까지 판별하는 CNN 기반 분류 모델 연구 예시로 아래 두 논문들이 있다.&lt;/p&gt;

&lt;p&gt;1) &lt;a href=&quot;https://doi.org/10.1016/j.renene.2020.07.154&quot;&gt;Failure signature classification in solar photovoltaic plants using RGB images and convolutional neural networks (2020)&lt;/a&gt;&lt;br /&gt;
2) &lt;a href=&quot;https://doi.org/10.1016/j.renene.2021.07.070&quot;&gt;Automatic fault classification in photovoltaic modules using Convolutional Neural Networks (2021)&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;논문 1)에서는 임의의 각도 및 크기로 촬영된 태양광 패널 array들의 사진을 입력받아 4개 class들 (breakage, shadow, dust, no-fault) 중 하나로 분류하는 모델을 훈련 및 검증하였다.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/cnnforpv/faults.png&quot; alt=&quot;Rooftop images&quot; class=&quot;align-center&quot; /&gt;
&lt;em&gt;태양광 이상 유형별 사진 (왼쪽부터 shadow, dust, breakage).&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;논문 1)에서 사용한 training data의 크기가 비교적 작았음에도 (총 145장의 사진), 해당 모델은 약 70%의 accuracy를 달성하였다.&lt;/p&gt;

&lt;p&gt;논문 2)에서는 특정 규격으로 촬영된 태양광 패널 사진들 2만개의 공개 데이터셋(&lt;a href=&quot;https://github.com/RaptorMaps/InfraredSolarModules&quot;&gt;Infrared Solar Modules&lt;/a&gt;) 으로 패널 이상 유형을 분류하는 모델을 훈련 및 검증하였다.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/cnnforpv/infraredsolarmodules.png&quot; alt=&quot;Rooftop images&quot; class=&quot;align-center&quot; /&gt;
&lt;em&gt;Infrared Solar Modules 데이터셋의 태양광 패널 사진 (원본은 흑백이며, 해당 논문에서 칼라로 변환함).&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;논문 2)는 1)과 달리 사진 규격이 엄격하게 정해져 있어 사용처가 제한적일 수 있으나, 해당 규격을 충족하는 사진에 대해서는 더 다양한 이상 유형들을 분류할 수 있다&lt;br /&gt; 
(offline-module, diode-multi, diode, shadowing, cell-multi, cell, hot-spot, cracking, hot-spot-multi, soilling , vegetation, no-anomaly).&lt;/p&gt;

&lt;p&gt;단, 일부 이상 유형들의 사진 수가 적어 imbalanced dataset 문제가 있다 (2만장 중 diode-multi 175장, soiling 205장, hot-spot-multi 247장 등).&lt;/p&gt;

&lt;p&gt;논문 2)에서는 imbalanced dataset 문제 대응을 위해, data augumentation (사진 반전, 사진이동 등) 을 통해 원본 사진 수가 적은 class에 대한 data size를 증가시키는 oversampling을 수행하였다.&lt;/p&gt;

&lt;p&gt;논문 2)의 모델은 average testing accuracy 59.53%를 달성하였다. Class 수가 많을 뿐 아니라 class 간 이미지의 차이가 아주 뚜렷하진 않았기 때문으로 보인다.&lt;/p&gt;

&lt;p&gt;흔히 딥러닝 교육용으로 쓰이는 Fashion MNIST 데이터셋 내 물체들은 뚜렷하게 구별되는 구조를 갖고 있어 (즉 위상구조가 강해), CNN 모델이 feature extraction을 하기에 적합하고 10개 class에 대한 분류 정확도도 높다.&lt;/p&gt;

&lt;p&gt;그러나 태양광 패널 사진들의 경우 몇 개의 어두운 영역들만 보이므로 위상구조가 약해 feature extraction을 하기 쉽지 않고 결국 분류 성능도 좋지 못한 것으로 풀이된다.&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;
&lt;h2 id=&quot;태양광-패널-이상-위치-탐지&quot;&gt;태양광 패널 이상 위치 탐지&lt;/h2&gt;

&lt;p&gt;태양광 패널에 이상이 있을 때, 패널 내 이상의 정확한 위치도 중요한 정보다.&lt;/p&gt;

&lt;p&gt;논문 &lt;a href=&quot;https://doi.org/10.1016/j.renene.2020.01.148&quot;&gt;Photovoltaic plant condition monitoring using thermal images analysis by convolutional neural network-based structure (2020)&lt;/a&gt; 에서는, 비행드론으로 촬영한 태양광 패널 array의 열화상 사진을 입력받아 패널 내 hot spot이 있는지, 있다면 구체적으로 어느 위치에 있는지를 탐지하는 모델을 구성하였다.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/cnnforpv/location.png&quot; alt=&quot;Rooftop images&quot; class=&quot;align-center&quot; /&gt;
&lt;em&gt;비행 드론과 열화상 카메라를 이용한 태양광 이상 위치 탐지 시스템 개요도.&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;해당 모델에서는 먼저 패널 사진에서 먼저 이상이 있는 것으로 의심되는 영역인 Regions of interest (ROI) 를 찾는다. 수학적으로는 의심되는 사각형 영역의 위치 좌표 (x,y) 및 높이와 너비, 총 4개의 값을 회귀모델로 예측하는 작업이다. 구체적으로 사용된 방법론은 Fast R-CNN이다.&lt;/p&gt;

&lt;p&gt;(&lt;a href=&quot;https://ganghee-lee.tistory.com/36&quot;&gt;Fast R-CNN에 대한 한국어 블로그 정리 글&lt;/a&gt;)&lt;/p&gt;

&lt;p&gt;분류용 CNN 모델은 탐지된 ROI를 입력받아, 태양광 패널인지 여부와 hot spot인지 여부를 판별한다.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/cnnforpv/process.png&quot; alt=&quot;Rooftop images&quot; class=&quot;align-center&quot; /&gt;
&lt;em&gt;태양광 패널 내 ROI 탐지 및 ROI를 입력으로 하는 분류 도식도.&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;참고로 R-CNN 모델의 성능 향상을 위해, 패널 사진에서 패널 테두리를 사진의 경계와 최대한 평행하게 맞추는 image rotation process가 적용되었다.&lt;/p&gt;

&lt;p&gt;한편 최종 결과 report 시에는 ROI의 좌표를 실제 위치 좌표로 변환하기 위해 비행 드론과 패널 간 각도를 변수로 하는 삼각측량법이 사용되었다.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/cnnforpv/trianglemeasure.png&quot; alt=&quot;Rooftop images&quot; class=&quot;align-center&quot; /&gt;
&lt;em&gt;비행드론과 패널 간 각도에 기반한 삼각측량 도식도.&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;해당 모델은 분류 accuracy 92.25%, 이상 위치 평균오차 0.86m를 달성하였다.&lt;/p&gt;

</description>
        <pubDate>Wed, 20 Dec 2023 00:00:00 +0900</pubDate>
        <link>https://song4energyndata.github.io/cnnforpv.html</link>
        <guid isPermaLink="true">https://song4energyndata.github.io/cnnforpv.html</guid>
        
        <category>태양광</category>
        
        <category>딥러닝</category>
        
        
        <category>estimation</category>
        
      </item>
    
      <item>
        <title>시간별 태양광 발전량 계산 모델 수식 설명</title>
        <description>&lt;p&gt;태양광 패널을 포함하는 마이크로그리드의 경제성 분석을 위해서는 시간별 태양광 발전량을 계산해야 한다. 필자가 국내 케이스의 계산에 사용하는 데이터로는 &lt;a href=&quot;https://data.kma.go.kr/data/grnd/selectAsosRltmList.do?pgmNo=36&quot;&gt;기상청에서 제공하는 시간별 일사량&lt;/a&gt;이 있다. 즉, 시간별 일사량 데이터를 태양광 발전량으로 변환해야 한다.&lt;/p&gt;

&lt;p&gt;시간별 일사량 데이터를 태양광 발전량으로 변환한 결과만 얻고 싶다면, 미국의 National Renewable Energy Laboratory (NREL)에서 개발한 재생에너지시스템 경제성평가 tool인 &lt;a href=&quot;https://sam.nrel.gov/&quot;&gt;System Advison Model (SAM)&lt;/a&gt;을 사용하면 된다.&lt;/p&gt;

&lt;p&gt;SAM으로 시간별 태양광 발전량을 계산하기 위한 ‘프로그램 사용’ 방법은 &lt;a href=&quot;https://blog.naver.com/song4energy/221853737153&quot;&gt;필자의 NAVER 블로그 포스트&lt;/a&gt;에서 설명한 바 있다.&lt;/p&gt;

&lt;p&gt;그러나 SAM 사용 시 사용자가 매 case마다 수동으로 변환해야 한다. 만약 어떤 커스터마이징된 데이터 파이프라인이 일사량을 받고 자동으로 태양광 발전량으로 변환해 주기를 원한다면, SAM을 사용할 수 없다. 대신 태양광 발전량 계산 모델을 직접 코딩해서 포함시켜야 한다.&lt;/p&gt;

&lt;p&gt;이 포스트에서는, 기상청에서 제공하는 시간별 일사량으로 시간별/ 위도별/ 패널 각도별 태양광 발전량을 계산하는 수리모델을 설명한다. 참고한 자료들은 아래와 같다.&lt;/p&gt;

&lt;p&gt;1) &lt;a href=&quot;https://www.slideshare.net/muammarzainuddin/9781846284663-c2&quot;&gt;“Hybrid hydrogen systems”의 Chapter 2 “Renewable Energy Sources and Energy Conversion Devices”&lt;/a&gt;&lt;br /&gt;
2) &lt;a href=&quot;https://www.researchgate.net/publication/283051726_A_comprehensive_solar_angles_simulation_and_calculation_using_Matlab&quot;&gt;A comprehensive solar angles simulation and calculation using Matlab&lt;/a&gt;&lt;br /&gt;
3) &lt;a href=&quot;https://doi.org/10.1016/0038-092X(82)90302-4&quot;&gt;Estimation of the diffuse radiation fraction for hourly, daily and monthly-average global radiation&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;
&lt;h2 id=&quot;임의의-위치-날짜-시간에-태양으로부터-직달하는-일사량-계산&quot;&gt;임의의 위치/ 날짜/ 시간에 태양으로부터 직달하는 일사량 계산&lt;/h2&gt;

&lt;p&gt;먼저 지구 대기권 경계에 직달하는 일사량의 연중 평균값을 global solar constant $G_{sc}$ 라 하며, 약 $1,367 \text{W}/m^2$이다.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/solarradiation/extra.jpg&quot; alt=&quot;Global solar constant&quot; class=&quot;align-center&quot; /&gt;
&lt;em&gt;Global solar constant. (출처: https://www.greenrhinoenergy.com/solar/radiation/extraterrestrial.php)&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;실제 각 날짜별로 지구 대기권 경계에 직달하는 실제 일사량 $G_{en}$은 지구 공전에 의해 달라진다. $G_{en}$은 $n=1,2,\dots,365$이며 1월 1일에 $n=1$이라 할 때 아래와 같다.&lt;/p&gt;

&lt;p&gt;\begin{align} 
G_{en} = G_{sc}\left(1 + 0.033 \text{cos} \frac{360n}{365} \right)
\notag
\end{align}&lt;/p&gt;

&lt;p&gt;실제로는 시간 및 위도에 따라서도 일사량이 다르다. 위도(latitude)를 $\phi$, 시간에 대응하는 각도인 hour angle (정오 즉 남향일 때 0, 오후에 플러스, 오전에 마이너스, 1시간당 15도 변화) 을 $\omega$, 직달일사량과 지구 적도 간 각도인 declination angle 을 $\delta$라 할 때, 해당 날짜/ 위도/ 시간에 도달하는 일사량은 아래와 같다. (각 변수들의 구체적 의미는 식 아래 그림들 참고)&lt;/p&gt;

&lt;p&gt;\begin{align} 
G_{0} = G_{sc}\left(1 + 0.033 \text{cos} \frac{360n}{365} \right) \left(\text{cos}\phi \text{cos}\delta \text{cos}\omega + \text{sin}\phi \text{sin}\delta \right) \quad \text{where} \,\, \delta = 23.45^o \text{sin} \left[\frac{360^o}{365}(284+n) \right]
\notag
\end{align}&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/solarradiation/coordinates.png&quot; alt=&quot;Coordinates&quot; class=&quot;align-center&quot; /&gt;
&lt;em&gt;위도, hour angle, declination angle 도식도. (출처: Estimation of Hourly, Daily and Monthly Global Solar Radiation on Inclined Surfaces: Models Re-Visited)&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/solarradiation/declinationangle.png&quot; alt=&quot;Declination angle&quot; class=&quot;align-center&quot; /&gt;
&lt;em&gt;Declination angle의 연중 변화. (출처: A comprehensive solar angles simulation and calculation using Matlab)&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;실제 에너지시스템 최적화 문제를 풀 때 필요한 수치는 ‘$k$시부터 $k+1$시까지 도달한 총 에너지’ 이다. 이는 $k$시와 $k+1$시의 hour angle을 각각 $w_1$과 $w_2$라 할 때, 적분에 의해 아래와 같이 계산된다 (단위는 Wh).&lt;/p&gt;

&lt;p&gt;\begin{align} 
I_o = \int_{w_1}^{w_2} G_o dw = \frac{12}{\pi} G_{en} \left[ \text{cos} \phi \text{cos} \delta (\text{sin} \omega_2 - \text{sin} \omega_1) + \frac{\pi (\omega_2 - \omega_1)}{180} \text{sin} \phi \text{sin} \delta \right]
\notag
\end{align}&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;
&lt;h2 id=&quot;임의의-각도로-설치된-패널과-태양-광선-간-각도-계산&quot;&gt;임의의 각도로 설치된 패널과 태양 광선 간 각도 계산&lt;/h2&gt;

&lt;p&gt;지금까지의 논의는 모두 수평면에 도달하는 일사량에 대한 것이었다. 그러나 태양광 패널은 지면으로부터 일정 각도로 기울어져 설치되며, 대부분의 경우 정남향을 향하게 설치되지만 그렇지 않은 경우도 꽤 있다.&lt;/p&gt;

&lt;p&gt;지상으로부터 $\beta$만큼의 경사각으로 기울어져 있고 남향을 기준으로 $\gamma$만큼의 각도로 틀어져 있는 (서향이면 플러스, 동향이면 마이너스) 패널의 법선과 그 평면에 직달하는 일사량 간의 각도를 $\theta$ (angle of incidence) 라 하자.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/solarradiation/theta.png&quot; alt=&quot;Declination angle&quot; class=&quot;align-center&quot; /&gt;
&lt;em&gt;태양광 패널의 설치각 및 angle of incidence. (출처: Optimal design and analysis of grid-connected photovoltaic under different tracking systems using HOMER)&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;이 때 $\theta$는 아래와 같이 계산된다.&lt;/p&gt;

&lt;p&gt;\begin{align} 
\text{cos} \theta = \text{sin} \delta \text{sin} \phi \text{cos} \beta - \text{sin} \delta \text{cos} \phi \text{sin} \beta \text{cos} \gamma + \text{cos} \delta \text{cos} \phi \text{cos} \beta \text{cos} \omega + \text{cos} \delta \text{sin} \phi \text{sin} \beta \text{cos} \gamma \text{cos} \omega + \text{cos} \delta \text{sin} \beta \text{sin} \gamma \text{sin} \omega
\notag
\end{align}&lt;/p&gt;

&lt;p&gt;위 식에서 $\beta=0$이면 지면 기준 ‘수평’면과 일사량 간의 각도 $\theta_z$ (zenith angle) 이다.&lt;/p&gt;

&lt;p&gt;\begin{align} 
\text{cos} \theta_z = \text{cos} \phi \text{cos} \delta \text{cos} \omega + \text{sin} \phi \text{sin} \delta 
\notag
\end{align}&lt;/p&gt;

&lt;p&gt;잘 보면, $G_{0}$ 계산식에 $\text{cos} \theta_z$가 포함되어 있다.&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;
&lt;h2 id=&quot;대기의-효과를-고려한-유효-일사량-계산&quot;&gt;대기의 효과를 고려한 유효 일사량 계산&lt;/h2&gt;

&lt;p&gt;$I_o$는 태양광이 대기를 뚫고 지면에 도달하는 과정에서 대기의 영향을 고려하지 않은 값이다. 실제로는 대기에서 산란이 발생하므로, 이 효과를 고려해야 한다.&lt;/p&gt;

&lt;p&gt;대기 효과를 고려해 최종적으로 수평 지표면에 도달하는 일사량을 수평면전일사량 (Global Horizontal Irradiance, GHI) $I$라 하며, &lt;a href=&quot;https://data.kma.go.kr/data/grnd/selectAsosRltmList.do?pgmNo=36&quot;&gt;기상청 종관기상관측자료&lt;/a&gt;에서 제공하는 일사량 값이 GHI이다.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/solarradiation/irradiancedata.png&quot; alt=&quot;Declination angle&quot; class=&quot;align-center&quot; width=&quot;70%&quot; /&gt;
&lt;em&gt;기상청 종관기상관측자료에서 제공하는 시간별 GHI 데이터. 단위가 MJ/$m^2$임에 주의 (필자는 태양광 패널 성능곡선 단위가 W임에 착안해 1000을 곱한 후 3.6으로 나눈 값을 사용한다).&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;지표면에 도달하는 일사량은 두 가지 성분으로 나눌 수 있다. 하나는 태양에서 지표면까지 직달하는 beam (direct) radiation $I_b$이고, 다른 하나는 대기 중에서 산란되어 해당 지표면에 도달하는 diffuse radiation $I_d$이다.&lt;/p&gt;

&lt;p&gt;한편 지표면에 도달한 태양 에너지의 일부는 우주로 반사되어 나가며, 반사되는 에너지의 비율을 albedo라 한다. Albedo의 연중 평균값은 대략 $\rho_g \approx 0.35$ 이다.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/solarradiation/diffuse.png&quot; alt=&quot;Erbs&apos; correlation&quot; class=&quot;align-center&quot; width=&quot;60%&quot; /&gt;
&lt;em&gt;Beam radiation과 diffuse radiation의 concept. (출처: https://faculty.uml.edu/Nelson_Eby/ENVI.5720/Instructor%20Pdfs/Chapt%209%20-%20Solar%20Power.pdf)&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;만약 $I=I_b + I_d$ 뿐 아니라 $I_b$와 $I_d$ 각각의 값을 안다면, 아래의 HDKR 모델 (Hay, Davies, Klucher, Reindl) 을 이용해 실제 태양광 발전량 계산의 기준이 되는 일사량 $I_T$ 를 계산할 수 있다.&lt;/p&gt;

&lt;p&gt;\begin{align} 
I_T = \left(I_b + \frac{I_d I_b}{I_o}\right) \frac{\text{cos} \theta}{\text{cos} \theta_z} + I_d \left(1- \frac{I_b}{I_o}\right) \left(\frac{1+\text{cos}\beta}{2}\right) \left[ 1 + \sqrt{\frac{I_b}{I}} \text{sin}^3 (\frac{\beta}{2}) \right] + I \rho_g \left(\frac{1-\text{cos}\beta}{2}\right)
\notag
\end{align}&lt;/p&gt;

&lt;p&gt;$I_b$와 $I_d$의 값들을 추정하는 방법으로 Erbs’ correlation이 있다. 이는 $I_d/I$를 $K_T=I/I_o$로 정의되는 clearness index의 함수로 근사하는 correlation으로, $I$를 알면 $I_d$를 추정하고 이로부터 $I_b$ 또한 추정할 수 있다. 구체적 식은 아래와 같다.&lt;/p&gt;

&lt;p&gt;\begin{align} 
I_d/I = 
\begin{array}{rl}
1 - 0.09 K_T &amp;amp; \text{if } K_T \leq 0.22, \newline
0.9511 - 0.1604 K_T + 4.388 K_T^2 - 16.638 K_T^3 + 12.336 K_T^4 &amp;amp; \text{if } 0.22 \leq K_T \leq 0.80, \newline
0.165 &amp;amp; \text{if } 0.80 &amp;lt; K_T
\end{array}
\notag
\end{align}&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/solarradiation/erbs.png&quot; alt=&quot;Erbs&apos; correlation&quot; class=&quot;align-center&quot; width=&quot;50%&quot; /&gt;
&lt;em&gt;Clearness index와 $I_d/I$ 간 관계 (Erbs’ correlation)&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;
&lt;h2 id=&quot;일사량을-태양광-패널-출력으로-변환&quot;&gt;일사량을 태양광 패널 출력으로 변환&lt;/h2&gt;

&lt;p&gt;패널에 도달하는 일사량 $I_T$를 태양광 발전량 $P_{pv}$로 변환하기 위해선 태양광 패널의 성능 곡선이 필요하다. 일반적으로 아래 그림처럼 nominal efficiency (세로축이 1.00일 때의 변환효율, 이를테면 15.1퍼센트) 대비 상대적인 값이 $I_T$의 함수로 주어진다.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/solarradiation/pvperformance.png&quot; alt=&quot;Performance of PV panel&quot; class=&quot;align-center&quot; width=&quot;60%&quot; /&gt;
&lt;em&gt;태양광 패널의 성능곡선.&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;위 그림의 가로축의 단위는 W이지만 $I_T$의 단위는 Wh이다. 그러므로 편의상, 해당 1시간 동안 일사량의 세기는 일정하다고 가정하여, $I_T$의 값을 위 성능곡선에 대입해 $P_{pv}$를 계산한다.&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;
&lt;h2 id=&quot;계산-모델-검증&quot;&gt;계산 모델 검증&lt;/h2&gt;

&lt;p&gt;아래 그림은, 모 지역의 정수시설에 설치된 태양광 패널의 특정 연도의 5월 실제 발전량 기록 (파란색) 과, 해당 지점으로부터 약 16km 떨어진 기상대에서 측정된 GHI와 이 포스팅에서 소개한 HDKR 모델로 계산된 태양광 발전량 추정치 (빨간색) 를 비교한 결과이다.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/solarradiation/val_1st.png&quot; alt=&quot;Validation: 1st half&quot; class=&quot;align-center&quot; /&gt;
&lt;img src=&quot;/assets/images/solarradiation/val_2nd.png&quot; alt=&quot;Validation: 2nd half&quot; class=&quot;align-center&quot; /&gt;
&lt;em&gt;태양광 패널의 실제 발전량 기록 (파랑) 과 모델 기반 계산 결과 (빨강) 비교. 세로축 단위는 kW.&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;모델이 실제 발전량과 충분히 유사한 값을 계산해줌을 볼 수 있다. 참고로 27~30일은 시설 유지보수가 있었던 것으로 추정된다.&lt;/p&gt;
</description>
        <pubDate>Sat, 25 Nov 2023 00:00:00 +0900</pubDate>
        <link>https://song4energyndata.github.io/hourlysolar.html</link>
        <guid isPermaLink="true">https://song4energyndata.github.io/hourlysolar.html</guid>
        
        <category>태양광</category>
        
        
        <category>dataset</category>
        
      </item>
    
      <item>
        <title>Optimal power flow 예제 소개 문헌 및 풀이 코드</title>
        <description>&lt;p&gt;&lt;a href=&quot;https://song4energyndata.github.io/linprogone.html&quot;&gt;필자의 ‘선형계획법 기반 분산에너지시스템 최적화’ 시리즈 글&lt;/a&gt;에서는, 유효전력의 수요-공급을 고려하는 설비도입계획을 다루었다. 그러나 기 구축된 대규모 발송전시스템의 실제 운영은, 각 발전기 및 bus의 전압/ 무효전력/ 위상도 고려하는 optimal power flow (OPF) 문제를 풀어 이루어진다.&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;
&lt;h2 id=&quot;opf-예시-및-문헌-소개&quot;&gt;OPF 예시 및 문헌 소개&lt;/h2&gt;

&lt;p&gt;이를테면 아래 그림의 교류전력망에 대해 OPF 문제를 풀어, 각 발전기의 유효전력과 무효전력 공급량 및 변압기의 전압비와 위상차를 결정해야 한다. 단, 2개 bus에서의 전력부하를 충족하고, 각 bus의 전압 크기와 위상각을 적정 범위 내로 유지하면서, 3개 발전기 연료비의 합을 최소화해야 한다.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/opf/network.png&quot; alt=&quot;optimal power flow&quot; class=&quot;align-center&quot; /&gt;
&lt;em&gt;5개의 bus, 3개의 발전기, 2개의 부하로 이루어진 전력망 대상 OPF 문제. 출처: An introduction to optimal power flow: Theory, formulation, and examples&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;OPF 문제를 제대로 다루려면 전력시스템공학을 제대로 공부해야 한다. 이를테면 필자는 서울대학교 대학원 재학 시절 &lt;a href=&quot;http://sepri.snu.ac.kr/ko/node/9&quot;&gt;문승일 교수님&lt;/a&gt;의 전력시스템공학 수업에서 &lt;a href=&quot;https://www.amazon.com/Power-Systems-Analysis-Arthur-Bergen/dp/0136919901&quot;&gt;Power System Analysis&lt;/a&gt; 교재를 공부했었다. 그러나 전력시스템공학의 내용이 방대하고 복잡하여, 본인 연구에 직접 적용하지 않는 한 대부분의 내용을 잊어버리기 쉽다.&lt;/p&gt;

&lt;p&gt;다행히, OPF 문제의 기초를 ‘수학적 최적화 문제 구성 및 풀이’ 관점에서 간결하게 설명한 문헌이 있다. &lt;a href=&quot;http://kgut.ac.ir/useruploads/1544077350809fgp.pdf&quot;&gt;An introduction to optimal power flow: Theory, formulation, and examples&lt;/a&gt; 이다.&lt;/p&gt;

&lt;p&gt;이번 포스팅에서는, 해당 문헌의 OPF 문제 설명 및 numerical example 풀이 코드를 한국어로 재설명한다.&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;
&lt;h2 id=&quot;opf-풀이에-쓰이는-수식들&quot;&gt;OPF 풀이에 쓰이는 수식들&lt;/h2&gt;

&lt;p&gt;Bus $1,2,\dots,N$의 복소전압 (즉 범위제약 대상인 전압 크기와 위상각 정보를 담은 복소수) 들을 원소로 하는 복소벡터를 $\tilde{V} = (\tilde{V}_1,\dots,\tilde{V}_N)$ 라 하자.&lt;/p&gt;

&lt;p&gt;그리고 bus $i$의 복소전력을 $S_i = P_i + j Q_i$ 라 하고 ($j=\sqrt{-1}$), 유효전력 $P_i = P_i^G - P_i^L$ 를 bus $i$에서 발전되는 유효전력 $P_i^G$와 소비되는 유효전력 $P_i^L$ 간 차이라 하고, 비슷하게 무효전력 $Q_i = Q_i^G - Q_i^L$ 이라 하며, bus $1,2,\dots,N$의 복소전력들을 원소로 하는 복소벡터를 $S = (S_1, \dots, S_N)$ 라 하자.&lt;/p&gt;

&lt;p&gt;그러면 복소전류 벡터를 $\tilde{I}$라 할 때 $S = \tilde{V} \circ \tilde{I}^{*}$이다 ($\circ$는 두 벡터 간에 각각 대응하는 원소끼리의 곱, 윗첨자 *는 켤레복소수).&lt;/p&gt;

&lt;p&gt;이렇게 되는 이유는, 교류 전압을 $v(t) = V_{max} \text{cos}(wt+\theta_V)$라 하고 교류 전류를 $i(t) = I_{max} cos(wt+\theta_I)$라 할 때 전력이 아래와 같이 계산되고,&lt;br /&gt; 
$p(t) = v(t)i(t) = 0.5 V_{max}I_{max}[\text{cos}(\theta_V - \theta_I) + \text{cos}(2wt + \theta_V + \theta_I)]$&lt;br /&gt;&lt;br /&gt;
‘시간에 대한 평균’ 전력은 $0.5 V_{max}I_{max}[\text{cos}(\theta_V - \theta_I)]$이며, 복소전압 $V$와 복소전류 $I$를 각각 $\vert V \vert = V_{max}/\sqrt{2}$, $\vert I \vert = I_{max}/\sqrt{2}$ 가 되게 정의하면 평균적 전력은 아래처럼 계산되기 때문이다.&lt;br /&gt; 
$P = \text{Re} \vert V \vert e^{j \theta_V} \vert I \vert e^{-j \theta_I} = \text{Re} V I^{*}$&lt;/p&gt;

&lt;p&gt;한편 $\tilde{I}$와 $\tilde{V}$ 간에는 $\tilde{I} = \tilde{Y} \tilde{V}$의 관계가 성립하며, 복소행렬 $\tilde{Y}$를 admittance matrix라 한다. 이는 전류가 잘 흐르는 정도를 나타내는 system parameter로 볼 수 있다.&lt;/p&gt;

&lt;p&gt;즉, admittance matrix를 $\tilde{Y}$를 구해야 OPF 문제를 풀 수 있다.&lt;/p&gt;

&lt;p&gt;특정 두 bus $i$와 $k$를 잇는 전선의 resistance (전력을 소모하는 성분) 을 $R_{ik}$, reactance (코일 등에 의해 교류전력의 위상을 바꾸는 성분) 를 $X_{ik}$라 하면, 해당 전선의 교류전압과 교류전류의 비인 impedence는 $R_{ik} + j X_{ik}$ 이다.&lt;/p&gt;

&lt;p&gt;Admittance matrix 계산에서는 impedence의 역수인 series admittance $\tilde{y}_{ik} = (R_{ik} + j X_{ik})^{-1}$를 활용한다.&lt;/p&gt;

&lt;p&gt;한편 전선 및 bus 자체에서 전류 누설이 발생할 수 있는데, 이에 관련된 admittance parameter를 shunt admittance라 한다. 두 bus $i$와 $k$를 잇는 전선의 shunt admittance는 $\tilde{y}_{ik}^{Sh}$로, bus $i$ 자체에서의 shunt admittance는 $\tilde{y}_i^{S}$로 표기한다.&lt;/p&gt;

&lt;p&gt;서로 다른 두 bus $i$와 $k$를 잇는 전선이 존재할 경우 순서쌍 $(i,k)$가 집합 $\textbf{L}$에 속한다고 하고, $(i,k) \in \textbf{L}$ 이면 $(k,i) \notin \textbf{L}$ 이라고 하자.&lt;/p&gt;

&lt;p&gt;그러면, admittance matrix $\tilde{Y}$의 각 성분 $\tilde{Y}_{ik}$는 아래와 같이 계산된다.&lt;/p&gt;

&lt;p&gt;\begin{align} 
\tilde{Y}_{ii} = \tilde{y}_i^{S} +\sum_{k:(i,k) \in \textbf{L}} \frac{1}{\vert a_{ik} \vert^2} (\tilde{y}_{ik} + \frac{1}{2} \tilde{y}_{ik}^{Sh})+ \sum_{k:(k,i) \in \textbf{L}} (\tilde{y}_{ki} + \frac{1}{2} \tilde{y}_{ki}^{Sh})
\notag
\end{align}
\begin{align} 
\tilde{Y}_{ik} = - \sum_{k:(i,k) \in \textbf{L}} \frac{1}{ a_{ik}^{*}} \tilde{y}_{ik} - \sum_{k:(k,i) \in \textbf{L}} \frac{1}{ a_{ki}} \tilde{y}_{ki} \quad (i \ne k)
\notag
\end{align}&lt;/p&gt;

&lt;p&gt;여기서 $a_{ik}=T_{ik} e^{j \phi_{ik}}$는 변압을 의미한다. 변압기가 따로 없으면 1이고, 변압기가 있으면 $T_{ik}$는 전압비, $\phi_{ik}$는 변압기 전후 위상차이다.&lt;/p&gt;

&lt;p&gt;그리고 $\tilde{Y}_{ik} = G_{ik} + j B_{ik}$라 하고 ($G_{ik}$를 conductance, $B_{ik}$를 susceptance라 함), 복소전압 $\tilde{V}_i = V_i e^{j \delta_i}$로 나타낼 때, bus $i$에서의 복소전력 $S_i = P_i + j Q_i$를 구하는 식은 아래와 같다.&lt;/p&gt;

&lt;p&gt;\begin{align} 
P_i = V_i \sum_{k=1}^N V_k [G_{ik} \text{cos}(\delta_i - \delta_k) + B_{ik} \text{sin} (\delta_i - \delta_k)]
\notag
\end{align}
\begin{align} 
Q_i = V_i \sum_{k=1}^N V_k [G_{ik} \text{sin}(\delta_i - \delta_k) - B_{ik} \text{cos} (\delta_i - \delta_k)]
\notag
\end{align}&lt;/p&gt;

&lt;p&gt;이를 power flow equation이라 한다.&lt;/p&gt;

&lt;p&gt;최적화 문제 코딩을 위해 power flow equation을 우변이 0인 형태로 다시 쓰고 $P_i = P_i^G - P_i^L$, $Q_i = Q_i^G - Q_i^L$ 를 대입하면 아래와 같다.&lt;/p&gt;

&lt;p&gt;\begin{align} 
P_i^L - P_i^G + V_i \sum_{k=1}^N V_k [G_{ik} \text{cos}(\delta_i - \delta_k) + B_{ik} \text{sin} (\delta_i - \delta_k)] = 0 
\notag
\end{align}
\begin{align} 
Q_i^L - Q_i^G + V_i \sum_{k=1}^N V_k [G_{ik} \text{sin}(\delta_i - \delta_k) - B_{ik} \text{cos} (\delta_i - \delta_k)] = 0
\notag
\end{align}&lt;/p&gt;

&lt;p&gt;이제 OPF 문제를 구성한다. OPF로 결정해야 할 변수들은 아래와 같다.&lt;/p&gt;

&lt;p&gt;1) 각 bus의 전압의 크기와 위상각&lt;br /&gt;
2) Bus 1,3,4의 발전기의 유효전력과 무효전력&lt;br /&gt;
3) Bus 3과 4 간 변압기의 위상차 (전압비는 1:1로 고정임)&lt;br /&gt;
4) Bus 3과 5 간 변압기의 전압비 (위상차는 0으로 고정임)&lt;/p&gt;

&lt;p&gt;등호 제약조건은 위 power flow equation이고, 부등호 제약조건은 각 bus 별 전압과 위상각의 적정 범위, 각 발전기 별 유효전력과 무효전력 출력의 상하한, 변압기의 전압비와 위상차의 상하한이다. 목적함수는 각 발전기 별 연료비의 합으로, 각 발전기 별 유효전력 출력의 이차함수로 주어진다.&lt;/p&gt;

&lt;p&gt;주어지는 데이터는 각 전선 별 resistance/ reactance/ shunt admittance, 각 bus 별 shunt admittance, 각 부하의 요구 유효전력과 무효전력 값, bus 별 전압의 상하한 값, 발전기의 유효전력출력과 무효전력출력의 상하한 값이다.&lt;/p&gt;

&lt;p&gt;이 문헌에서 소개하는 OPF 문제는 ‘한 시점에 대한’ 문제임에 주의한다. 해당 OPF 문제는 여러 시점들에 걸친 스케줄링 문제가 아니다.&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;
&lt;h2 id=&quot;예제-풀이용-python-코드&quot;&gt;예제 풀이용 python 코드&lt;/h2&gt;

&lt;p&gt;필요한 라이브러리는 Numpy, 그리고 비선형 최적화 문제의 제약조건 구현과 풀이에 필요한 Scipy.optimize의 NonlinearConstraint와 minimize 모듈이다.&lt;/p&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;numpy&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;scipy.optimize&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;NonlinearConstraint&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;minimize&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;최적화 문제를 코드로 풀 때는 값을 결정할 변수들이 단일 벡터 $x$의 원소인데, $x$의 각 원소의 인덱스를 아래처럼 물리량의 이름을 따서 부여하면 코드를 읽기 쉽고 실수도 줄어든다.&lt;/p&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;v_bus&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;arange&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# 인덱스 0~4는 각 bus의 전압크기
&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;del_bus&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;arange&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# 인덱스 5~9는 각 bus의 전압위상각
&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;p_bus&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;arange&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;15&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# 인덱스 10~14는 각 bus 내 발전기의 유효전력 (발전기가 없으면 0)
&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;q_bus&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;arange&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;15&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;20&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# 인덱스 15~19는 각 bus 내 발전기의 무효전력 (발전기가 없으면 0)
&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;phi_transf&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;20&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# 인덱스 20은 bus 3과 4 간 변압기의 위상차
&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mag_transf&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;21&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# 인덱스 21은 bus 3과 5 간 변압기의 전압비
# 이를테면 # x[v_bus[0]] 은 1번 bus의 전압크기를, x[del_bus[1]] 은 2번 bus의 전압위상각을 의미
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;주어진 시스템 데이터인 각 전선 별 series admittance와 shunt admittance, 각 bus 별 shunt admittance, 각 부하의 유효전력 및 무효전력 요구치를 기재한다. 이 때 dtype=complex 로 두어 복소수로 쓴다.&lt;br /&gt;
또한 모든 물리량은 per unit 단위법으로 쓰였음에 주의한다.&lt;/p&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;n_bus&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;5&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;y_series&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;zeros&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n_bus&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n_bus&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dtype&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;complex&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# 각 전선의 series admittance
&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;y_sh_branch&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;zeros&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n_bus&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n_bus&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dtype&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;complex&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# 각 전선의 shunt admittance
&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;y_sh_bus&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;zeros&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n_bus&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dtype&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;complex&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# 각 bus의 shunt admittance
&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;y_series&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.3j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# bus 1과 2를 잇는 전선의 series admittance
&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;y_series&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.023&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.145j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# (i,k)가 L의 원소일 때 (k,i)는 L의 원소가 아닌 것과 같은 맥락으로 y_series[2,0] 은 설정하지 않음에 주의
&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;y_series&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.006&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.032j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;y_series&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.02&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.26j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;y_series&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.32j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;y_series&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.5j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;y_sh_branch&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.04j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# bus 1과 3을 잇는 전선의 shunt admittance
&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;y_sh_branch&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.01j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;y_sh_bus&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.3j&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# bus 2의 shunt admittance
&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;y_sh_bus&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.05&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0j&lt;/span&gt;
    
&lt;span class=&quot;n&quot;&gt;load_bus&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.9&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.4j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.239&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.129j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# bus 4와 5의 전력 부하
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;비선형 제약조건인 power flow equation을 $x$의 사용자 정의 함수로 정의한다. 먼저 admittance matrix $\tilde{Y}$를 계산하고, 그 뒤에 $P_i$와 $Q_i$에 대한 등식을 기재한다. 이 문제에서는 변압기가 있으므로 $\tilde{Y}$ 계산 내 $a_{ik}$가 최적화로 값을 구할 변수의 함수이기 때문에, $\tilde{Y}$ 계산이 사용자 정의 함수 내에서 이루어져야 함에 주의한다.&lt;/p&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;nonlconfun&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# 비선형 제약조건의 좌변을 변수들의 함수로 계산
&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;a_tx&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;ones&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n_bus&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n_bus&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dtype&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;complex&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# 변압비와 위상차 phasor        
&lt;/span&gt;    &lt;span class=&quot;n&quot;&gt;a_tx&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;exp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;1j&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;phi_transf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# bus 3과 4 간 변압기의 위상차는 최적화로 도출 필요
&lt;/span&gt;    &lt;span class=&quot;n&quot;&gt;a_tx&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mag_transf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;exp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;1j&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# bus 3과 5 간 변압기의 전압비는 최적화로 도출 필요
&lt;/span&gt;    
    &lt;span class=&quot;n&quot;&gt;y_full&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;zeros&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n_bus&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n_bus&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dtype&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;complex&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# admittance matrix
&lt;/span&gt;    
    &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;fr&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n_bus&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;y_full&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y_sh_bus&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# Y_ii
&lt;/span&gt;        &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;to&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n_bus&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;y_full&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y_full&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;y_series&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;to&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.5&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;y_sh_branch&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;to&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;abs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;a_tx&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;to&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;y_series&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;to&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.5&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;y_sh_branch&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;to&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;to&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;fr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# Y_ik
&lt;/span&gt;                &lt;span class=&quot;n&quot;&gt;y_full&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;to&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y_full&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;to&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y_series&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;to&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;conjugate&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;a_tx&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;to&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y_series&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;to&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;a_tx&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;to&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; 
    
    &lt;span class=&quot;n&quot;&gt;ceq&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;zeros&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n_bus&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# 제약조건의 좌변 값을 담을 벡터
&lt;/span&gt;    
    &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;m&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n_bus&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# Power flow equation
&lt;/span&gt;        &lt;span class=&quot;n&quot;&gt;ceq&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;m&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;real&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;load_bus&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;m&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;p_bus&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;m&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]]&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# 인덱스 0, 1, ..., m-1은 유효전력
&lt;/span&gt;        &lt;span class=&quot;n&quot;&gt;ceq&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n_bus&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;m&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;imag&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;load_bus&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;m&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;q_bus&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;m&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]]&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# 인덱스 m, m+1, ..., 2m-1은 무효전력
&lt;/span&gt;        &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;k&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n_bus&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;ceq&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;m&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ceq&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;m&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;v_bus&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;m&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;v_bus&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;k&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;real&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;y_full&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;m&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;k&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;cos&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;del_bus&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;m&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;del_bus&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;k&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]])&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;imag&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;y_full&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;m&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;k&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;sin&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;del_bus&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;m&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;del_bus&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;k&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]]))&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# real power at bus m
&lt;/span&gt;            &lt;span class=&quot;n&quot;&gt;ceq&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n_bus&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;m&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ceq&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n_bus&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;m&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;v_bus&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;m&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;v_bus&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;k&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;real&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;y_full&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;m&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;k&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;sin&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;del_bus&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;m&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;del_bus&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;k&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]])&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;imag&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;y_full&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;m&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;k&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;cos&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;del_bus&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;m&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;del_bus&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;k&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]]))&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# reactive power at bus m
&lt;/span&gt;    
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ceq&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# 제약조건의 좌변 값을 반환
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;목적함수를 $x$의 사용자 정의 함수로 정의한다. 목적함수인 발전기의 연료비의 합은 각 발전기 별 유효전력의 이차함수이다.&lt;/p&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;objfun&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;cost&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.35&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;p_bus&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;p_bus&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.4&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;p_bus&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.3&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;p_bus&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.5&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;p_bus&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;cost&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;각 변수의 상하한을 설정하되, 1번 bus를 slack bus로 생각하고 설정한다. 초기값은 변수별 상하한 간 중간값으로 설정한다.&lt;/p&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;bounds&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# Bus 1은 Slack Bus이므로 전압크기 1로 고정
&lt;/span&gt;        &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.95&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;1.05&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.95&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;1.05&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.95&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;1.05&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.95&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;1.05&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# Bus 1은 Slack Bus이므로 위상각 0으로 고정
&lt;/span&gt;        &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pi&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pi&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# 위상각의 단위가 radian임에 주의
&lt;/span&gt;        &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pi&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pi&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pi&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pi&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pi&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pi&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# Bus 1은 unrestricted
&lt;/span&gt;        &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# Bus 2에는 발전기 없어 0으로 고정
&lt;/span&gt;        &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.05&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# Bus 5에는 발전기 없어 0으로 고정
&lt;/span&gt;        &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# Bus 1은 unrestricted
&lt;/span&gt;        &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# Bus 2에는 발전기 없어 0으로 고정
&lt;/span&gt;        &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# Bus 5에는 발전기 없어 0으로 고정
&lt;/span&gt;        &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pi&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;6&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pi&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;6&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.95&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;1.05&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)]&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;initialpoint&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;bounds&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)[:,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;bounds&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)[:,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Power flow equation은 복잡한 비선형 방정식이다. 그러므로 일반적인 비선형 문제를 푸는 solver를 사용해야 한다. 여기서는 Scipy.optimize의 NonlinearConstraint와 minimize 모듈을 이용한다.&lt;/p&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;nonlcon&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;NonlinearConstraint&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;nonlconfun&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;zeros&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n_bus&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,)),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;zeros&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n_bus&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,)))&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# 모든 변수들에 대해 우변의 하한과 상한이 모두 0, 즉 우변이 0인 등호조건
&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;sol&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;minimize&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;objfun&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;initialpoint&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;bounds&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;bounds&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;constraints&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;nonlcon&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# solver로 OPF 문제 풀기
&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;solution&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;multiply&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sol&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# 전압 위상각의 단위를 radian에서 degree로 변환
&lt;/span&gt;                       &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;180&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pi&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;180&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pi&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;180&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pi&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;180&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pi&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;180&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pi&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;180&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pi&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]))&lt;/span&gt;
&lt;span class=&quot;nf&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;solution&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;v_bus&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]],&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;solution&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;v_bus&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]],&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;solution&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;v_bus&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]],&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;solution&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;v_bus&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]],&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;solution&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;del_bus&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]],&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;solution&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;del_bus&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]],&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;solution&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;del_bus&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]],&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;solution&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;del_bus&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]],&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;solution&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;p_bus&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]],&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;solution&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;p_bus&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]],&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;solution&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;p_bus&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]],&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;solution&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;q_bus&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]],&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;solution&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;q_bus&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]],&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;solution&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;q_bus&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]],&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;solution&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;phi_transf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;solution&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mag_transf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;          
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;코드를 실행하면, 논문에서 제시한 답과 같은 결과를 얻는다.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/opf/solution.png&quot; alt=&quot;solution of OPF&quot; class=&quot;align-center&quot; /&gt;
&lt;em&gt;OPF 문제의 해답 (좌측은 논문 내용, 우측은 필자가 작성한 코드의 마지막 print문 결과).&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;전체 코드는 &lt;a href=&quot;https://github.com/song4energyndata/Codes/blob/main/nonlinearoptimization/opfcode.py&quot;&gt;필자의 GitHub Repo&lt;/a&gt;에 업로드하였다.&lt;/p&gt;

&lt;p&gt;해당 numerical example의 한계점은, 각 전선의 전류량 상한을 고려하지 않았다는 점이다. 실제로는 전선에 전류가 지나치게 많이 흐르면 전선이 열손상을 입기 때문에, 전선별로 thermal limit이 있다. 필요 시 전선 별 thermal limit을 추가적인 비선형 부등호 제약조건으로 반영해야 할 것으로 보인다.&lt;/p&gt;
</description>
        <pubDate>Sat, 11 Nov 2023 00:00:00 +0900</pubDate>
        <link>https://song4energyndata.github.io/opf.html</link>
        <guid isPermaLink="true">https://song4energyndata.github.io/opf.html</guid>
        
        <category>Optial Power Flow</category>
        
        <category>경제성분석</category>
        
        
        <category>optimalsystem</category>
        
      </item>
    
      <item>
        <title>국내 전력시장 주요 운영규칙 핵심사항 정리</title>
        <description>&lt;p&gt;최근 에너지 플랫폼 업계 현직자들과 대화를 하며, 국내 전력시장 운영규칙을 상세히 알 필요성을 느꼈다. 본격적으로 에너지 플랫폼 업계에 종사한다면 전력시장 입찰을 전제로 한 에너지 설비들의 데이터 및 비즈니스 모델을 주로 분석하게 될 것이라 생각했기 때문이다. (그간 필자는 BTM (Behind-the-Meter) 단의 에너지 설비 도입을 통한 수요처 에너지 요금 절감량 분석 프로젝트들을 주로 수행했다)&lt;/p&gt;

&lt;p&gt;이에, 전력시장 운영규칙 및 관련 시장제도 설명 원문을 읽고, 방대한 내용들 중 비즈니스모델의 정량적 분석을 위해 필수적으로 알아야 할 것으로 보이는 항목들을 요약하여 이 포스트에 기록하였다. 특히 구체적 수치가 있으면 가능한 한 포함하였다. (기록된 항목 못지않게 중요한 항목들 및 제도 개정으로 인해 변경된 항몰들은 앞으로 꾸준히 업데이트해나갈 예정이다)&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;
&lt;h2 id=&quot;발전-전력량-정산&quot;&gt;발전 전력량 정산&lt;/h2&gt;

&lt;p&gt;내용 출처: &lt;a href=&quot;https://new.kpx.or.kr/board.es?mid=a10502000000&amp;amp;bid=0045&amp;amp;act=view&amp;amp;list_no=51715&amp;amp;tag=&amp;amp;nPage=12&quot;&gt;전력거래소 정산규칙해설서 (2019)&lt;/a&gt;&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;하루전 시장에서의 market clearing을 통해, 시간별로 예측수요를 최종적으로 충족시키는 발전기의 변동비가 해당 시간의 계통한계가격 (SMP) 로 결정됨.&lt;/li&gt;

&lt;li&gt;발전기가 하루전 발전계획에 포함된 발전량 범위 내에서 실제로 발전한 양에 대해, 시장가격 (MP) 을 단가로 하여 정산함. 이를 계획발전 전력량 정산금 (Scheduled Energy Payment, SEP) 이라 함.&lt;br /&gt;&lt;br /&gt;

시장가격은 SMP와 다름. 시장가격은 발전기와 전력수요지와의 거리에 따른 송전손실 차이를 반영하기 위해 SMP에 송전손실계수 (TLF) 를 곱한 값임.&lt;br /&gt;&lt;br /&gt;

이를테면 최대 수요지인 서울에 가까운 포천복합/ 하남열병합 등은 송전손실이 작으므로 TLF가 1보다 크고, 서울에서 먼 월성원자력/ 호남화력 등은 송전손실이 크므로 TLF가 1보다 작음.&lt;br /&gt;&lt;br /&gt;

가격결정발전계획에 포함된 발전기의 변동비는 SMP보다 작거나 같으므로, 발전량에 대해 MP를 정산받으면 변동비를 회수하고도 수익을 얻음. &lt;br /&gt;
(단, 유연탄 및 원자력 발전은 수익 조정을 위한 정산조정계수를 적용받음 (0에서 1 사이))&lt;/li&gt;

&lt;li&gt;발전기가 하루전 발전계획 대비 초과 발전한 경우, 해당 초과분에 대해 정산하는 금액은 추가발전 사유가 발전사에 있느냐 전력계통에 있느냐에 따라 다름.&lt;/li&gt;

&lt;li&gt;발전기가 자체성능시험/ 열제약 등 계통사유가 아닌 발전사 사유로 초과 발전한 경우, 초과 발전량에 대해 무부하비 제외 변동비와 시장가격 중 작은 값을 정산함. 이를 발전사업자 제약 발전 전력량 정산금 (Payment by Market Price for Minimum Energy produced due to Generator-self Constraint, GSCON) 이라 함.&lt;br /&gt;&lt;br /&gt;

(무부하비란 발전기를 전력시스템에 동기화시키되 출력은 내지 않을 때 소요되는 비용임, 자동차가 공회전할 때의 연료비에 비유할 수 있음, 무부하운전을 해야 발전기의 온도를 적정 상태로 맞추어 출력변경에 제때 응동할 수 있음.)&lt;br /&gt;&lt;br /&gt;

초과 발전량에 대한 해당 발전기의 무부하비 제외 변동비가 시장가격보다 높다면 초과 발전량에 대해서는 변동비를 회수하지 못하고, 변동비가 시장가격보다 낮다면 변동비만 회수 가능하고 시장가격으로 전력을 판매하지 못함.&lt;br /&gt;&lt;br /&gt;

단, 열공급 발전기가 하루전계획에는 포함되지 않았으나 실제로는 지역난방 난방수요 충족 등을 이유로 열제약 운전을 하는 경우, 열전비와 발전량에 따라 무부하비 일부를 지급함. 열전비가 작을수록, 변경공급가능용량 대비 실제 발전량이 클수록 무부하비 지급 비율이 커짐.&lt;/li&gt;

&lt;li&gt;발전기가 송전제약/ 수요예측오차 등 계통사유로 초과 발전한 경우, 초과 발전량에 대해 변동비와 시장가격 중 큰 값을 정산함. 이를 계통제약 발전 전력량 정산금 (payment for energy produced due to System Constraints, SCON) 이라 함.&lt;br /&gt;&lt;br /&gt;

가격결정계획에 반영되지 못한 발전량에 대해서는 변동비가 SMP보다 클 것이므로, 변동비를 회수할 수 있도록 변동비를 정산함.&lt;br /&gt;&lt;br /&gt;

특히 가격계획에 반영되지 않았고 자가제약도 없어 원래대로라면 기동하지 않았을 발전기가 계통 사유로 기동한 경우, 변동비 산정에 무부하비도 포함.&lt;/li&gt;

&lt;li&gt;발전기가 하루전 발전계획에 포함된 발전량을 &apos;계통 지시에 의해 감발하거나 정지하여&apos; 실제로는 발전하지 않은 경우, 발전했더라면 거둬들였을 기대 이익을 정산함. 이를 제약 비발전 전력량 정산금 (Constrained-off energy payment, COFF) 이라 함.&lt;br /&gt;&lt;br /&gt;

기대이익 단가는 시장가격과 변동비의 차이임.&lt;br /&gt;&lt;br /&gt;

감발한 급전발전기는 수요 증가에 의한 주파수 하락 시 출력 증가를 통해 주파수 회복에 기여할 수 있으므로, COFF는 일종의 예비력 정산금과 같이 볼 수 있음.&lt;/li&gt;

&lt;li&gt;비중앙급전 발전기에 대해서는 실제 발전량을 SMP로 정산하고, 기타 사항은 정산하지 않음.&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;
&lt;h2 id=&quot;용량가격-보조서비스가격-정산&quot;&gt;용량가격/ 보조서비스가격 정산&lt;/h2&gt;

&lt;p&gt;내용 출처: &lt;a href=&quot;https://new.kpx.or.kr/board.es?mid=a10502000000&amp;amp;bid=0045&amp;amp;act=view&amp;amp;list_no=51715&amp;amp;tag=&amp;amp;nPage=12&quot;&gt;전력거래소 정산규칙해설서 (2019)&lt;/a&gt;&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;전력시장에 입찰하는 급전가능 발전기들에 대해, 공통적으로 공급가능용량에 대한 용량요금 (Trading Period Capacity Payment, CP) 을 정산함 (입찰은 했으나 하루전 발전계획에 포함되지 않은 발전기가 실제로도 발전하지 않은 경우에도 정산).&lt;br /&gt;&lt;br /&gt;

초기입찰 후 공급가능용량을 낮추어서 변경입찰 시 최종 공급가능용량 기준으로 정산함. 반대로 초기입찰 후 공급가능용량을 높여 변경입찰하더라도 초기입찰용량 기준으로 정산함. 이는 공급용량을 정확히 예측하라는 의미임.&lt;br /&gt;&lt;br /&gt;

단, 복합발전기 가스터빈의 경우 외기온도 저하로 공기밀도가 증가하면 공급가능용량이 증가함. 그러므로 거래일의 예측기온과 당일의 실제기온 간 차이를 보정한 온도보정 입찰값을 변경입찰값과 비교해 산정함.&lt;/li&gt;

&lt;li&gt;용량가격은 용량에 일반용량가격(용량당 단가)과 용량가격보정계수의 합을 곱하여 계산함. 일반용량가격은 기준용량가격, 용량가격계수, 시간대별용량가격계수, 연료전환성과계수 네 값의 곱임. 용량가격계수와 연료전환성과계수는 발전기 별로 상이함.&lt;/li&gt;

&lt;li&gt;비중앙급전 발전기의 경우 용량요금은 지불하지 않음.&lt;/li&gt;

&lt;li&gt;주파수 추종 운전상태를 30분 이상 유지하는 발전기에 대해 주파수 추종 서비스 정산금액을 지불함. 또한 자동발전제어 서비스 (주파수 제어 관련) 를 제공한 발전기에 대해 제어가용률 및 제어성과 가중치를 반영한 정산금액을 지불함.&lt;br /&gt;&lt;br /&gt;

발전사업자가 소유한 중앙급전 전기저장장치가 주파수추종 또는 원격출력제어 서비스를 제공한 경우에도 위 규칙을 준용해 정산함.&lt;/li&gt;

&lt;li&gt;예비력 (20분 또는 120분 이내 응동) 계획에 포함된 발전기는 지정된 에비력 용량에 대해 발전 여부에 상관없이 예비력 정산금을 받음 (발전하는 경우 에너지 정산금도 받음).&lt;br /&gt;&lt;br /&gt;

예비력 계획에 반영되었음에도 응동 및 발전하지 못하는 경우 예비력 정산금을 지불하지 않음은 물론, 예정 정산금의 3배를 환수함 (단, 고장 등 사유로 예비력 제공이 불가능해 사전 신고한 경우는 제외).&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;
&lt;h2 id=&quot;급전지시-미이행-시-패널티&quot;&gt;급전지시 미이행 시 패널티&lt;/h2&gt;

&lt;p&gt;내용 출처: &lt;a href=&quot;https://new.kpx.or.kr/board.es?mid=a10502000000&amp;amp;bid=0045&amp;amp;act=view&amp;amp;list_no=51715&amp;amp;tag=&amp;amp;nPage=12&quot;&gt;전력거래소 정산규칙해설서 (2019)&lt;/a&gt;&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;계통 연결 또는 분리를 지시받고 지시받은 시각보다 (허용오차를 초과해) 늦게 또는 빨리 이행하는 경우 패널티를 받음.&lt;br /&gt;&lt;br /&gt;

조기 계통연결 및 계통분리 지연시, 계획된 연결시간 이외 시간의 발전에 대한 계량값은 0으로 조정함.&lt;br /&gt;&lt;br /&gt;

조기 계통분리시 빨리 분리한 시간 동안의 공급가능용량은 0으로 조정, 계통연결 지연시 공급가능용량은 계량값으로 조정함
(이를테면 500MW 발전기가 15분 조기 분리 시 공급가능용량은 500MWh에 3분의 4를 곱한 375MWh).&lt;/li&gt;

&lt;li&gt;조기 계통연결 및 계통분리 지연은 공급 과잉으로 인한 주파수 상승을 야기하고, 조기 계통분리 및 계통연결 지연은 공급 부족으로 인한 주파수 하락을 야기함. 주파수 하락이 전력계통에 있어 더 큰 위협이므로, 조기 계통분리 및 계통연결 지연 시 패널티가 더 큼, 특히 계통연결 지연에 대해 매우 큰 패널티가 부여됨.&lt;/li&gt;

&lt;li&gt;발전사 사유로 급전지시량에 미달되게 발전하고도 적절한 변경입찰을 하지 않은 경우, 공급가능용량을 계량전력량으로 조정함.&lt;br /&gt;&lt;br /&gt;

급전지시량을 초과하여 발전하는 경우 초과발전량만큼 공급가능용량을 차감함. 또한 SEP를 실제 발전량이 아닌 차감된 공급가능용량 기준으로 정산함.&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;
&lt;h2 id=&quot;수요반응자원&quot;&gt;수요반응자원&lt;/h2&gt;

&lt;p&gt;내용 출처: &lt;a href=&quot;https://new.kpx.or.kr/board.es?mid=a10205010000&amp;amp;bid=0030&quot;&gt;전력거래소 전력시장운영규칙&lt;/a&gt;&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;고객기준부하 (수요반응에 참여하지 않았다면 사용했을 평상시 사용전력량 예측값) 기준으로 차이를 계산함. 전력부하감축량은 일반적으로 DR에서 말하는 감축량, 전력부하증대량은 플러스DR에 의해 사용량을 늘린 양&lt;/li&gt;

&lt;li&gt;각 거래시간 별 고객기준부하 산정 방식은 아래 중 택일.&lt;br /&gt;&lt;br /&gt;

1) 최근 평일 5일(참고일) 중 거래시간 사용전력량이 큰 순서대로 최대 4일(유사일) 선택, 유사일의 사용전력량 평균&lt;br /&gt;
2) 최근 평일 10일 중 거래시간 사용전력량 기준 최대 2일과 최소 2일 제외 후 남은 6일 평균&lt;br /&gt;
3) 최근 평일 6일 중 최대 1일과 최소 1일 제외 후 남은 4일 평균 (플러스DR/ 국민DR의 고객기준부하 산정)&lt;br /&gt;
4) 최근 평일 10일 중 최대 1일과 최소 1일 제외 후 남은 8일 평균 (국민DR의 고객기준부하 산정)&lt;br /&gt;
5) 최근 10분의 1분 단위 전력사용량 합에 6을 곱한 값 (주파수DR의 고객기준부하 산정)&lt;br /&gt;
6) 최근 공휴일/ 토요일 6일 중 최대 1일과 최소 1일 제외 후 남은 4일 평균 (플러스DR의 공휴일/ 토요일 전력부하증대량 평가를 위한 고객기준부하 산정)&lt;br /&gt;&lt;br /&gt;

비정상근무일 (생산설비 고장/ 창립기념일 등 평상시 전기소비형태와 매우 다른 날) 이 참고일에 포함되지 않도록 함. 산출된 평균 사용전력량의 75% 미만인 날은 참고일 산정에서 제외함, 산업용의 경우 앞 기준으로 참고일 재산정 시 평균 대비 75% 미만 혹은 125% 초과인 날을 추가로 제외함.&lt;br /&gt;&lt;br /&gt;

유사일과 감축일의 기온오차 등에 따른 전기소비형태를 반영하기 위해, 감축시작시간 1시간 전에서 4시간 전까지의 3시간 동안의 평균 사용전력량에서 유사일의 동일 시간대 평균 사용전력량을 차감한 값을 고객기준부하 값에 합해 &apos;최종적인&apos; 고객기준부하를 산출함.&lt;/li&gt;

&lt;li&gt;의무감축용량은 예비력 550만kW 미만 예상 시 발령되는 의무감축요청에 따라 감축할 의무를 갖는 용량임 (이전의 신뢰성 DR에 대응). 용량 및 고객 유형에 따라 표준형 (10MW 초과 500MW 이하), 중소형 (2MW 초과 50MW 이하), 국민DR (제한 없음) 으로 나뉨. &lt;/li&gt;

&lt;li&gt;감축가능용량은 자발적 입찰을 통해 하루전발전계획에 포함할 수 있는 용량임 (이전의 경제성 DR에 대응). 경제성DR에서는 전력시장에서 발전사업자 발전량들과 경쟁에서 낙찰 시 감축을 수행함.&lt;br /&gt;&lt;br /&gt;

그 외에 피크수요 DR (동계/ 하계 전력수급대책 목표수요 초과 예상 시 전일 입찰 개설), 미세먼지 DR (고농도 미세먼지 비상조치 발령 시 전일 입찰 개설) 등의 자발적 프로그램이 있음.&lt;br /&gt;&lt;br /&gt;

자발적 수요감축 입찰은 평일 거래일에 대해 입찰함.&lt;/li&gt;

&lt;li&gt;최근에는 Fast DR (계통 주파수 59.85Hz 이하로 하락 시 자동 반응 가능한 고객 설비로 구성), Plus DR (전력공급이 과도할 경우 전력 소비를 증가시킬 수 있는 고객 설비로 구성) 도 추가됨.&lt;br /&gt;&lt;br /&gt;

Plus DR은 현재 제주에서는 정식으로 시행 중이며, 육지에서는 시범사업 중임.&lt;/li&gt;

&lt;li&gt;자발적 감축에 따라 계획에 포함된 감축량은 SMP로 정산함.&lt;/li&gt;

&lt;li&gt;의무감축요청에 따른 의무감축이행량에 대해서는 해당 시간에 최소출력의 110% 이상으로 운전한 급전가능발전기들의 최고 변동비를 출력으로 나눈 값을 단가로 하여 정산함.&lt;br /&gt;&lt;br /&gt;

또한 표준 및 중소형DR에 대해서는 감축량과 별개로 용량에 대해서도 기본정산금을 지급함 (국민DR에 대해서는 기본정산금을 지급하지 않음).&lt;/li&gt;

&lt;li&gt;참여 전에 등록시험 및 전기소비형태 검증을 해야 함.&lt;br /&gt;&lt;br /&gt;

등록시험의 경우 감축지속시간은 3시간~4시간 (중소형DR/ 제주DR은 1시간), 시간대는 평일 9시~20시 사이 (12~13시 제외) 제주DR은 평일 10시~21시 사이) 임.&lt;br /&gt;&lt;br /&gt;

전기소비형태 검증 기준은, 검증대상일 (등록일로부터 20일 전부터 평일 45일, 감축일은 제외) 의 9시~20시 동안 계산된 RRMSE (Relative Root Mean Squared Error, 검증기간의 시간별 고객기준부하 (CBL) 와 실제 사용전력량 (Load)의 평균 오차와 검증기간의 평균 사용전력량의 비율) 가 30% 이하일 것임. RRMSE의 식은 하기와 같음.&lt;br /&gt;&lt;br /&gt;

\begin{align} 
\sqrt{\frac{\sum_{d \in D,t \in T} (CBL_{d,t} - Load_{d,t})^2}{D(n) \times T(n)}} \div \frac{\sum_{d \in D,t \in T} Load_{d,t}}{D(n) \times T(n)}
\notag
\end{align} &lt;/li&gt;

&lt;li&gt;평균감축이행률은 해당 거래일 거래시간별 전력부하감축량의 합을 감축계획량의 합으로 나눈 값임.&lt;br /&gt;&lt;br /&gt;

평균감축이행률이 97% 이상이어야 온전히 정산받을 수 있음. 80% 이상 97% 미만이면 등록신청용량에 평균감축이행률을 곱한 값으로 용량이 하향조정되며, 평균 80% 미만이거나 시간대별 감축이행률의 최소값이 70% 미만이면 참여가 제한됨.&lt;/li&gt;

&lt;li&gt;연중 2회 (12월 및 6월 1~2주) 감축시험을 시행함. 시험에서 평균감축이행률이 97% 미만이거나 시간대별 감축이행률의 최소값이 70% 미만인 자원은 12월 및 6월 3~4주에 재시험을 시행함.&lt;/li&gt;

&lt;li&gt;감축일의 특정 감축시간대에 특정 고객의 사용전력량 데이터 누락 발생 시, 해당 고객의 해당 거래시간 감축량은 0으로 적용함.&lt;/li&gt;

&lt;/ul&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;
&lt;h2 id=&quot;재생에너지-발전량-예측제도&quot;&gt;재생에너지 발전량 예측제도&lt;/h2&gt;

&lt;p&gt;내용 출처: &lt;a href=&quot;https://new.kpx.or.kr/board.es?mid=a10205010000&amp;amp;bid=0030&quot;&gt;전력거래소 전력시장운영규칙&lt;/a&gt;&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;태양광/ 풍력 개별발전기 또는 집합전력자원의 총 용량이 20MW를 초과해야 함.&lt;/li&gt;

&lt;li&gt;시간대별 설비이용률 (전력거래량을 용량으로 나누어 얻은 비율) 이 10% 이상 되는 시간 각각에 대해, 예측오차율 (예측발전량과 실제전력거래량 간 차이의 절대값을 설비용량으로 나누어 얻은 비율) 을 계산함. (실제전력거래량으로 나누는 것이 아님에 주의)&lt;br /&gt;&lt;br /&gt;

단, 설비이용률 산정 시 고장/ 정비로 정지해 있거나 급전지시로 출력제어 된 설비의 용량 및 발전량은 위 계산에서 제외함.&lt;/li&gt;

&lt;li&gt;예측발전량을 총 2회 (거래전일 10시, 17시) 에 걸쳐 제출하므로 각 예측발전량에 대해 예측오차율을 구한 후 산술평균을 냄. 이 산술평균이 6% 이하인 시간대에 대해서는 kWh당 4원, 6% 초과 8% 이하인 시간대에 대해서는 kWh당 3원의 인센티브를 정산함.&lt;/li&gt;

&lt;li&gt;대상자원 등록자격은 3개월 주기로 갱신하며, 직전 3개월 간의 시간대별 예측오차율들을 산술평균한 값이 10% 이하여야 자격이 연장됨.&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;
&lt;h2 id=&quot;실시간-시장에서의-재생에너지-입찰제도-제주-시범사업-기준&quot;&gt;실시간 시장에서의 재생에너지 입찰제도 (제주 시범사업 기준)&lt;/h2&gt;

&lt;p&gt;내용 출처: &lt;a href=&quot;https://www.kpx.or.kr/board.es?mid=a11203000000&amp;amp;bid=0209&amp;amp;act=view&amp;amp;list_no=70470&quot;&gt;전력시장 제도개선 제주 시범사업 운영규칙(안)&lt;/a&gt;&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;제주도에서 하루전 시장 (1시간 단위) 과 더불어 당일 실시간 시장 (15분 단위) 을 신설함.&lt;br /&gt;&lt;br /&gt;

하루전 시장에서의 낙찰량은 하루전 가격으로 정산, 하루전 낙찰량과 당일 실제 발전량 간 &apos;차이&apos;는 실시간가격으로 정산함.&lt;/li&gt;

&lt;li&gt;급전가능 재생에너지도 전력시장에 입찰해 가격결정에 관여함 (음의 가격으로 입찰하되, 하한은 2개월 전 현물 REC 평균가의 -2.5배임).&lt;/li&gt;

&lt;li&gt;급전가능 재생에너지는 보조 ESS 및 전력거래소에 실시간 정보를 제공하고 출력상한/ 출력제어 지시를 받는 인프라를 포함하고, 15분 평균 발전량을 출력상한 내로 조정 가능해야 함.&lt;br /&gt;&lt;br /&gt;

용량은 개별 1MW 초과 20MW 이하 또는 VPP 용량 1MW 초과 100MW 이하여야 함. 특히 3MW 초과 시 의무적으로 참여해야 함.&lt;/li&gt;

&lt;li&gt;재생발전기의 가장 큰 이슈인 출력제한 (curtailment) 에 대한 보상안이 마련됨.&lt;br /&gt;&lt;br /&gt;

재생발전기가 계통 지시로 출력제한 시, 그 출력제한 양에 실시간가격과 발전단가의 차이를 곱하여 계산되는 기대이익을 보상함. (만약 예비력 계획에 포함되었고 예비력실적에도 변동이 있었다면 이도 보상)&lt;/li&gt;

&lt;li&gt;실시간발전량이 허용오차를 벗어나는 수준으로 제약입찰량에 미달할 경우, 미달 발전량에 대해 실시간가격의 20%의 패널티를 부과함.&lt;br /&gt;&lt;br /&gt;

허용오차는 변경입찰후 공급가능용량에 0.005를 곱한 값 (주파수추종/ 자동발전제어운전신고 후 운전한 발전기는 0.01을 곱한 값) 을 원칙으로 하되 하한은 0.5MWh, 상한은 5MWh임.&lt;/li&gt;

&lt;li&gt;재생에너지 입찰제도 도입 시 재생에너지 발전량 예측제도에 의한 인센티브 지급은 원칙적으로 종료되어야 함. 그러나 전환기 조치로 첫 1년간 현행 인센티브의 50%를 지급함. 또한 예측제도 참여자원 감소분을 고려해 예측제도의 용량 기준을 20MW에서 1MW로 완화함 (급전가능재생에너지 참여규모 기준과 일치).&lt;/li&gt;
&lt;/ul&gt;

</description>
        <pubDate>Sun, 22 Oct 2023 00:00:00 +0900</pubDate>
        <link>https://song4energyndata.github.io/koreanmarketrules.html</link>
        <guid isPermaLink="true">https://song4energyndata.github.io/koreanmarketrules.html</guid>
        
        <category>전력시장</category>
        
        
        <category>market</category>
        
      </item>
    
      <item>
        <title>논문 소개: 전기차 충전 이력 데이터 기반의, 계통 내 시간별 전기차 충전 부하 시뮬레이션</title>
        <description>&lt;p&gt;전기차 및 충전 인프라 규모가 증가할수록 전력계통에 걸리는 부하가 증가한다. 그러므로 향후 발전/ 송전/ 배전 (특히 배전단) 설비 및 스케줄링 계획 수립을 위해, 전기차 충전으로 인한 시간별 부하 증가를 정확히 예측할 필요가 있다.&lt;/p&gt;

&lt;p&gt;이를테면 &lt;a href=&quot;https://www.mckinsey.com/industries/automotive-and-assembly/our-insights/the-potential-impact-of-electric-vehicles-on-global-energy-systems&quot;&gt;McKinsey에서는 150세대의 주거지역 배전단에서 가정 내 전기차 비중이 25%가 되면 아래 그림과 같이 모든 시간의 전기부하가 증가하며, 특히 최대부하는 약 30% 증가할 것으로 예상했다.&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/evestimates/impact_mckinsey.png&quot; alt=&quot;impact_ev&quot; class=&quot;align-center&quot; width=&quot;80%&quot; /&gt;
&lt;em&gt;전기차 증가로 인한 시간별 부하 증가 예상. (출처: 위 링크의 McKinsey 웹페이지)&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;또한 최근에는 수 kW급의 저속충전 뿐 아니라 100kW 이상의 고속충전 인프라가 확산되고 있으므로, 전기차 충전이 짧은 시간 내에 특정 배전 계통에 큰 부담을 줄 가능성도 고려해야 한다.&lt;/p&gt;

&lt;p&gt;(그나마 한국에서는 &lt;a href=&quot;https://www.electimes.com/news/articleView.html?idxno=327073&quot;&gt;최근 전기차 충전소에서 자체 재생에너지와 ESS를 전력시장을 거치지 않고 충전에 사용할 수 있도록 제도가 개선되었는데&lt;/a&gt;, 이를 통해 고속충전 인프라가 야기하는 배전계통의 부담을 완화시키는 방안이 도출될 수 있을지 기대된다.)&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;
&lt;h2 id=&quot;운전자-별-충전-행태의-다양성-및-임의성&quot;&gt;운전자 별 충전 행태의 다양성 및 임의성&lt;/h2&gt;

&lt;p&gt;전기차 부하 예측에서 어려운 점은, 전기차 운전자들의 충전 행태가 운전자별로 굉장히 다양하며 (heterogeneous) 확률적이라는 (probabilistic) 것이다.&lt;/p&gt;

&lt;p&gt;어떤 사람은 주로 집에서 야간 완속충전을 하는 반면, 어떤 사람은 주로 공용충전소에서 주간에 급속충전을 한다. 또 어떤 사람은 직장에 충전설비가 있어 직장에서 주간에 완속충전을 한다. 즉 충전 행태가 다양하다. 한편, 이는 행태가 비슷한 운전자들의 ‘grouping’의 필요성도 암시한다.&lt;/p&gt;

&lt;p&gt;또한 같은 운전자라도 충전 행태가 매일 완벽히 똑같진 않을 것이다. 오늘의 정확한 충전 시간대가 어제와는 몇 분 이상 다를 수 있고, 오늘의 충전량 또한 어제의 충전량과 조금은 다를 수 있다. 심지어는 같은 운전자가 오늘 충전 시 어제와는 다른 장소에서 충전할 수도 있다. 즉 운전자가 ‘오늘 언제 어디서 얼마나 충전할지’는 고정된 상수가 아닌 확률변수로 보아야 한다.&lt;/p&gt;

&lt;p&gt;위와 같이 다양하고 확률적인 운전자 별 충전 행태를 고려한 충전 부하 예측을 위해서는, 운전자들의 실제 충전 이력 데이터에 기반한 통계학습 모델을 구성하는 것이 좋다.&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;
&lt;h2 id=&quot;논문에서-제안하는-모델의-concept&quot;&gt;논문에서 제안하는 모델의 concept&lt;/h2&gt;

&lt;p&gt;이 포스팅에서는, 운전자들의 충전 이력 데이터셋을 이용해, 전기차가 많이 보급될 경우 특정 지역 내에서 하루 24시간 동안의 전기 부하가 어떻게 증가할지를 예측하는 모델을 제안한 논문을 소개한다. &lt;a href=&quot;https://doi.org/10.1016/j.apenergy.2021.118382 &quot;&gt;Applied Energy에서 출판된 ‘Scalable probabilistic estimates of electric vehicle charging given observed driver behavior’&lt;/a&gt; 이다.&lt;/p&gt;

&lt;p&gt;해당 논문에서 제시한 모델의 목적은, 각 전기차 운전자 별로 아래 요소들로 표현되는 충전 행태를 시뮬레이션하고, 그 결과를 합하여 ‘운전자들의 전기차 충전부하의 총 합’ 을 시간별로 예측하는 것이다.&lt;/p&gt;

&lt;p&gt;1) 어디에서 어떤 인프라로 충전하는가?&lt;br /&gt;
2) 몇 시 몇 분에 충전을 시작하는가?&lt;br /&gt;
3) 충전 시간은 얼마나 걸리는가?&lt;br /&gt;
4) 충전 에너지의 양은 얼마나 되는가?&lt;/p&gt;

&lt;p&gt;위 요소 중 1)에 해당하는 장소 및 인프라 종류는 segment라고도 하며, 이 연구에서는 아래 5가지를 고려하였다.&lt;/p&gt;

&lt;p&gt;a) 단독주택에서의 저속 (6.6kW) 충전&lt;br /&gt;
b) 공동주택에서의 저속 충전&lt;br /&gt;
c) 직장에서의 저속 충전&lt;br /&gt;
d) 공용충전소에서의 저속 충전&lt;br /&gt;
e) 공용충전소에서의 고속 (50~150kW) 충전&lt;/p&gt;

&lt;p&gt;제안된 모델은 앞서 언급한 이슈들인 다양성과 임의성을 고려하여 시뮬레이션이 가능하다는 장점이 있다. 아래 그림처럼 전기차 운전자들을 충전 행태의 유사도에 따라 grouping하여 충전 행태의 다양성을 반영할 수 있고, 특정 그룹에 속하는 운전자가 어떤 유형의 충전인프라를 언제 얼만큼 사용할지에 대한 확률분포를 모델링해 시뮬레이션한다.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/evestimates/profiles_cluster.png&quot; alt=&quot;clusters_ev&quot; class=&quot;align-center&quot; /&gt;
&lt;em&gt;각 운전자 group 별 시간별 충전 부하 형태 (normalized profiles). 각 색깔은 각 segment를 의미함.&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;이를테면 위 그림에서 cluster 1~3 (붉은 테두리) 은 ‘충전의 대부분을 직장에서 주간에 하는 운전자들의 group을, cluster 4~6 (주황 테두리) 는 ‘충전의 대부분을 주택에서 야간에 하는 운전자들의 group’ 을 의미한다.&lt;/p&gt;

&lt;p&gt;이 논문에서 제안된 모델을 통해, 일정 규모 이상의 발전/ 송전/ 배전 계획에서 전기차 확산의 영향을 보다 정확히 예측할 수 있을 것으로 기대된다.&lt;/p&gt;

&lt;p&gt;실제로 &lt;a href=&quot;https://doi.org/10.1038/s41560-022-01105-7&quot;&gt;해당 연구의 후속 연구 (Charging infrastructure access and operation to reduce the grid impacts of deep electric vehicle adoption) 는 Nature Energy에 게재되기도 했다.&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;
&lt;h2 id=&quot;비슷한-운전자들을-grouping-clustering-analysis-기반&quot;&gt;비슷한 운전자들을 grouping (Clustering analysis 기반)&lt;/h2&gt;

&lt;p&gt;충전 행태가 ‘비슷한’ 운전자들 별 group들을 구성하기 위해 clustering analysis가 사용되었다. 운전자 별 유사도 판단에 사용할 운전자 별 정량적 속성 (quantitative feature) 들은 아래와 같다.&lt;/p&gt;

&lt;p&gt;1) (일정 기간 내에) 각 segment에서 충전한 횟수&lt;br /&gt;
2) 각 segment에서의 평균적인 도착 시간&lt;br /&gt;
3) 각 segment에서의 평균적인 충전량&lt;br /&gt;
4) 각 segment에서의 평균적인 충전 시간&lt;br /&gt;
5) 각 segment에서 평일 대비 휴일 충전의 비율 (횟수 기준)&lt;br /&gt;
6) 전기차 배터리 용량&lt;br /&gt;
7) 충전하는 장소 수 (주소 기준)&lt;/p&gt;

&lt;p&gt;(위 7개 feature들 중 1) ~ 5) 는 모든 segment 각각에 대해 별도로 계산됨에 주의.)&lt;/p&gt;

&lt;p&gt;각 feature별로 단위 및 scale이 다르므로 normalization을 한 후, normalized feature vector space에서의 Euclidean distance에 기반해 clustering을 수행한다.&lt;/p&gt;

&lt;p&gt;이 논문에서는 가장 흔히 사용되는 $k$-Means가 아닌, 계층적 (hierarchical) 구조를 고려하는 agglomerative clustering을 사용하였다. 이는 bottom-up 방식의 방법으로, 각 data point를 하나의 cluster로 두고 시작해 매 step마다 ‘가장 비슷한’ 두 cluster들을 하나의 cluster로 묶는 작업을 반복하는 알고리즘이다.&lt;/p&gt;

&lt;p&gt;Agglomerative clustering을 하면 각 cluster의 의미를 파악하기 쉽다는 장점이 있다. 이 연구에서는 각 cluster의 의미가 중요하기 때문에 채택하였다.&lt;/p&gt;

&lt;p&gt;이 연구에서는 cluster 갯수를 16개로 결정하였다 (elbow curve에 근거함). 16개 cluster들을 위에서 언급한 ‘의미’에 따라 보면, 각 운전자가 아래 5개의 ‘super’cluster들 중 하나에 속하는 것으로 해석할 수 있다.&lt;/p&gt;

&lt;p&gt;1) 거의 대부분 직장에서 충전 (아래의 A-Red)&lt;br /&gt;
2) 거의 대부분 집에서 충전 (아래의 B-Orange)&lt;br /&gt;
3) 거의 대부분 공용충전소에서 충전 (아래의 C-Yellow)&lt;br /&gt;
4) 직장 및 공용충전소에서 충전, 배터리 크기 큼 (아래의 D-Green)&lt;br /&gt;
5) 직장 및 공용충전소에서 충전, 배터리 크기 작음 (아래의 E-Blue)&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/evestimates/dendrogram.png&quot; alt=&quot;dendrogram&quot; class=&quot;align-center&quot; /&gt;
&lt;em&gt;Clustering 결과의 의미를 해석하기 위한 dendrogram 및 5개의 supercluster들.&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;어떤 운전자가 16개의 cluster 중 특정 cluster $G$에 속할 확률을 $P(G)$라 표현한다. $P(G)$는 통상적으로 훈련 데이터에서의 각 cluster 별 크기에 기반해 결정하지만, 현실에 맞게 조정할 수 있다.&lt;/p&gt;

&lt;p&gt;이를테면, 이 논문의 case study에서는 집에서의 야간 완속충전 비중이 증가하는 추세를 반영하여, 집에서의 야간 완속충전을 위주로 하는 운전자들에 대응하는 supercluster (위에서의 B-Orange) 의 $P(G)$를 증가시켰다.&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;
&lt;h2 id=&quot;각-운전자의-충전-장소-인프라-확률-모델링&quot;&gt;각 운전자의 충전 장소/ 인프라 확률 모델링&lt;/h2&gt;

&lt;p&gt;서두에서 언급했듯, 전기차 충전 장소와 인프라 유형 (segment라 칭함) 으로 아래 5가지를 고려하였다.&lt;/p&gt;

&lt;p&gt;a) 단독주택에서의 저속 (6.6kW) 충전&lt;br /&gt;
b) 공동주택에서의 저속 충전&lt;br /&gt;
c) 직장에서의 저속 충전&lt;br /&gt;
d) 공용충전소에서의 저속 충전&lt;br /&gt;
e) 공용충전소에서의 고속 (50~150kW) 충전&lt;/p&gt;

&lt;p&gt;각 cluster 별 운전자는 꼭 하나의 segment에서만 충전하는 것은 아니다. 빈도의 차이는 있지만, 그때그때 다른 segment에서 충전할 수 있다. 이를테면 대부분의 충전을 주택에서 하는 운전자도, 불가피하게 장거리 운전을 하다 도중에 공용충전소에서 충전할 일도 있을 것이다.&lt;/p&gt;

&lt;p&gt;그러므로 각 cluster 별로, cluster $G$에 속하는 운전자가 하루 동안 segment $z$에서 충전할 확률 $P(z \vert G)$를 추정한다.&lt;/p&gt;

&lt;p&gt;평일에 대해서는, 그 group 내 모든 운전자들이 데이터 수집 기간 동안의 총 평일 수 대비 해당 segment $z$에서 충전한 평균횟수의 비율로 추정하였다. 휴일에 대해서는 같은 논리로 별도의 확률을 추정한다.&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;
&lt;h2 id=&quot;각-운전자의-충전-시작시간-에너지량-소요시간-확률-모델링&quot;&gt;각 운전자의 충전 시작시간/ 에너지량/ 소요시간 확률 모델링&lt;/h2&gt;

&lt;p&gt;Cluster $G$에 속하는 운전자가 segment $z$에서 충전할 때, 충전소에서 충전을 시작하는 시간/ 충전 에너지량/ 충전에 걸리는 시간 총 세 가지 변수의 묶음을 3변량 확률변수 벡터 $s$로 보고, 해당 벡터의 다변량확률분포 $P(s \vert z,G)$를 모델링한다.&lt;/p&gt;

&lt;p&gt;이 연구에서는 Gaussian Mixture Model (GMM) 을 사용하였다. 즉 확률분포를 단일한 정규분포가 아니라 여러 개의 정규분포들의 합 (즉 multimodal distribution) 으로 가정하였다.&lt;/p&gt;

&lt;p&gt;이는 같은 group과 같은 segment라 하더라도 사람들에 따라 디테일한 충전 행태가 다를 것이고 (누구는 이른 시간에 와서 조금만 충전하고, 누구는 늦은 시간에 와서 많이 충전하고 등), 특별히 빈도가 높은 행태가 한 가지가 아니라 두 가지 이상일 수 있기 때문이다.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/evestimates/gmm_concept.png&quot; alt=&quot;gmm_concept&quot; class=&quot;align-center&quot; width=&quot;70%&quot; /&gt;
&lt;em&gt;Gaussian Mixture Model의 concept. 빈도가 높은 값이 여러 개 있음.&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;GMM에서는 component (각각의 단일한 3변량 정규분포) 의 갯수를 사전에 정해 주면, 각 component 별 평균 벡터와 공분산 행렬 및 각 component의 가중치를 (데이터에 가장 잘 적합되게) 계산한다.&lt;/p&gt;

&lt;p&gt;각 $(z,G)$ 별 GMM 모델의 component 갯수를 정하려면 지표가 필요한데, 이 논문에서는 Akaike Information Criterion (AIC) 를 지표로 두어 데이터에 잘 적합되면서도 복잡하지 않은 모델을 도출하도록 하였다.&lt;/p&gt;

&lt;p&gt;이를테면, 아래 그림에서 상단의 큰 subplot은 특정 cluster에 속하며 직장에서 주간 완속충전을 하는 사람 1만명을 가정하고 시뮬레이션해 얻은 시간별 총 충전 부하이고, 하단의 4개 subplot들은 해당 $(z,G)$에 대한 GMM 모델의 component들 중 가중치가 높은 순으로 4개 component들 각각에 의해 도출된 시간별 충전 부하다.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/evestimates/gmm.png&quot; alt=&quot;Gaussian_mixture&quot; class=&quot;align-center&quot; /&gt;
&lt;em&gt;특정 cluster - segment 조합에 대한 운전자 1만명을 시뮬레이션했을 때의 충전 패턴 (상단) 및 GMM의 major component들에 의해 계산된 패턴들 (하단).&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;여기까지 계산하면, 각 운전자의 cluster/ segment/ 디테일한 충전행태 (충전 시작시간/ 에너지량/ 소요시간) 의 ‘결합’ 확률분포 $P(s,z,G)$ 를, 앞에서 구한 확률분포들의 곱인 $P(s \vert z,G) P(z \vert G) P(G)$ 로 계산할 수 있다.&lt;/p&gt;

&lt;p&gt;위 확률분포 곱을 얻으면, $G$를 생성하고, 주어진 $G$를 조건부로 하는 $z$를 생성하고, 주어진 $(z,G)$를 조건부로 하는 $s$를 생성하여, 각 운전자의 충전 부하를 시뮬레이션으로 생성할 수 있다.&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;
&lt;h2 id=&quot;논문의-case-study-시나리오-소개&quot;&gt;논문의 case study: 시나리오 소개&lt;/h2&gt;

&lt;p&gt;논문에 사용된 데이터셋은 California의 특정 충전소 사업체로부터 받은, 약 38,000명의 운전자가 약 399만 회 충전한 이력 데이터이다.&lt;/p&gt;

&lt;p&gt;논문에서는 2030년에 전기차 수가 8백만대로 증가한다고 가정하고, 하기의 4개 시나리오 각각에 대해 총 전기차 충전 부하를 시뮬레이션하였다.&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;
&lt;b&gt;시나리오 1: 주택에서의 충전이 계시별 요금제 및 타이머 기반으로 이루어질 경우&lt;/b&gt;&lt;/p&gt;

&lt;p&gt;모델링에 사용된 충전 이력 데이터에 따르면 대부분의 충전이 직장에서 이루어졌다. 그러나 이는 해당 충전소 사업체의 특성에 영향받은 결과이다. 실제로 California에서는 주택에서의 충전이 증가하는 추세이며, 2030년에는 운전자의 3분의 2가 주택에서 충전할 것으로 예상된다.&lt;/p&gt;

&lt;p&gt;그러므로 16개 cluster들 중 거의 대부분 주택에서 충전하는 운전자들에 대응하는 3개 cluster (위 dendogram에서의 B-Orange) 에 대한 $P(G)$의 합이 67%가 되게 확률을 조정하였다.&lt;/p&gt;

&lt;p&gt;또한 주택 충전의 3분의 2가 타이머 기반 자동 충전 (오후 11시 또는 자정에 시작) 을 할 것으로 예상된다. 그러므로 시나리오 1에서는, 각 cluster의 운전자가 segment들 중 주택에서 충전할 경우의 GMM 모델에 대해 타이머 기반 자동 충전에 대응되는 component들의 weight를 증가시켰다.&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;
&lt;b&gt;시나리오 2: 주택에서의 충전이 임의적으로 이루어지는 경우&lt;/b&gt;&lt;/p&gt;

&lt;p&gt;시나리오 1에서는 주택의 계시별 요금제 및 타이머 기반 자동 충전을 가정했다. 그러나 실제로는 주택 사용자들이 계시별 요금제를 채택하지도 않고 그 결과 타이머 기반 충전을 하지 않을 수도 있다. 일종의 ‘uncontrolled charging’ (임의적 충전) 으로 볼 수 있다.&lt;/p&gt;

&lt;p&gt;시나리오 2에서는 uncontrolled charging을 시뮬레이션한다. 이를 위해 시나리오 1과는 반대로, 타이머 기반 자동 충전에 대응되는 component들의 weight를 감소시켰다.&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;
&lt;b&gt;시나리오 3: 직장에서의 충전 시간대를 분산시키는 경우&lt;/b&gt;&lt;/p&gt;

&lt;p&gt;거의 대부분을 직장에서 충전하는 운전자들에 대응하는 cluster들에 대한 시간별 충전 profile을 보면 (위 16개 cluster 각각의 충전 profile 그림의 1~3번째), 대략 10시 경에 뾰족한 피크부하가 형성된다. 이는 직장에서 충전하는 운전자들 대다수가 직장에 도착하자마자 (즉 비슷한 시간에) 충전을 시작하기 때문으로 추정된다.&lt;/p&gt;

&lt;p&gt;이러한 피크부하는 계통에 부담을 주므로, 부하 평준화가 필요하다. 시나리오 3에서는, 어떤 인센티브 정책에 의해 직장에서 충전하는 운전자들의 상당수가 정오 이후에 충전을 시작하는 경우를 시뮬레이션한다.&lt;/p&gt;

&lt;p&gt;이를 위해, 직장에서도 충전하는 운전자들이 직장에서 충전할 경우의 GMM 모델에 대해 정오 이후의 충전에 대응되는 component들의 weight를 증가시켰다.&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;
&lt;b&gt;시나리오 4: 재택근무자 증가로 주택에서의 아침~오후 충전 비중이 증가할 경우&lt;/b&gt;&lt;/p&gt;

&lt;p&gt;시나리오 1과 2에서는 주택에서의 충전이 거의 대부분 야간에 이루어진다고 가정했다. 그러나 최근 재택근무 (working from home) 이 증가하고 있다. 이 경우, 주택에서의 충전 중 아침~오후 시간대에 이루어지는 충전의 비중이 증가할 수 있다.&lt;/p&gt;

&lt;p&gt;시나리오 4에서는, 주택에서 충전하는 운전자들의 cluster (dendogram에서의 B-Orange) 및 주택 segment 내 충전에 대한 GMM 모델에서 아침~오후 시간대 충전에 대응되는 component들의 weight를 증가시켰다.&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;
&lt;h2 id=&quot;논문의-case-study-결과-주택-내-충전에-의한-야간-피크부하-발생&quot;&gt;논문의 case study: 결과 (주택 내 충전에 의한 야간 피크부하 발생)&lt;/h2&gt;

&lt;p&gt;4개의 시나리오 각각에 대해, 전기차 8백만대가 하루 동안 발생시킬 것으로 예측되는 총 충전 부하를 시뮬레이션한 결과는 아래 그림과 같다.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/evestimates/scenarios.png&quot; alt=&quot;scenarios&quot; class=&quot;align-center&quot; /&gt;
&lt;em&gt;4개 시나리오에 대해 전기차 8백만대의 총 충전 부하를 시뮬레이션한 결과.&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;주목할 부분은 시나리오 1 (위 그림의 (a)) 에서 야간에 발생하는 피크부하 (약 7GW) 및 오후 11시를 기점으로 하는 부하 급증이다. 이는 대부분의 운전자가 계시별 요금제에 대응하여 특정 시간에 충전을 시작하도록 타이머를 쓰고, 그 결과 대부분의 주택 운전자들의 충전 시작 시간대가 거의 같아지기 때문이다.&lt;/p&gt;

&lt;p&gt;현재 California 전력계통의 주간 피크가 약 25GW임을 감안하면, 계시별 요금제 적용 시 주택 내에서 타이머에 기반해 이루어지는 전기차 자동 충전에 의해 매우 큰 야간 피크부하가 발생하고, 심지어 해당 피크부하 발생 직전의 ramp rate 또한 매우 커서, 계통 안정성이 위협받을 것으로 추정된다.&lt;/p&gt;

&lt;p&gt;따라서 향후 주택 내 전기차 충전 요금제는, 운전자들의 충전 시작 시간을 분산시킬 수 있도록 설계할 필요가 있다는 결론을 얻는다.&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;
&lt;h2 id=&quot;저자의-data-driven-modeling-강의&quot;&gt;저자의 data-driven modeling 강의&lt;/h2&gt;

&lt;p&gt;해당 연구를 주도한 연구자이자 논문 교신저자인 &lt;a href=&quot;https://cee.stanford.edu/people/ram-rajagopal&quot;&gt;Ram Rajagopal (Stanford Univ.)&lt;/a&gt; 가, 해당 연구 내용을 포함하는 세미나 ‘Data-Driven Modeling of Distributed Energy Resources and Applications’ 를 &lt;a href=&quot;https://energy-markets-school.dk/school-2023/&quot;&gt;DTU Summer School 2023&lt;/a&gt;에서 진행하였다 (아래 영상 참고).&lt;/p&gt;

&lt;!-- Courtesy of embedresponsively.com --&gt;

&lt;div class=&quot;responsive-video-container&quot;&gt;
    &lt;iframe src=&quot;https://www.youtube-nocookie.com/embed/J83ac7ZKwVo&quot; frameborder=&quot;0&quot; webkitallowfullscreen=&quot;&quot; mozallowfullscreen=&quot;&quot; allowfullscreen=&quot;&quot;&gt;&lt;/iframe&gt;
  &lt;/div&gt;

</description>
        <pubDate>Sat, 21 Oct 2023 00:00:00 +0900</pubDate>
        <link>https://song4energyndata.github.io/evestimate.html</link>
        <guid isPermaLink="true">https://song4energyndata.github.io/evestimate.html</guid>
        
        <category>전기차</category>
        
        <category>부하패턴</category>
        
        <category>Clustering</category>
        
        <category>GMM</category>
        
        
        <category>dataset</category>
        
      </item>
    
      <item>
        <title>재생발전 비중이 높은 전력시장에 대한 심화 주제들</title>
        <description>&lt;p&gt;필자가 정리했던 &lt;a href=&quot;https://song4energyndata.github.io/jalalone.html&quot;&gt;Jalal Kazempour 교수의 전력시장 강의&lt;/a&gt;에서 reference로써 추천한 책으로, &lt;a href=&quot;https://link.springer.com/book/10.1007/978-1-4614-9411-9&quot;&gt;Integrating Renewables in Electricity Markets: Operational Problems&lt;/a&gt; 이 있다.&lt;/p&gt;

&lt;p&gt;강의 내용에 더해 해당 책을 공부하며, 하루전 시장과 실시간 시장으로 구성된 전력시장의 수리모델링에 대해 더 깊게 이해할 수 있었다.&lt;/p&gt;

&lt;p&gt;앞으로 우리나라에서도 &lt;a href=&quot;https://www.electimes.com/news/articleView.html?idxno=325061&quot;&gt;2024년부터 제주도에서 실시간 시장이 시범 실시되며 몇 년 내로 육지에서도 실시될 예정&lt;/a&gt;인 만큼, 에너지시스템 모델링 전문가를 지향한다면 해당 주제에 대해 미리 공부해놓는 것이 당연하다 하겠다.&lt;/p&gt;

&lt;p&gt;이번 포스팅에서는, 해당 책 내용 중 Jalal 교수의 강의에서 다루지 않았으나 현실 세계에서 자주 볼 법한, 그러면서도 지나치게 복잡하지는 않은 (즉 우선순위가 높아 보이는) 모델들을 정리하였다.&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;
&lt;h2 id=&quot;예비력을-포함한-market-clearing&quot;&gt;예비력을 포함한 market clearing&lt;/h2&gt;

&lt;p&gt;급전 계획에서 각 발전기의 출력은, 총 공급과 총 수요가 일치하도록 결정된다. 그런데 실제로는, 계획 대비 실시간에서의 총 수요가 더 클 수 있다. 이 때 수요 증가에 ‘신속하게’ 대응할 수 있도록, 예비력 (reserve capacity) 을 확보해야 한다.&lt;/p&gt;

&lt;p&gt;예비력을 제공하는 발전기에 대해, 급전과 별개로 예비력에 대해서도 비용을 지불하는 경우에 대한 최적 계획 문제를 보자.&lt;/p&gt;

&lt;p&gt;발전기 A는 용량 100 MW, offer price는 MWh당 10달러이고, 발전기 B는 용량 100 MW, offer price는 MWh당 20달러이다.&lt;/p&gt;

&lt;p&gt;한편 예상되는 총 수요는 130 MW 이지만, 예비력을 20 MW 확보해야 한다. 발전기 A는 예비력을 무상으로 제공하는 반면, 발전기 B의 예비력에 대한 offer price는 MW당 25달러이다.&lt;/p&gt;

&lt;p&gt;이 때 발전량과 예비력을 동시에 구하는 market clearing problem은 아래와 같다. (Unit commitment 제약들은 무시했다.)&lt;/p&gt;

&lt;p&gt;Min. $10 P_A + 30 P_B + 0 R_A + 25 R_B$&lt;/p&gt;

&lt;p&gt;Subject to&lt;/p&gt;

&lt;p&gt;$ P_A + P_B = 130$ : $\lambda_P$&lt;/p&gt;

&lt;p&gt;$ R_A + R_B = 20$ : $\lambda_R$&lt;/p&gt;

&lt;p&gt;$ P_A + R_A \leq 100$, $P_A \geq 0$, $R_A \geq 0$&lt;/p&gt;

&lt;p&gt;$ P_B + R_B \leq 100$, $P_B \geq 0$, $R_B \geq 0$&lt;/p&gt;

&lt;p&gt;예상 수요와 요구되는 예비력을 충족해야 하면서, 각 발전기 별로 실제 발전량과 예비력 제공량의 합이 용량을 초과할 수 없다는 제약 하에, 비용을 최소화하는 발전기 별 발전량과 예비력 제공량을 구한다.&lt;/p&gt;

&lt;p&gt;이 때 예상 수요 충족 제약의 dual variable $\lambda_P$는 energy price이고, 요구되는 예비력 충족 제약의 dual variable $\lambda_R$은 reserve capacity price이다.&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;
위 문제에서는 예비력 제공량이 미리 정해진 요구치 20 MW 를 반드시 충족해야 했다. 여기에는, 총 수요가 갑자기 20 MW 증가할 가능성이 어느 정도 있으며 해당 수요 증가분을 충족하지 못할 경우 심각한 손해를 입을 것이라는 가정이 암묵적으로 깔려 있다.&lt;/p&gt;

&lt;p&gt;만약 수요가 갑자기 20 MW 증가할 가능성이 매우 낮거나, 증가한 수요를 충족하지 못하더라도 그로 인해 입는 손실이 그다지 크지 않다면, 예비력을 20 MW 제공하는 것이 경제성 측면에서 최선이 아닐 수 있다.&lt;/p&gt;

&lt;p&gt;이를테면 수요가 갑자기 20 MW 증가할 확률이 5퍼센트이고, 갑자기 증가한 수요를 충족하지 못할 경우의 경제적 손실은 MWh당 1000달러라 하자. 이 때 예비력 제공량을 결정하는 문제는 아래와 같다.&lt;/p&gt;

&lt;p&gt;Min. $10 P_A + 30 P_B + 0 R_A + 25 R_B + 0.05 (10 r_A + 30 r_B + 1000 L^{shed})$&lt;/p&gt;

&lt;p&gt;Subject to&lt;/p&gt;

&lt;p&gt;$r_A \leq R_A$&lt;/p&gt;

&lt;p&gt;$r_B \leq R_B$&lt;/p&gt;

&lt;p&gt;$ P_A + P_B = 130$ : $\lambda_P$&lt;/p&gt;

&lt;p&gt;$ P_A + R_A \leq 100$&lt;/p&gt;

&lt;p&gt;$ P_B + R_B \leq 100$&lt;/p&gt;

&lt;p&gt;$ r_A + r_B + L^{shed} = 20 $&lt;/p&gt;

&lt;p&gt;$P_A, P_B, R_A, R_B, r_A, r_B, L^{shed} \geq 0$&lt;/p&gt;

&lt;p&gt;위에서 $r_A$와 $r_B$는 총 수요가 20 MW 증가할 경우에 각 발전기의 출력 증가량이고, $ L^{shed}$는 증가한 수요 중 충족하지 못한 양이다.&lt;/p&gt;

&lt;p&gt;이 문제를 풀어 얻는 $R_A + R_B$가 예비력 제공량이다. 수요 증가 확률 및 공급 부족에 의한 손실이 얼마나 큰가에 따라, 최적의 예비력 제공량은 20 MW 일 수도, 그보다 작을 수도, 아예 0일 수도 있다.&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;
&lt;h2 id=&quot;stochastic-market-clearing-시의-매출-계산&quot;&gt;Stochastic market clearing 시의 매출 계산&lt;/h2&gt;

&lt;p&gt;Stochastic market clearing 문제에서 하루전 시장 수요-공급 일치 조건의 (bus $n$에서의) dual variable을 $\lambda_n^{D}$라 하자. 그러면 하루전 시장에서의 가격은 $\lambda_n^{D}$이다.&lt;/p&gt;

&lt;p&gt;한편 실시간 시장에서 시나리오 $\omega$ 하에 수요-공급 일치 조건의 dual variable을 $\gamma_{n \omega}$라 하자. 그리고 시나리오 $\omega$의 확률을 $\pi_{\omega}$라 하자. 그러면 해당 시나리오 하에 실시간 시장에서의 가격은 $\pi_{\omega}$이다.&lt;/p&gt;

&lt;p&gt;하루전 시장과 실시간 시장에서의 총 매출은, 하루전 시장에서 계획된 에너지 판매량을 $E$, 실시간 시장에서 시나리오 $\omega$ 하에 balancing을 위해 ‘추가적으로’ 판매하거나 수요처인 경우 소비를 줄인 에너지를 $\Delta E_{\omega}$라 할 때 아래와 같이 계산된다.&lt;/p&gt;

&lt;p&gt;$\lambda_n^{D} E + (\gamma_{n \omega}/\pi_{\omega}) \Delta E_{\omega}$&lt;/p&gt;

&lt;p&gt;$\gamma_{n \omega}$를 $\pi_{\omega}$로 나눠주는 이유는, 하루전 시장과 실시간 시장을 모두 포함하는 최적화 문제에서는 각 시나리오 별 subproblem의 목적함수에 이미 $\pi_{\omega}$가 곱해져 있으므로, dual variable이 ‘$\pi_{\omega}$만큼 scaling된’ sensitivity이기 때문이다.&lt;/p&gt;

&lt;p&gt;($E$가 음수면 에너지를 소비한 것, $\Delta E$가 음수면 발전량을 줄이거나 에너지를 추가로 소비한 것이다.)&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;
&lt;h2 id=&quot;실시간-시장에서-각-참가자들의-수익&quot;&gt;실시간 시장에서 각 참가자들의 수익&lt;/h2&gt;

&lt;p&gt;하루전 시장에서의 market clearing price를 $\lambda^{S}$, 실시간 시장에서의 market clearing price를 $\lambda^{B}$라 하자.&lt;/p&gt;

&lt;p&gt;만약 실시간 시장에서의 total ‘net’ demand (총 부하에서 재생발전을 뺀 ‘순’부하) 가 ‘계획된’ 급전발전량을 초과하면 (즉 excess consumption이면), 도출된 market clearing price들에 대해 $\lambda^{B} \geq \lambda^{S}$ 가 성립한다.&lt;/p&gt;

&lt;p&gt;또한 하루전 시장에서와 실시간 시장에서의 순부하를 각각 $P_N^{S}$와 $P_N^{B}$라 할 때, 급전가능 발전기들은 전일시장에서 총합 $P_N^{S}$만큼의 전력을 공급하기로 계획되었을 것이므로, 실시간 시장에서 급전가능 발전기들이 추가로 얻는 총 매출은 $(P_N^{B}-P_N^{S}) \lambda^{B} &amp;gt; 0$ 이다.&lt;/p&gt;

&lt;p&gt;이 때 각각의 재생 (즉 급전불가능) 발전기 $j$가 실시간 시장에서 얻는 매출은 얼마일까?&lt;/p&gt;

&lt;p&gt;재생발전기 $j$가 하루전 시장에서 예상한 발전량을 $P_{Uj}^{S}$, 실시간 시장에서의 실제 발전량을 $P_{Uj}^{B}$라 하자. 그러면 실시간 시장에서의 매출은 $(P_{Uj}^{B} - P_{Uj}^{S}) \lambda^{B}$ 이다.&lt;/p&gt;

&lt;p&gt;만약 재생발전기 $j$가 ‘하루전 시장에서 예상된 발전량 대비’ 실제로 더 적게 발전했다면, 즉 $P_{Uj}^{B} &amp;lt; P_{Uj}^{S}$ 라면, 매출은 음수이다.&lt;/p&gt;

&lt;p&gt;이를 ‘급전발전기로부터 $(P_{Uj}^{B} - P_{Uj}^{S})$ 만큼의 전력을 구입해서 계획된 발전량을 맞추는 것’으로 해석한다면, $\lambda^{B} \geq \lambda^{S}$ 이므로 ‘실시간 시장에서 하루전 시장 대비 더 비싼 가격으로 전기를 구입하는’ penalty를 감수하는 셈이다. 이 penalty는 ‘재생발전기 $j$가 excess consumption을 악화시키는 역할을 했으므로’ 받는 것으로 해석할 수 있다.&lt;/p&gt;

&lt;p&gt;반대로 재생발전기 $j$가 ‘하루전 시장에서 예상된 발전량 대비’ 실제로 더 많이 발전했다면, 즉 $P_{Uj}^{B} &amp;gt; P_{Uj}^{S}$ 라면, 매출은 양수이다.&lt;/p&gt;

&lt;p&gt;이는 ‘실시간 시장에서 $(P_{Uj}^{B} - P_{Uj}^{S})$ 만큼의 전력을 하루전 시장 대비 더 비싼 가격으로 판매하는’ advantage를 얻는 셈이다. 이 advantage는 ‘재생발전기 $j$가 (비록 자기의지는 아니지만) excess consumption을 해소하는 역할을 했으므로’ 얻는 것으로 해석할 수 있다.&lt;/p&gt;

&lt;p&gt;한편 수요처 $k$에서도 하루전 시장에서 계획한 부하 $P_{Dk}^{S}$와 실시간 시장에서의 실제 부하 $P_{Dk}^{B}$가 서로 다를 수 있다. 그러면 실시간 시장에서 지불해야 하는 금액은 $(P_{Dk}^{B} - P_{Dk}^{S}) \lambda^{B}$ 이다.&lt;/p&gt;

&lt;p&gt;만약 수요처 $k$가 ‘하루전 시장에서 계획된 부하 대비’ 실제로 더 많은 에너지를 소비했다면, 즉 $P_{Dk}^{B} &amp;gt; P_{Dk}^{S}$ 라면, 지불해야 하는 금액은 양수이다.&lt;/p&gt;

&lt;p&gt;이는 부하 증가에 의한 추가적인 에너지를 ‘하루전 시장 대비 더 비싼 가격으로 구매하는’ penalty를 감수하는 셈이다. 이 penalty는 ‘부하 $k$가 excess consumption을 악화시키는 역할을 했으므로’ 받는 것으로 해석할 수 있다.&lt;/p&gt;

&lt;p&gt;반대로 수요처 $k$가 ‘하루전 시장에서 계획된 부하 대비’ 실제로 더 적은 에너지를 소비했다면, 즉 $P_{Dk}^{B} &amp;lt; P_{Dk}^{S}$ 라면, 지불해야 하는 금액은 음수이다.&lt;/p&gt;

&lt;p&gt;이는 부하 감소에 의한 잉여 에너지를 ‘하루전 시장 대비 더 비싼 가격으로 판매하는’ advantage를 얻는 셈이다. 이 advantage는 ‘부하 $k$가 excess consumption을 해소하는 역할을 했으므로’ 얻는 것으로 해석할 수 있다.&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;
지금까지의 논의와 반대로, 만약 실시간 시장에서의 total ‘net’ demand (총 부하에서 재생발전을 뺀 ‘순’부하) 가 ‘계획된’ 급전발전량보다 적으면 (즉 excess production이면), 도출된 market clearing price들에 대해 $\lambda^{B} \leq \lambda^{S}$ 가 성립한다.&lt;/p&gt;

&lt;p&gt;이 경우 급전가능 발전기들이 하루전 시장 대비 출력을 줄임으로써 시장에 되돌려줘야 하는 금액의 총 합은 $(P_N^{S}-P_N^{B}) \lambda^{B} &amp;gt; 0$ 이다.&lt;/p&gt;

&lt;p&gt;재생발전기 $j$가 ‘하루전 시장에서 예상된 발전량 대비’ 실제로 더 적게 발전했다면, 실시간 시장에서의 매출 $(P_{Uj}^{B} - P_{Uj}^{S}) \lambda^{B}$ 은 음수이다.&lt;/p&gt;

&lt;p&gt;이는 실시간 시장으로부터 $(P_{Uj}^{B} - P_{Uj}^{S})$ 만큼의 전력을 ‘더 저렴한 가격으로’ 구매하는 advantage를 얻는 셈이다. 이 advantage는 ‘재생발전기 $j$가 (비록 자기의지는 아니지만) excess production을 해소하는 역할을 했으므로’ 얻는 것으로 해석할 수 있다.&lt;/p&gt;

&lt;p&gt;반대로 재생발전기 $j$가 ‘하루전 시장에서 예상된 발전량 대비’ 실제로 더 많이 발전했다면, 실시간 시장에서의 매출 $(P_{Uj}^{B} - P_{Uj}^{S}) \lambda^{B}$ 은 양수이다.&lt;/p&gt;

&lt;p&gt;이는 실시간 시장에서 $(P_{Uj}^{B} - P_{Uj}^{S})$ 만큼의 잉여전력을 ‘더 낮은 가격에’ 판매하는 penalty를 감수하는 셈이다. 이 penalty는 ‘재생발전기 $j$가 excess production을 악화시키는 역할을 했으므로’ 받는 것으로 해석할 수 있다.&lt;/p&gt;

&lt;p&gt;한편 수요처 $k$가 실시간 시장에서 지불해야 하는 금액은 $(P_{Dk}^{B} - P_{Dk}^{S}) \lambda^{B}$ 이다.&lt;/p&gt;

&lt;p&gt;만약 수요처 $k$가 ‘하루전 시장에서 계획된 부하 대비’ 실제로 더 많은 에너지를 소비했다면, 즉 $P_{Dk}^{B} &amp;gt; P_{Dk}^{S}$ 라면, 지불해야 하는 금액은 양수이다.&lt;/p&gt;

&lt;p&gt;이는 부하 증가에 의한 추가적인 에너지를 ‘하루전 시장 대비 더 저렴한 가격으로 구매하는’ advantage를 얻는 셈이다. 이 penalty는 ‘부하 $k$가 excess production을 해소하는 역할을 했으므로’ 받는 것으로 해석할 수 있다.&lt;/p&gt;

&lt;p&gt;반대로 수요처 $k$가 ‘하루전 시장에서 계획된 부하 대비’ 실제로 더 적은 에너지를 소비했다면, 즉 $P_{Dk}^{B} &amp;lt; P_{Dk}^{S}$ 라면, 지불해야 하는 금액은 음수이다.&lt;/p&gt;

&lt;p&gt;이는 부하 감소에 의한 잉여 에너지를 ‘하루전 시장 대비 더 비싼 가격으로 판매하는’ penalty를 감수하는 셈이다. 이 advantage는 ‘부하 $k$가 excess production을 악화시키는 역할을 했으므로’ 얻는 것으로 해석할 수 있다.&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;
&lt;h2 id=&quot;재생발전의-merit-order-effect&quot;&gt;재생발전의 merit-order effect&lt;/h2&gt;

&lt;p&gt;태양광/ 풍력 등 재생발전원은 일단 설치되었다면 일반적으로 ‘1단위의 전기를 더 생산하기 위한 marginal cost’가 거의 zero이다.&lt;/p&gt;

&lt;p&gt;그러므로 급전 시 최우선순위를 부여받고, marginal cost가 상대적으로 작은 급전가능 발전기들로도 net demand를 충당할 수 있게 된다. Marginal cost가 높은 급전가능 발전기들의 순위는 밀리게 된다.&lt;/p&gt;

&lt;p&gt;그 결과, 재생발전 비중이 증가할수록 전력 도매가격이 하락하는데, 이를 merit-order effect라 한다.&lt;/p&gt;

&lt;p&gt;한편 재생발전 비중이 높으면 수요-공급 곡선에서 공급곡선 위치의 불확실성이 증가하므로, 이에 따라 수요곡선과 공급곡선이 만나는 점 및 시장가격의 불확실성도 증가한다.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/jalal/Lecture7_8.png&quot; alt=&quot;clearingexample&quot; /&gt;&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;
&lt;h2 id=&quot;flexible-demand의-수리모델&quot;&gt;Flexible demand의 수리모델&lt;/h2&gt;

&lt;p&gt;Flexible demand란, ‘일정 범위 내에서’ 전기 소비량을 결정할 수 있으며, 하루전 시장에서 계획된 부하를 실시간 시장에서 능동적으로 변경할 수 있는 전기 수요를 말한다.&lt;/p&gt;

&lt;p&gt;Flexible demand $k$에 대해, 하루전 시장에서 $t$시에 대해 계획된 부하를 $d_k(t)$, 실시간 시장에서 stochasticity scenario $\omega$가 실현된 경우의 실제 부하를 $d_{k \omega}(t)$, 계획된 부하 대비 실제 부하를 증가시킬 경우 (발전기로 치면 down-regulation) 그 증가분을 $c_{k \omega}^{D}(t)$, 계획된 부하 대비 실제 부하를 감소시킬 경우 (발전기로 치면 up-regulation) 그 감소분을 $c_{k \omega}^{U}(t)$ 라 하자.&lt;/p&gt;

&lt;p&gt;그리고 각 시간별로 flexible demand $k$의 $t$시 부하의 하한과 상한을 각각 $D_k^{min}(t)$ 와 $D_k^{max}(t)$, ‘하루 동안에 최소로 공급되어야 하는 총 에너지’를 $E_k^{day}$라 하자.&lt;/p&gt;

&lt;p&gt;그러면, 아래 수식들이 성립한다.&lt;/p&gt;

&lt;p&gt;$d_{k \omega}(t) = d_k(t) + c_{k \omega}^{D}(t) - c_{k \omega}^{U}(t) $&lt;/p&gt;

&lt;p&gt;$0 \leq c_{k \omega}^{D}(t) \leq D_k^{max}(t) - d_k(t)$&lt;/p&gt;

&lt;p&gt;$0 \leq c_{k \omega}^{U}(t) \leq d_k(t) - D_k^{min}(t) $&lt;/p&gt;

&lt;p&gt;$\sum_{t=1}^T d_{k \omega}(t) \geq E_k^{day} $&lt;/p&gt;

&lt;p&gt;만약 발전기의 ramping limit처럼 flexible demand에서도 1시간 동안 감소시키거나 증가시킬 수 있는 부하량 각각의 상한이 $D_k^{D}$와 $D_k^{U}$로 존재한다고 하면, 아래 수식들도 성립한다.&lt;/p&gt;

&lt;p&gt;$ d_{k \omega}(t) - d_{k \omega}(t-1) \leq D_k^{U}$&lt;/p&gt;

&lt;p&gt;$ d_{k \omega}(t-1) - d_{k \omega}(t) \leq D_k^{D}$&lt;/p&gt;

&lt;p&gt;Flexible demand의 최적의 스케줄 도출을 위해서는 목적함수에 flexible demand에 대한 term들을 추가해야 한다. 이 때 해당 flexible demand가 전기를 공급받아서 얻는 ‘효용 (utility)’, 그리고 실시간 시장에서 부하를 조정해서 얻는 효용을 반영해야 한다.&lt;/p&gt;

&lt;p&gt;해당 flexible demand가 단위 전기를 공급받을 때 얻는 효용을 $U_k(t)$, 실시간 시장에서 부하를 늘릴 때 (down-regulation)와 줄일 때 (up-regulation) 얻는 효용을 각각 $U_k^{D}(t)$와 $U_k^{U}(t)$라 하자. 그리고 시나리오 $\omega$의 확률을 $\pi_{\omega}$라 하자.&lt;/p&gt;

&lt;p&gt;그러면 flexible demand가 얻는 총 효용은 아래와 같다.&lt;/p&gt;

&lt;p&gt;\begin{align} 
\sum_{t=1}^T \lbrace U_k(t) d_k(t) + \sum_{\omega} \pi_{\omega} [U_k^{D}(t) c_{k \omega}^{D}(t) - U_k^{U}(t) c_{k \omega}^{U}(t)] \rbrace
\notag
\end{align}&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;
&lt;h2 id=&quot;flexible-demand-예시-thermal-comfort를-고려한-열부하의-전기-사용량&quot;&gt;Flexible demand 예시: Thermal comfort를 고려한 열부하의 전기 사용량&lt;/h2&gt;

&lt;p&gt;Demand response (DR) 모델링 시, 수요처가 부하로부터 얻는 ‘효용 (utility)’과 부하를 줄여서 얻는 보상을 비교해서 DR 스케줄을 결정하게 된다.&lt;/p&gt;

&lt;p&gt;건물에서 냉난방기기를 제어해 DR을 수행할 경우, 주로 실내온도의 함수로 주어지는 ‘thermal comfort’를 효용으로 둔다. 즉 대상 건물에서 시간별로 가장 선호되는 기준 실내온도를 정한 후, 실제 실내온도가 기준온도에서 많이 벗어날수록 효용이 적다고, 즉 thermal ‘dis’comfort가 크다고 본다.&lt;/p&gt;

&lt;p&gt;시간 $t$에서의 기준 실내온도를 $\hat{x}^{i}_t$, 실제 실내온도를 $x^{i}_t$로 두자. 그러면, ‘기준온도보다 높아도 낮아도 효용이 줄어드는’ 것을 고려해 목적함수의 thermal discomfort term을 $\sum_{t} c (x^{i}_t - \hat{x}^{i}_t)^2$ 로 둘 수 있다 ($c$는 comfort의 가치를 반영하는 계수이며, $c$가 클수록 comfort를 중요하게 생각한다).&lt;/p&gt;

&lt;p&gt;목적함수에는 thermal discomfort term 뿐 아니라, 건물 온도를 기준 온도에 가깝게 유지하는 데 드는 에너지 요금도 포함되어야 한다. 그래야 thermal comfort와 에너지 사용 간 trade-off를 구할 수 있기 때문이다.&lt;/p&gt;

&lt;p&gt;해당 건물이 난방을 전기온수보일러로 수행하고, 전기온수보일러의 시간 $t$에서의 전기 소비량 $u_t$와 온수탱크 내 온도 $x^{w}_t$ 및 실내온도 $x^{i}_t$ 간의 관계를 아래와 같은 linear state-space model로 나타낼 수 있다고 하자.&lt;/p&gt;

&lt;p&gt;\begin{align}
\begin{bmatrix}
  x^{i}_{t+1} \newline
  x^{w}_{t+1}
  \end{bmatrix} = \begin{bmatrix}
  a_{11} &amp;amp; a_{12} \newline
  0 &amp;amp; a_{22}
  \end{bmatrix} \begin{bmatrix}
  x^{i}_{t} \newline
  x^{w}_{t}
  \end{bmatrix} + \begin{bmatrix}
  0 \newline
  b_2
  \end{bmatrix} u_t
\notag
\end{align}&lt;/p&gt;

&lt;p&gt;그러면 최적화 문제는, 위 linear state-space model을 제약조건으로 하고 아래의 항을 목적함수로 하는 quadratic programming problem이 된다.&lt;/p&gt;

&lt;p&gt;$ \sum_{t} c (x^{i}_t - \hat{x}^{i}_t)^2 + \lambda^{R}_t u_t$&lt;/p&gt;

&lt;p&gt;여기서 $\lambda^{R}_t$는 시간 $t$에서의 사용량요금이다.&lt;/p&gt;
</description>
        <pubDate>Sat, 07 Oct 2023 00:00:00 +0900</pubDate>
        <link>https://song4energyndata.github.io/marketadvanced.html</link>
        <guid isPermaLink="true">https://song4energyndata.github.io/marketadvanced.html</guid>
        
        <category>전력시장</category>
        
        <category>에너지시스템</category>
        
        
        <category>market</category>
        
      </item>
    
      <item>
        <title>에너지효율 R&amp;D 투자효과 분석 (패널 데이터 기반) 연구 복원</title>
        <description>&lt;p&gt;에너지정책의 효과를 ‘정량적으로’ 분석하는 방법으로, 회귀분석의 일종인 ‘패널 분석’ (Panel data analysis) 이 있다. 이를테면 에너지경제연구원에서는 에너지효율 R&amp;amp;D 투자가 에너지소비 감소에 기여했는지 여부를 검정하기 위해, &lt;a href=&quot;https://www.keei.re.kr/main.nsf/index.html?open&amp;amp;p=/web_keei/d_results.nsf/0/BE8E066A1FCE159A49258107001E2AA9&quot;&gt;“에너지효율향상 R&amp;amp;D 투자효과 분석 및 정책방향 연구”&lt;/a&gt; 를 수행한 바 있다.&lt;/p&gt;

&lt;p&gt;해당 연구에서는 1985년부터 2013년까지 연도별로 12개 국가 각각의 에너지소비량/ R&amp;amp;D투자/ 통제대상변수들 데이터를 사용해, 에너지효율향상 R&amp;amp;D가 에너지소비량 절감에 유의미한 영향을 주었는지를 알아보았다. 이러한 데이터는 ‘여러 개체’ 를 ‘여러 시간’ 에 걸쳐 관측해 얻은 데이터이며, 이러한 데이터를 패널 데이터라고 한다.&lt;/p&gt;

&lt;p&gt;이번 포스팅에서는, 필자가 패널데이터분석 실무 공부를 위해 해당 연구 결과의 복원을 시도한 결과를 정리하였다.&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;
&lt;h2 id=&quot;연구-상세&quot;&gt;연구 상세&lt;/h2&gt;

&lt;p&gt;12개 국가 목록은 노르웨이/ 네덜란드/ 덴마크/ 독일/ 미국/ 스페인/ 스웨덴/ 영국/ 오스트리아/ 일본/ 포르투갈 이다.&lt;/p&gt;

&lt;p&gt;해당 패널분석에서 반응변수는 ‘1인당’ 에너지 소비량이다. 설명변수들은 ‘1인당’ GDP/ 에너지 가격 지수/ 난방도일/ ‘1인당’ R&amp;amp;D 투자 축적량이다. 에너지 소비량에 큰 영향을 미치는 요소로 GDP/ 에너지가격/ 난방에너지사용량/ 인구수 가 있으므로, 이들을 통제한 상태에서 R&amp;amp;D투자의 효과를 계산하기 위함이다.&lt;/p&gt;

&lt;p&gt;구체적으로는 변수들에 로그를 취해서 계수추정량이 탄력성을 의미하도록 하였다. 또한 명시적으로 반영하지 못한 변수들 (즉 오차항의 성분) 중 각 국가별로 시간에 관계없이 고유하게 가지면서 설명변수들과 상관된 요소가 존재할 수 있으므로 (이를테면 문화적 요소 등), 이를 고려한 고정효과 (fixed effect) 모델 및 1계차분 (first-order difference) 모델의 계수를 도출하였다.&lt;/p&gt;

&lt;p&gt;고정효과 모델의 수식은 아래와 같다.&lt;/p&gt;

&lt;p&gt;$\text{ln}(\frac{EC}{Pop})_{i,t} = \beta_0 + \beta_1 \text{ln}(\frac{GDP}{Pop})_{i,t} + \beta_2 \text{ln}(EP)_{i,t} + \beta_3 \text{ln}(HDD)_{i,t} + \beta_4 \text{ln}(\frac{AccRnD}{Pop})_{i,t} + u_i + e_{i,t}$&lt;/p&gt;

&lt;p&gt;첨자 $i$와 $t$는 각각 나라와 연도를 의미한다. $EC$는 에너지 소비량, $Pop$는 인구수, $GDP$는 총 GDP, $EP$는 에너지 가격 지수, $HDD$는 난방도일, $AccRnD$는 해당 연도까지의 에너지효율 R&amp;amp;D 투자액의 축적량이다 (단, 모든 연도의 투자액을 단순히 더하지 않고 감가율을 적용하였다). 오차항에서 $u_i$는 시간에 관계없는 국가 고유의 요소들 (문화적 요소 등), $e_{i,t}$는 국가 및 시간별로 변하는 요소들을 의미한다.&lt;/p&gt;

&lt;p&gt;1계차분 모델의 수식은 아래와 같다.&lt;/p&gt;

&lt;p&gt;$\Delta \text{ln}(\frac{EC}{Pop})_{i,t} = \beta_1 \Delta \text{ln}(\frac{GDP}{Pop})_{i,t} + \beta_2 \Delta \text{ln}(EP)_{i,t} + \beta_3 \Delta \text{ln}(HDD)_{i,t} + \beta_4 \Delta \text{ln}(\frac{AccRnD}{Pop})_{i,t} + \Delta e_{i,t}$&lt;/p&gt;

&lt;p&gt;해당 연구의 분석기간인 1985~2013년 중 1997년에 교토의정서가 채택되어, 해당 시기 전후로 에너지효율 R&amp;amp;D 투자에 양적/ 질적 차이가 나타날 가능성이 크다. 이를 고려해, 해당 연구에서는 1997년을 기준으로 전기와 후기를 나누어 각각에 대한 추정 및 모든 기간에 대한 변수별 계수추정을 수행하였다.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/energyeffpanel/result_original.png&quot; alt=&quot;systemscheme&quot; class=&quot;align-center&quot; /&gt;
&lt;em&gt;해당 연구의 패널 분석 결과.&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;패널분석으로 도출한 변수 별 계수의 부호를 보면, 에너지가격은 음의 계수를, 1인당 GDP와 난방도일은 양의 계수를 갖는다. 일반적으로 에너지 가격이 상승하면 에너지 소비가 감소하고, GDP와 난방도일이 증가하면 에너지 소비가 증가할 것이라 예상하는데, 패널분석 결과가 예상과 일치한다.&lt;/p&gt;

&lt;p&gt;에너지 효율 R&amp;amp;D 투자 축적은 전기에서는 계수가 통계적으로 유의하지 않았으나, 후기에서는 유의한 음의 계수를 가졌다. 이는 에너지 효율 R&amp;amp;D 투자가 에너지 절감에 기여한다는 예상과 일치하며, 그 효과가 교토의정서 채택 이후 본격적으로 나타났음을 의미한다.&lt;/p&gt;

&lt;p&gt;(단, 고정효과 회귀와 1계차분 회귀의 계수들의 값들 및 유의성은 서로 다르다. 그래서 보통 두 회귀를 모두 수행 후, 부호가 일치하는지를 본다. 그리고 모든 항들에 자연로그를 취했으므로, 계수의 값은 ‘한 나라 내에서 다른 설명변수들의 불변 가정 하에 해당 설명변수가 현재 대비 1% 증가 시 반응변수의 퍼센트 기준 증감’을 의미한다.)&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;
&lt;h2 id=&quot;복원을-위한-데이터-수집&quot;&gt;복원을 위한 데이터 수집&lt;/h2&gt;

&lt;p&gt;반응변수의 경우, &lt;a href=&quot;https://data.oecd.org/energy/primary-energy-supply.htm&quot;&gt;OECD database의 1차에너지 (primary energy supply)&lt;/a&gt; 를 사용하였다. 설명변수들 중 &lt;a href=&quot;https://data.oecd.org/gdp/gross-domestic-product-gdp.htm&quot;&gt;GDP&lt;/a&gt;, &lt;a href=&quot;https://data.oecd.org/pop/population.htm&quot;&gt;인구수&lt;/a&gt;, &lt;a href=&quot;https://stats.oecd.org/BrandedView.aspx?oecd_bv_id=enetech-data-en&amp;amp;doi=data-00488-en&quot;&gt;에너지효율 R&amp;amp;D 투자액&lt;/a&gt; 또한 OECD database에서 찾은 값들을 사용하였다. 에너지효율 R&amp;amp;D 투자액 자료를 누적 축적량으로 변환하는 방법은 에너지경제연구원 문헌에서 설명한 방법과 같다.&lt;/p&gt;

&lt;p&gt;에너지가격의 경우, 해당 연구에서 사용한 자료를 그대로는 얻을 수 없었다. &lt;a href=&quot;https://www.oecd-ilibrary.org/energy/data/iea-energy-prices-and-taxes-statistics_eneprice-data-en&quot;&gt;IEA의 Energy prices and taxes Database&lt;/a&gt;가 유료회원 전용 자료이기 때문이다.&lt;/p&gt;

&lt;p&gt;그래서, 에너지가격을 누락변수 (ommited variable) 라 할 때, 해당 누락변수와 상관관계가 있어 도구변수 (instrumental variable) 로 쓸 수 있으면서 OECD database에서 구할 수 있는 자료인, &lt;a href=&quot;https://data.oecd.org/energy/crude-oil-import-prices.htm&quot;&gt;Crude oil import prices&lt;/a&gt;를 대신 사용하였다.&lt;/p&gt;

&lt;p&gt;난방도일의 경우, 필자는 스위스/ 영국/ 일본 의 자료를 구할 수 없었다. (IHS와 IEEJ의 자료가 유료이며, 영국의 경우 EU에서 탈퇴하여 Eurostat에서 자료를 찾을 수 없었다.) 그래서, 최종적으로는 &lt;a href=&quot;https://ec.europa.eu/eurostat/web/energy/database&quot;&gt;해당 3개 국가를 제외한 나머지 9개 국가에 대한 자료&lt;/a&gt;를 사용하였다.&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;
&lt;h2 id=&quot;복원-결과&quot;&gt;복원 결과&lt;/h2&gt;

&lt;p&gt;필자가 모은 데이터로 고정효과 회귀를 수행해 도출한 계수별 부호가, 기존 연구 결과와 일치하였다. 교토의정서 이후 기간과 전체 기간에 대해, R&amp;amp;D 투자액 축적과 에너지가격에 대해서는 음의 계수가, GDP와 난방도일에 대해서는 양의 계수가 유의미하게 도출되었다 (클러스터 표준오차 기준).&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/energyeffpanel/result_fe_later.png&quot; alt=&quot;systemscheme&quot; class=&quot;align-center&quot; width=&quot;80%&quot; /&gt;
&lt;img src=&quot;/assets/images/energyeffpanel/result_fe_whole.png&quot; alt=&quot;systemscheme&quot; class=&quot;align-center&quot; width=&quot;80%&quot; /&gt;
&lt;em&gt;필자가 모은 데이터로 fixed effect 회귀를 수행한 결과. (위: 교토의정서 이후 기간, 아래: 전체기간)&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;Hausman test를 통해, 임의효과 (random effect) 가 아닌 고정효과 회귀를 수행해야 함도 확인하였다.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/energyeffpanel/result_hausman.png&quot; alt=&quot;systemscheme&quot; class=&quot;align-center&quot; width=&quot;80%&quot; /&gt;
&lt;em&gt;필자가 모은 데이터로 fixed effect 회귀를 수행한 결과. (위: 교토의정서 이후 기간, 아래: 전체기간)&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;필자가 모은 데이터의 경우, 일계차분 회귀에서는 R&amp;amp;D 투자액 축적의 계수가 작아 유의미하지 않았다. 그러므로 일단은, 필자가 복원한 고정효과 모델에서 관측한 변수별 계수 부호가, 에너지경제연구원의 연구 원본에서의 그것과 같음을 확인했음에 의의를 둔다.&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;
&lt;h2 id=&quot;코드&quot;&gt;코드&lt;/h2&gt;

&lt;p&gt;패널 분석에 사용한 R 코드는 아래와 같다. 필자가 사용한 데이터셋은 &lt;a href=&quot;https://github.com/song4energyndata/Codes/tree/main/paneldata/energyeffrnd&quot;&gt;GitHub Repo&lt;/a&gt;에 있다. Input 데이터 ($\texttt{energyrnd_rndpercapita.csv}$) 에서 첫 번째 열은 각 국가의 인덱스이며 (즉 서로 다른 숫자가 서로 다른 국가를 의미), 두 번째 열은 연도이다.&lt;/p&gt;

&lt;div class=&quot;language-r highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;rm&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;list&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ls&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;())&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;setwd&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dirname&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rstudioapi&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;getActiveDocumentContext&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;$&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;path&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;scriptpath&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;getwd&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cat&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;\014&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;

&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;library&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;plm&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;library&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;lmtest&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;library&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sandwich&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;library&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;multiwayvcov&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;

&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;energyrnddat&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;read.csv&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&apos;energyrnd_rndpercapita.csv&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;energyrnddat.former&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;energyrnddat&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;energyrnddat&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;$&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;year&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;1998&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,]&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# 교토의정서 이전 기간&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;energyrnddat.later&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;energyrnddat&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;energyrnddat&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;$&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;year&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;1997&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,]&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# 교토의정서 이후 기간&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;


&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;model.FE.former&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;plm&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ecperpop&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;~&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;gdpperpop&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;eprice&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;hdd&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;accrndperpop&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;energyrnddat.former&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;within&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;summary&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;model.FE.former&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# Fixed effect regression&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;coeftest&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;model.FE.former&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;vcov&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;vcovHC&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;model.FE.former&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;type&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;sss&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cluster&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;group&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# 클러스터 표준오차&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pwartest&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;model.FE.former&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;

&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;model.FE.later&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;plm&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ecperpop&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;~&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;gdpperpop&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;eprice&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;hdd&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;accrndperpop&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;energyrnddat.later&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;within&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;summary&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;model.FE.later&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;coeftest&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;model.FE.later&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;vcov&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;vcovHC&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;model.FE.later&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;type&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;sss&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cluster&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;group&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; 
&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pwartest&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;model.FE.later&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;

&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;model.FE.whole&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;plm&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ecperpop&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;~&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;gdpperpop&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;eprice&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;hdd&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;accrndperpop&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;energyrnddat&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;within&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;summary&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;model.FE.whole&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;coeftest&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;model.FE.whole&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;vcov&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;vcovHC&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;model.FE.whole&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;type&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;sss&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cluster&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;group&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; 
&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pwartest&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;model.FE.whole&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;


&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;model.RE.former&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;plm&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ecperpop&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;~&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;gdpperpop&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;eprice&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;hdd&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;accrndperpop&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;energyrnddat.former&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;random&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;phtest&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;model.FE.former&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;model.RE.former&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# Hausman test&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;

&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;model.RE.later&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;plm&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ecperpop&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;~&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;gdpperpop&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;eprice&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;hdd&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;accrndperpop&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;energyrnddat.later&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;random&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;phtest&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;model.FE.later&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;model.RE.later&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;


&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;model.FD.former&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;plm&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ecperpop&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;~&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;gdpperpop&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;eprice&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;hdd&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;accrndperpop&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;energyrnddat.former&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;fd&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;summary&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;model.FD.former&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# First-order difference regression&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;

&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;model.FD.later&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;plm&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ecperpop&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;~&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;gdpperpop&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;eprice&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;hdd&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;accrndperpop&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;energyrnddat.later&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;fd&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;summary&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;model.FD.later&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;

&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;model.FD.whole&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;plm&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ecperpop&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;~&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;gdpperpop&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;eprice&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;hdd&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;accrndperpop&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;energyrnddat&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;fd&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;summary&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;model.FD.whole&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;(위 R 코드 내 메서드들이, &lt;a href=&quot;https://product.kyobobook.co.kr/detail/S000001681310&quot;&gt;한치록 교수의 “패널데이터강의”&lt;/a&gt; 에 나오는 Stata 코드 기반 예제들에 대해 같은 데이터로 같은 결과를 도출함을 확인하였다.)&lt;/p&gt;
</description>
        <pubDate>Sun, 24 Sep 2023 00:00:00 +0900</pubDate>
        <link>https://song4energyndata.github.io/energyeffpanel.html</link>
        <guid isPermaLink="true">https://song4energyndata.github.io/energyeffpanel.html</guid>
        
        <category>에너지정책</category>
        
        <category>에너지효율</category>
        
        <category>회귀분석</category>
        
        
        <category>policy</category>
        
      </item>
    
      <item>
        <title>논문 소개: Virtual power plant의 하루전시장 입찰 결정 (stochastic programming 기반)</title>
        <description>&lt;p&gt;Virtual power plant (VPP, 가상발전소) 는 급전가능발전원 (가스터빈 등), 급전불가능발전원 (태양광/ 풍력 등), 에너지저장장치 (배터리/ 양수발전 등) 등 여러 발전/ 전력저장 설비들을 클라우드 등 IT기술 기반으로 한꺼번에 제어해 단일 주체로써 전력시장에 입찰하는 방법이다.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/vppintro/vppconcept.png&quot; alt=&quot;systemscheme&quot; class=&quot;align-center&quot; /&gt;
&lt;em&gt;가상발전소 개념도. (출처: 한국전기연구원)&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;VPP를 통해 다수의 분산전원 사업자들이 보다 쉽게 전력시장에 참여할 수 있고, 급전가능발전원 및 에너지장치를 포함시켜 공급 당일 실제 발전량을 하루전 시장에서의 입찰 전력량과 일치시킬 수 있으며, 필요시 VPP 전체가 주파수 변동 억제 등의 계통안정도 관련 보조서비스를 제공할 수도 있다.&lt;/p&gt;

&lt;p&gt;이 포스팅에서는, VPP가 하루전시장과 실시간시장으로 이루어진 전력시장에 입찰 시 시간별 발전량을 결정하는 방법에 대한 대표적 논문을 소개한다. Applied Energy에서 2013년에 출판된 &lt;a href=&quot;https://doi.org/10.1016/j.apenergy.2012.12.077&quot;&gt;“Offering model for a virtual power plant based on stochastic programming”&lt;/a&gt; 이다.&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;
&lt;h2 id=&quot;경제성-관점에서-vpp의-필요성&quot;&gt;경제성 관점에서 VPP의 필요성&lt;/h2&gt;
&lt;p&gt;VPP가 하루전시장과 실시간시장으로 이루어진 전력시장에 입찰할 경우, 하루전시장에 ‘내일 24시간의 각 시간 별 발전량’ 을 제출한다. VPP는 급전 당일에 재생발전원의 실제 발전량을 관측하고 급전가능발전원과 에너지저장장치를 제어하여, 총 발전량이 하루전시장에 제출했던 시간별 발전량과 일치하도록 한다 (balancing).&lt;/p&gt;

&lt;p&gt;그러나, 만약 재생발전원의 용량은 큰데 급전가능발전원 및 에너지저장장치가 부족하거나 심지어는 없다면, 공급 당일의 총 발전량이 하루전에 제출된 발전량과 다를 것이다. 이러한 차이는 경제적 손실을 야기한다.&lt;/p&gt;

&lt;p&gt;이를테면 특정 시간에 대해 하루전 제출된 급전량은 큰데 풍력발전량이 예상보다 너무 낮아서, 가스터빈을 최대출력으로 가동하고 에너지저장장치를 최대로 방전시켜도 하루전 제출된 발전량보다 부족할 수 있다. 이 경우 balancing을 위해 전력부족분을 실시간 시장에서 더 높은 가격에 구입하므로, 하루전시장에서 전력부족분만큼을 덜 입찰했을 경우와 비교하면 경제적 손실을 본다.&lt;/p&gt;

&lt;p&gt;반대로 특정 시간에 대해 하루전 제출된 발전량은 작은데 풍력발전량이 예상보다 너무 높아서, 가스터빈을 가동하지 않고 에너지저장장치를 최대로 충전시켜도 하루전 제출된 발전량을 초과할 수 있다. 이 경우 balancing을 위해 잉여전력을 실시간 시장에서 더 낮은 가격에 판매하므로, 하루전시장에서 잉여전력분만큼을 더 입찰했을 경우와 비교하면 경제적 손실을 본다.&lt;/p&gt;

&lt;p&gt;가상발전소는 이러한 ‘하루전에 제출된 발전량과 실제 발전량의 차이’를 줄여 수익을 증가시킬 수 있다. 재생발전원 단독으로는 아무리 예측을 잘 해도 하루전 제출 발전량과 실제 발전량 간에 차이가 있다. 이러한 차이가 실시간 시장에서의 balancing에 의한 경제적 손실을 야기하므로, 급전가능발전원 및 에너지저장장치와 연계해 그 차이를 없애고자 하는 것이다.&lt;/p&gt;

&lt;p&gt;(이러한 차이를 줄일 경우, 국가적으로는 중앙급전 발전원들의 발전량을 보다 정확하게 산정할 수 있다는 편익도 있다.)&lt;/p&gt;

&lt;p&gt;위 논문의 case study에서 다루는 가상발전소도 9.6MW급 풍력터빈에 더해 40MWh급 양수에너지저장소와 5.67MW급 급전가능 가스터빈으로 구성된다.&lt;/p&gt;

&lt;p&gt;참고로 우리나라의 경우 아직 실시간 시장이 없으며, 현재 VPP의 수익원 대부분은 &lt;a href=&quot;https://www.electimes.com/news/articleView.html?idxno=320020&quot;&gt;재생발전량을 정확하게 예측할 경우 받는 정산금&lt;/a&gt;이다. 그러나 &lt;a href=&quot;https://www.electimes.com/news/articleView.html?idxno=325061&quot;&gt;실시간 시장이 2024년 2월부터 제주도에 시범적으로 개설되며 2025년에는 육지에도 적용될 예정&lt;/a&gt;이므로, 향후 몇 년 내로 VPP 사업이 활성화될 수 있을 것으로 보인다.&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;
&lt;h2 id=&quot;vpp의-offer-curve-급전량을-미래의-시장가격의-함수로-결정&quot;&gt;VPP의 offer curve: 급전량을 미래의 시장가격의 함수로 결정&lt;/h2&gt;

&lt;p&gt;하루전시장에 제출할 시간별 급전량을 최적화 문제를 풀어 결정하려면, 하루전 시장에서의 시간별 시장가격 및 실시간 시장에서의 시간별 시장가격을 알아야 한다 (VPP는 시장가격을 정해진 그대로 받아들이며 시장가격에 영향을 미치지 못하는 price taker라고 가정).&lt;/p&gt;

&lt;p&gt;그러나 실제로는 다음날의 시간별 시장가격을 모르므로, ‘하루전 시장에서의 $t$시의 시장가격이 $\lambda(t)$이면 우리 VPP는 $G(t)$ 만큼 발전할 것’ 이라는 계획을 제출한다. 즉 시간별 발전량이 해당 시간의 시장가격의 함수이다. 이를 ‘offer curve’라 한다.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/vppintro/offercurve.png&quot; alt=&quot;systemscheme&quot; class=&quot;align-center&quot; /&gt;
&lt;em&gt;Offer curve (출처: 소개 논문).&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;위 그림에서 각 curve는 하나의 시간에 대응하며, 해당 시간의 시장가격(가로축)에 대응하는 VPP의 발전량(세로축) 을 보여준다. 음의 발전량은 에너지저장장치 충전을 의미한다 (부하가 적어 상대적으로 시장가격이 저렴한 시간대에 충전 후 낮 시간에 방전한다).&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;
&lt;h2 id=&quot;불확실성을-고려한-stochastic-programming-기반-offer-curve-도출&quot;&gt;불확실성을 고려한 stochastic programming 기반 offer curve 도출&lt;/h2&gt;

&lt;p&gt;여기서 난점은, 재생발전원의 다음날 시간별 발전량 또한 불확실하다는 것이다. 그러므로 ‘stochastic programming’ 문제가 된다.&lt;/p&gt;

&lt;p&gt;보통 이러한 multi-period (여기서는 24시간) stochastic programming에서는, 다음날의 시간별 시장가격과 재생발전량 ‘시나리오’들을 아래와 같이 만든다.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/vppintro/scenario_dayahead.png&quot; alt=&quot;systemscheme&quot; class=&quot;align-center&quot; /&gt;
&lt;img src=&quot;/assets/images/vppintro/scenario_balancing.png&quot; alt=&quot;systemscheme&quot; class=&quot;align-center&quot; /&gt;
&lt;em&gt;시간별 시장가격 시나리오 (위: 하루전시장, 아래: 실시간시장. 출처: 소개 논문).&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/vppintro/scenario_wind.png&quot; alt=&quot;systemscheme&quot; class=&quot;align-center&quot; /&gt;
&lt;em&gt;시간별 풍력 발전량 시나리오 (출처: 소개 논문).&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;각 시나리오는 24시간 동안의 시간별 수치들의 집합 즉 ‘trajectory’이다. 이렇게 trajectory를 쓰는 이유는, 해당 시계열 데이터들이 시간에 따른 자기상관관계 (autocorrelation) 를 가질 것이기 때문이다.&lt;/p&gt;

&lt;p&gt;또한 각 시나리오별 확률도 사전에 결정해야 한다 (해당 논문에서는 편의상 각 시나리오 별 확률이 같다고 (equiprobable) 가정했다).&lt;/p&gt;

&lt;p&gt;시간별 시장가격의 시나리오 인덱스를 $p$, 풍력발전량의 시나리오 인덱스를 $w$라 하자. 최적화 문제에서는 ‘각 시나리오 별 하루전 시장에서의 시간 $t$에 대한 발전량 제출’ $G_{wp}(t)$를 결정한다.&lt;/p&gt;

&lt;p&gt;실시간 시장에서의 balancing에 대한 제약조건은 아래와 같다.&lt;/p&gt;

&lt;p&gt;$G_{wp}(t) = g_w(t) + g_{wp}^c (t) + g_{wp}^t (t) + bm_{wp}^{up}(t) - g_{wp}^p(t)/\eta - bm_{wp}^{down}(t) \quad \forall w,p,t$&lt;/p&gt;

&lt;p&gt;각 시간 $t$에 대해 어떤 시나리오 $wp$ 하에서도, $G_{wp}(t)$는 당일의 풍력 발전량 $g_w(t)$, 가스터빈 발전량 $g_{wp}^c (t)$, 양수에너지저장소의 터빈에 의한 발전량 $g_{wp}^t (t)$, 당일 시장에서 필요 시 추가로 구입하는 에너지 $bm_{wp}^{up}(t) $ 의 합으로부터, 양수에너지저장소의 펌프 가동 에너지 $g_{wp}^p (t)$ 에 efficiency factor $\eta$를 곱한 값과 당일 시장에서 필요 시 재판매하는 에너지 $bm_{wp}^{down}(t) $ 을 뺀 값과 같아야 한다.&lt;/p&gt;

&lt;p&gt;그런데, offer curve에서 시간별 급전량은 시장가격의 함수이기는 하지만 풍력발전량의 함수는 아니다. 다음날의 풍력발전량을 ‘모르는’ 상태에서 시간별 급전량을 동일시간의 시장가격의 함수로 결정하기 때문이다. 그러므로, 하나의 $(p,t)$ 순서쌍이 주어지면 $G_{wp}(t)$는 모든 $w$에 대해 같아야 한다. 즉, 아래 제약조건이 추가로 필요하다.&lt;/p&gt;

&lt;p&gt;$G_{w_{1} p}(t) = G_{w_{2} p}(t) = \cdots = G_{w_{n} p}(t)$  ($w_1, \dots,w_n$은 풍력발전 시나리오들)&lt;/p&gt;

&lt;p&gt;Stochastic programming에서는 위 수식처럼 여러 시나리오들에 대해 변수가 같다는 제약조건을 ‘non-anticipativity constraint’ 라고 한다. Anticipate가 ‘예측하다’ 라는 뜻인데, 여기서는 다음날의 풍력발전을 정확히 예측하지 못한다는 의미이다.&lt;/p&gt;

&lt;p&gt;그 외의 제약조건들은 필자의 최적화문제 소개글들에 있는 &lt;a href=&quot;https://song4energyndata.github.io/linprogten.html&quot;&gt;출력조정 제약&lt;/a&gt;, &lt;a href=&quot;https://song4energyndata.github.io/linprogtwo.html&quot;&gt;에너지저장장치 충방전에 대한 제약&lt;/a&gt; 등이다.&lt;/p&gt;

&lt;p&gt;목적함수는 아래와 같다. $\pi$는 시나리오 별 확률을 의미하며, 각 시나리오 별 총 수익은 하루전 시장에서의 입찰에 의한 수익 $\lambda_p(t)G_{wp}(t)$에 실시간 시장에서 balancing을 위해 추가적으로 판매하는 잉여전력의 수익 및 추가적으로 구입하는 전력부족분의 비용 (음의 수익) 을 더하고 가스터빈 구동에 드는 연료비 $C_{wp}^c(t)$ 및 시동비용 $SUC^c v_{wp}^c (t)$ 를 뺀 값이다.&lt;/p&gt;

&lt;p&gt;$ \sum_t \sum_w \pi_w \sum_p \pi_p \sum_{r^{down}} \pi_r^{down} \sum_{r^{up}} \pi_r^{up} [\lambda_p(t) (G_{wp}(t) + bm_{wp}^{down}(t) \psi_r^{down}(t) - bm_{wp}^{up}(t) \psi_r^{up}(t) ) - C_{wp}^c(t) - SUC^c v_{wp}^c (t)] $&lt;/p&gt;

&lt;p&gt;문제를 풀면, 위 시나리오들을 고려할 때의 ‘총 수익의 기대값’을 최대화하도록 offer curve가 결정된다.&lt;/p&gt;

&lt;p&gt;위 연구는 stochastic programming 기반으로 재생발전 비중이 높은 VPP의 입찰량을 계산하는 방법의 baseline으로써 가치가 있다 (해당 논문은 인용횟수가 300회를 넘는다).&lt;/p&gt;
</description>
        <pubDate>Sun, 10 Sep 2023 00:00:00 +0900</pubDate>
        <link>https://song4energyndata.github.io/vppintro.html</link>
        <guid isPermaLink="true">https://song4energyndata.github.io/vppintro.html</guid>
        
        <category>전력시장</category>
        
        <category>에너지시스템</category>
        
        <category>VPP</category>
        
        
        <category>market</category>
        
      </item>
    
      <item>
        <title>에너지시스템 최적화/게임이론 강의: 12) Variants of ADMM and applications</title>
        <description>&lt;p&gt;이 포스팅은, Technical University of Denmark의 박사과정 과목 “Advanced Optimization and Game Theory for Energy Systems” (Prof. Jalal Kazempour) 의 12강을 필자가 요약한 내용이다.&lt;/p&gt;

&lt;!-- Courtesy of embedresponsively.com --&gt;

&lt;div class=&quot;responsive-video-container&quot;&gt;
    &lt;iframe src=&quot;https://www.youtube-nocookie.com/embed/MWPJAl84Sac&quot; frameborder=&quot;0&quot; webkitallowfullscreen=&quot;&quot; mozallowfullscreen=&quot;&quot; allowfullscreen=&quot;&quot;&gt;&lt;/iframe&gt;
  &lt;/div&gt;

&lt;p&gt;(&lt;a href=&quot;https://www.jalalkazempour.com/teaching&quot;&gt;Course slides 링크&lt;/a&gt;)&lt;/p&gt;

&lt;h2 id=&quot;economic-dispatch&quot;&gt;Economic dispatch&lt;/h2&gt;

&lt;p&gt;여러 대의 발전기로 시간별 수요를 만족시키는 최소비용의 스케줄을 구하는 문제에서는, 각 수요-공급 일치 조건이 complicating constraint이다. 해당 제약조건에 모든 발전기의 출력 항들이 포함되기 때문으로, 해당 제약조건을 relax하면 각 발전기 별 subproblem으로 나눌 수 있다.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/jalal/Lecture12_25.png&quot; alt=&quot;clearingexample&quot; /&gt;&lt;/p&gt;

&lt;p&gt;위 예제에서는 목적함수가 quadratic function이므로, Lagrangian Relaxation (LR) 을 적용할 수 있다.&lt;/p&gt;

&lt;p&gt;Complicating constraint인 수요-공급 일치 제약에 dual variable $\lambda$을 곱한 항을 목적함수에 추가하고, dual variable의 값을 $\bar{\lambda}$ 로 고정하면, 각 발전기 별 subproblem으로 나눌 수 있다.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/jalal/Lecture12_27.png&quot; alt=&quot;clearingexample&quot; /&gt;&lt;/p&gt;

&lt;p&gt;그리고 각 발전기 별 subproblem을 풀어 $v$번째 iteration 기준 $p_g^{(v)}$를 구하고, 이를 통해 아래와 같이 $\bar{\lambda}^{(v)}$를 $\bar{\lambda}^{(v+1)}$로 업데이트한다.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/jalal/Lecture12_35.png&quot; alt=&quot;clearingexample&quot; /&gt;&lt;/p&gt;

&lt;p&gt;이 때 $\bar{\lambda}^{(v)}$는 수요-공급 일치 제약에 대한 dual variable이므로 ‘가격’이기도 하다. 여기서는 각 발전기 별로 자신의 이익을 최대화하는 발전량을 설정하고, 이를 모두 취합한 market operator가 가격을 업데이트한 후 다시 발전기들에게 통보한다. 그리고 각 발전기는 수정된 가격에 대해 발전량을 재설정하고, market operator는 이를 다시 취합해 가격을 업데이트하는 과정을 수렴할 때까지 반복한다.&lt;/p&gt;

&lt;p&gt;이런 식으로 가격을 iterative하게 결정하는 시장을 Walrasian auction이라고 한다.&lt;/p&gt;

&lt;p&gt;이러한 ‘distributed’ technique 기반으로 가격을 결정하는 방법은, 시장에 여러 가지 externalities가 추가되어 시장 균형 문제가 더 이상 동치인 최적화 문제를 갖지 않는 경우에 특히 유용한 것으로 알려져 있다.&lt;/p&gt;

&lt;h2 id=&quot;market-clearing-with-linear-offers&quot;&gt;Market clearing (with linear offers)&lt;/h2&gt;

&lt;p&gt;Market clearing problem에서도 수요-공급 일치 조건이 complicating constraint이다.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/jalal/Lecture12_42.png&quot; alt=&quot;clearingexample&quot; /&gt;&lt;/p&gt;

&lt;p&gt;만약 위 예제처럼 목적함수가 quadratic이 아니라 linear function이면, ‘augmented’ LR을 사용해야 한다. 그러므로 목적함수에 complicating constraint의 제곱항을 추가한다 (regulization coefficient $\gamma/2$를 곱해서).&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/jalal/Lecture12_45.png&quot; alt=&quot;clearingexample&quot; /&gt;&lt;/p&gt;

&lt;p&gt;단, 이 경우 $\lambda$의 값을 $\bar{\lambda}$로 고정해도 각 발전기 별 subproblem으로 바로 나눌 수 없다. Complicating constraint의 제곱항 내에 변수들 간 product term이 있기 때문이다. 그러므로 각 발전기에 대해, 나머지 발전기들의 발전량을 고정하여 구성한 문제를 푼다 (ADMM). 각 발전기 별 최적의 발전량을 기반으로, $\bar{\lambda}$가 업데이트된다.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/jalal/Lecture12_50.png&quot; alt=&quot;clearingexample&quot; /&gt;&lt;/p&gt;

&lt;h2 id=&quot;privacy-이슈를-고려한-exchange-admm&quot;&gt;Privacy 이슈를 고려한 Exchange ADMM&lt;/h2&gt;

&lt;p&gt;위 슬라이드의 ADMM에는 한 가지 ‘실질적인’ 문제가 있다. 발전기 1번의 ($v$번째 iteration에서의) 발전량을 계산하려면 발전기 2와 발전기 3의 ($v-1$번째 iteration에서의) 발전량 정보가 발전기 1에 전달되어야 하는데, 이는 ‘privacy 침해’로 볼 수 있기 때문이다.&lt;/p&gt;

&lt;p&gt;그러나 문제의 식을 아래 슬라이드와 같이 ‘모든 발전기들의 발전량들의 평균’을 도입해 변형하면, 이러한 ‘privacy 침해’ 문제를 완화할 수 있다.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/jalal/Lecture12_59.png&quot; alt=&quot;clearingexample&quot; /&gt;&lt;/p&gt;

&lt;p&gt;각 발전기는 $v-1$번째 iteration에서의 자기 자신의 발전량 $x_i^{(v-1)}$ 및 ‘모든 발전기들의 발전량들의 평균’ $\bar{x}^{(v-1)}$ 을 알면, $x_i^{(v)}$를 계산할 수 있다. 즉 각자의 발전량 정보는 market operator에게는 전달되지만, 다른 개별 발전기들에게는 전달되지 않기 때문에 privacy 침해 문제가 완화된다. 이를 ‘exchange’ ADMM이라 한다.&lt;/p&gt;

&lt;h2 id=&quot;consensus-admm&quot;&gt;Consensus ADMM&lt;/h2&gt;

&lt;p&gt;모든 subproblem들에 공통으로 포함된 complicating variable이 있을 경우 이를 Bender’s decomposition으로 푸는 대신, ADMM 방식으로 풀 수도 있다.&lt;/p&gt;

&lt;p&gt;아래 슬라이드에서는, 원래 문제에서의 complicating variable $x$를 각 subproblem $i$ 별로 $x_i$라는 변수로 두고, 대신 $x_i$가 공통의 값 $z$와 같다는 제약을 추가했다. 이 문제에서 $z$는 parameter가 아닌 변수임에 주의한다.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/jalal/Lecture12_67.png&quot; alt=&quot;clearingexample&quot; /&gt;&lt;/p&gt;

&lt;p&gt;$x_i=z$는 complicating constraint이다. 그러므로, 각 subproblem별 목적함수에 제약 $x_i-z=0$의 좌변에 dual variable을 곱한 항과 좌변의 제곱에 regularization coefficient를 곱한 항을 추가 후 dual variable과 $z$의 값을 고정해 ADMM 스타일의 문제를 아래와 같이 구성할 수 있다.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/jalal/Lecture12_71.png&quot; alt=&quot;clearingexample&quot; /&gt;&lt;/p&gt;

&lt;p&gt;각각의 $x_i$가 전부 특정 값 $z$로 같아야 한다는, 즉 ‘consensus를 이뤄야 한다는’ 제약이 있어, 이를 consensus ADMM이라 한다.&lt;/p&gt;

&lt;p&gt;여기서 난점은, $\bar{\lambda}$ 뿐 아니라 complicating variable이 최종적으로 가져야 할 값 $z$도 업데이트해야 한다는 것이다.&lt;/p&gt;

&lt;p&gt;다행히도, $z$를 업데이트하는 문제는 아래와 같이 analytic solution을 가진다.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/jalal/Lecture12_74.png&quot; alt=&quot;clearingexample&quot; /&gt;&lt;/p&gt;

&lt;p&gt;$N^{-1} \sum_{i=1}^N x_i^{(v)}$를 $\bar{x}^{(v)}$로 쓰면, 아래와 같다.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/jalal/Lecture12_78.png&quot; alt=&quot;clearingexample&quot; /&gt;&lt;/p&gt;

&lt;p&gt;이 식들을 적절히 결합하면, 최종적으로 $z$가 사라진 아래와 같은 알고리즘을 얻는다.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/jalal/Lecture12_84.png&quot; alt=&quot;clearingexample&quot; /&gt;&lt;/p&gt;

&lt;p&gt;즉 $v$번째 iteration에서 각 $x_i^{(v)}$는, $v-1$번째 iteration에서의 $x_i^{(v-1)}$들의 평균 $\bar{x}^{(v-1)}$ 으로부터 멀어질수록 penalty를 가하는 목적함수에 의해 결정된다. 이 penalty가 zero가 되는 시점은 모든 $x_i^{(v)}$들이 같아질 때, 즉 consensus를 이룰 때이다. (이러한 방법을 progressive hedging이라고도 한다.)&lt;/p&gt;

&lt;p&gt;Consensus ADMM은 stochastic market clearing에서 하루전 시장에서의 급전변수들을 결정할 때, 전력 네트워크에 여러 개의 node들이 있을 때 각 node 개별의 ‘distributed optimal power flow’ 문제들로 나눌 때 쓸 수 있다.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/jalal/Lecture12_91.png&quot; alt=&quot;clearingexample&quot; /&gt;&lt;/p&gt;

&lt;div class=&quot;notice--info&quot;&gt;

Advanced Optimization and Game Theory for Energy Systems 강의 요약&lt;br /&gt;&lt;br /&gt;

01) &lt;a href=&quot;/jalalone.html&quot;&gt; Market clearing as an optimization problem&lt;/a&gt; &lt;br /&gt;
02) &lt;a href=&quot;/jalaltwo.html&quot;&gt; Market clearing as an equilibrium problem&lt;/a&gt; &lt;br /&gt;
03) &lt;a href=&quot;/jalalthree.html&quot;&gt; Desirable properties of market-clearing mechanisms&lt;/a&gt; &lt;br /&gt;
04) Market clearing using a cooperative game approach &lt;br /&gt;
05) &lt;a href=&quot;/jalalfive.html&quot;&gt; Stochastic market clearing&lt;/a&gt; &lt;br /&gt;
06) &lt;a href=&quot;/jalalsix.html&quot;&gt; Robust approaches for market clearing&lt;/a&gt; &lt;br /&gt;
07) &lt;a href=&quot;/jalalseven.html&quot;&gt; Bilevel programming in energy systems&lt;/a&gt; &lt;br /&gt;
08) &lt;a href=&quot;/jalalgeight.html&quot;&gt; Optimization problems with decomposable structure&lt;/a&gt; &lt;br /&gt;
09) &lt;a href=&quot;/jalalgnine.html&quot;&gt; Benders’ decomposition: Theory&lt;/a&gt; &lt;br /&gt;
10) &lt;a href=&quot;/jalalten.html&quot;&gt; Benders’ decomposition: Applications&lt;/a&gt; &lt;br /&gt;
11) &lt;a href=&quot;/jalaleleven.html&quot;&gt; Augmented Lagrangian relaxation&lt;/a&gt; &lt;br /&gt;
12) &lt;b&gt; Variants of ADMM and applications&lt;/b&gt;
&lt;/div&gt;
</description>
        <pubDate>Sun, 03 Sep 2023 00:00:00 +0900</pubDate>
        <link>https://song4energyndata.github.io/jalaltwelve.html</link>
        <guid isPermaLink="true">https://song4energyndata.github.io/jalaltwelve.html</guid>
        
        <category>최적화</category>
        
        <category>게임이론</category>
        
        <category>에너지시스템</category>
        
        
        <category>market</category>
        
      </item>
    
      <item>
        <title>에너지시스템 최적화/게임이론 강의: 11) (Augmented) Lagrangian relaxation</title>
        <description>&lt;p&gt;이 포스팅은, Technical University of Denmark의 박사과정 과목 “Advanced Optimization and Game Theory for Energy Systems” (Prof. Jalal Kazempour) 의 11강을 필자가 요약한 내용이다.&lt;/p&gt;

&lt;!-- Courtesy of embedresponsively.com --&gt;

&lt;div class=&quot;responsive-video-container&quot;&gt;
    &lt;iframe src=&quot;https://www.youtube-nocookie.com/embed/MWPJAl84Sac&quot; frameborder=&quot;0&quot; webkitallowfullscreen=&quot;&quot; mozallowfullscreen=&quot;&quot; allowfullscreen=&quot;&quot;&gt;&lt;/iframe&gt;
  &lt;/div&gt;

&lt;p&gt;(&lt;a href=&quot;https://www.jalalkazempour.com/teaching&quot;&gt;Course slides 링크&lt;/a&gt;)&lt;/p&gt;

&lt;h2 id=&quot;complicating-constraint가-있을-경우의-lagrangian-relaxation-lr&quot;&gt;Complicating constraint가 있을 경우의 Lagrangian Relaxation (LR)&lt;/h2&gt;

&lt;p&gt;에너지시스템 최적화 문제에서는 수요-공급 일치 조건, ramping limit 조건, 두 지역을 잇는 송전선 관련 조건 등이, ‘여러 소문제들의 변수들을 포함하는’ complicating constraint로써 포함되곤 한다. 해당 제약을 relax해서 큰 문제 대신 작은 subproblem들을 풀 수 있다.&lt;/p&gt;

&lt;p&gt;(이를테면 여러 지역을 잇는 송전 제약을 relax하면, 각 지역 별 market clearing problem을 따로 푸는 문제로 변환될 수 있다.)&lt;/p&gt;

&lt;p&gt;핵심은, 아래와 같이 complicating constraint들을 dual variable을 곱한 term으로 목적함수에 포함시키는 것, 그리고 dual variable들을 특정 값으로 고정하는 것이다.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/jalal/Lecture11_20.png&quot; alt=&quot;clearingexample&quot; /&gt;
&lt;img src=&quot;/assets/images/jalal/Lecture11_24.png&quot; alt=&quot;clearingexample&quot; /&gt;
&lt;img src=&quot;/assets/images/jalal/Lecture11_28.png&quot; alt=&quot;clearingexample&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Complicating constraint가 아닌 constraint는 그대로 두고 complicating constraint들만을 목적함수에 포함시키므로, 이는 ‘partial’ Lagrangian으로 볼 수 있다. 그래서 이 기법의 이름이 Lagrangian Relaxation (LR) 이다.&lt;/p&gt;

&lt;p&gt;Dual variable의 값을 고정함으로써, 위 예시 기준으로 각 $i$별 subproblem들이 구성된다. 단, 해당 고정값이 최적의 값인지 모르므로, iteration을 통해 최적의 값에 가까워지게 해야 한다.&lt;/p&gt;

&lt;p&gt;간단한 예시는 아래와 같다.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/jalal/Lecture11_34.png&quot; alt=&quot;clearingexample&quot; /&gt;
&lt;img src=&quot;/assets/images/jalal/Lecture11_35.png&quot; alt=&quot;clearingexample&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Complicating constraint $-x-y+4=0$에 dual variable $\mu$를 곱한 값을 목적함수에 더한 후 $\mu$의 값을 $\bar{\mu}$로 고정 후 $x$와 $y$ 각각에 대한 subproblem을 푼다. 그 결과 얻은 variable들의 값들 $x^{(v)}$와 $y^{(v)}$에 기반해 $\bar{\mu}$를 업데이트한다.&lt;/p&gt;

&lt;p&gt;이 때 $a$와 $b$는 일종의 hyperparameter로, 그 값에 따라 수렴 속도 및 안정성이 달라진다. (Bender’s decomposition에서는 이런 hyperparamter가 없었다. 그래서 필자가 보기엔 LR은 약간은 ‘learning’ 요소가 있는 기법이다.)&lt;/p&gt;

&lt;h2 id=&quot;목적함수가-linear-function일-때의-augmented-lr&quot;&gt;목적함수가 linear function일 때의 ‘Augmented’ LR&lt;/h2&gt;

&lt;p&gt;주의할 점은, LR을 그대로 쓰려면 목적함수의 first derivative가 연속함수여야 한다는 것이다. 이 연속함수는 상수함수를 포함하지 않는다. 따라서 위 예제처럼 목적함수가 quadratic function인 경우 LR을 쓸 수 있지만, 만약 목적함수가 linear function이라면 LR을 쓸 수 없다 (정확히는 쓰더라도 수렴이 보장되지 않는다).&lt;/p&gt;

&lt;p&gt;목적함수가 linear function이지만 complicating constraint를 relax해 subproblem들로 쪼개고 싶은 경우 쓸 수 있는 방법으로, ‘Augmented’ Lagrangian Relaxation (ALR) 이 있다.&lt;/p&gt;

&lt;p&gt;ALR에서는 목적함수를 확실하게 quadratic function으로 만들기 위해, complicating constraint의 제곱항을 추가한다. 예시는 아래와 같다.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/jalal/Lecture11_41.png&quot; alt=&quot;clearingexample&quot; /&gt;&lt;/p&gt;

&lt;p&gt;(위 예시에서 목적함수가 이미 quadratic이므로 굳이 ALR을 쓸 필요가 없지만, 이해를 돕기 위해 앞의 LR 예시와 같은 예시로 설명하였다.)&lt;/p&gt;

&lt;p&gt;어차피 optimal point에서는 $-x-y+4=0$이므로, 위 항을 추가해도 여전히 같은 문제를 푸는 셈이다. 위 식에서 $\gamma$는 regularization hyperparameter로 볼 수 있다.&lt;/p&gt;

&lt;p&gt;단, 위 문제에서는 $\lambda$를 고정시키더라도 $x$와 $y$ 각각의 subproblem으로 쪼갤 수 없다. $(-x-y+4)^2$ 가 $xy$, 즉 product term을 포함하기 때문이다.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/jalal/Lecture11_43.png&quot; alt=&quot;clearingexample&quot; /&gt;&lt;/p&gt;

&lt;h2 id=&quot;alternating-direction-method-of-multipliers-admm&quot;&gt;Alternating Direction Method of Multipliers (ADMM)&lt;/h2&gt;

&lt;p&gt;Product term 때문에 문제를 쪼갤 수 없다면, 차선책은 product term에 있는 변수 중 하나를 고정시키고 나머지 변수에 대한 문제를 푸는 것이다. 이러한 방법을 alternating direction method of multipliers (ADMM) 이라 한다.&lt;/p&gt;

&lt;p&gt;위 예시에 ADMM을 적용하는 과정은 아래와 같다.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/jalal/Lecture11_55.png&quot; alt=&quot;clearingexample&quot; /&gt;&lt;/p&gt;

&lt;p&gt;여기서 윗첨자가 $(v)$인 항들이 변수이고, 윗첨자가 $(v-1)$인 항들은 parameter들이다 (이전 iteration에서 구한 값들). Optimal point에서는 $-x-y+4=0$ 이므로, $\lambda^{(v)} \approx \lambda^{(v-1)}$ 이면 optimal point에 수렴한 것으로 본다.&lt;/p&gt;

&lt;p&gt;$\gamma$가 일종의 learing rate 역할을 하므로, 이를 너무 크거나 작지 않게 적절히 결정해 주어야 한다.&lt;/p&gt;

&lt;div class=&quot;notice--info&quot;&gt;

Advanced Optimization and Game Theory for Energy Systems 강의 요약&lt;br /&gt;&lt;br /&gt;

01) &lt;a href=&quot;/jalalone.html&quot;&gt; Market clearing as an optimization problem&lt;/a&gt; &lt;br /&gt;
02) &lt;a href=&quot;/jalaltwo.html&quot;&gt; Market clearing as an equilibrium problem&lt;/a&gt; &lt;br /&gt;
03) &lt;a href=&quot;/jalalthree.html&quot;&gt; Desirable properties of market-clearing mechanisms&lt;/a&gt; &lt;br /&gt;
04) Market clearing using a cooperative game approach &lt;br /&gt;
05) &lt;a href=&quot;/jalalfive.html&quot;&gt; Stochastic market clearing&lt;/a&gt; &lt;br /&gt;
06) &lt;a href=&quot;/jalalsix.html&quot;&gt; Robust approaches for market clearing&lt;/a&gt; &lt;br /&gt;
07) &lt;a href=&quot;/jalalseven.html&quot;&gt; Bilevel programming in energy systems&lt;/a&gt; &lt;br /&gt;
08) &lt;a href=&quot;/jalalgeight.html&quot;&gt; Optimization problems with decomposable structure&lt;/a&gt; &lt;br /&gt;
09) &lt;a href=&quot;/jalalgnine.html&quot;&gt; Benders’ decomposition: Theory&lt;/a&gt; &lt;br /&gt;
10) &lt;a href=&quot;/jalalten.html&quot;&gt; Benders’ decomposition: Applications&lt;/a&gt; &lt;br /&gt;
11) &lt;b&gt; Augmented Lagrangian relaxation&lt;/b&gt; &lt;br /&gt;
12) &lt;a href=&quot;/jalaltwelve.html&quot;&gt; Variants of ADMM and applications&lt;/a&gt;
&lt;/div&gt;
</description>
        <pubDate>Sat, 02 Sep 2023 00:00:00 +0900</pubDate>
        <link>https://song4energyndata.github.io/jalaleleven.html</link>
        <guid isPermaLink="true">https://song4energyndata.github.io/jalaleleven.html</guid>
        
        <category>최적화</category>
        
        <category>게임이론</category>
        
        <category>에너지시스템</category>
        
        
        <category>market</category>
        
      </item>
    
  </channel>
</rss>
