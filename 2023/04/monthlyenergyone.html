<!doctype html>
<!--
  Minimal Mistakes Jekyll Theme 4.24.0 by Michael Rose
  Copyright 2013-2020 Michael Rose - mademistakes.com | @mmistakes
  Free for personal and commercial use under the MIT license
  https://github.com/mmistakes/minimal-mistakes/blob/master/LICENSE
-->
<html lang="ko" class="no-js">

<head>
  <meta charset="utf-8">

<!-- begin _includes/seo.html --><title>ê±´ì¶•ë¬¼ ë³„ ì›”ë³„ ì—ë„ˆì§€ ì‚¬ìš©ëŸ‰ ë°ì´í„°ì…‹ - 1) ëª¨ë“  ì›”ì— ëŒ€í•œ í†µí•© ë° í‘œì œë¶€ì™€ì˜ ê²°í•© í›„ SQLite DBí™” | A test page</title>
<meta name="description" content="í•„ìì—ê²Œ ìˆì–´ ê°ë³„í•œ ë°ì´í„°ì…‹ì´ ìˆë‹¤. (ë¹„ì£¼ê±°ìš©) ê±´ì¶•ë¬¼ ë³„ ì›”ë³„ ì—ë„ˆì§€ ì‚¬ìš©ëŸ‰ ë°ì´í„°ì…‹ì´ë‹¤. ê°ì§€ë²ˆ ì£¼ì†Œ ë‹¨ìœ„ì˜ ê°œë³„ ë¹„ì£¼ê±°ìš© ê±´ë¬¼ë³„ë¡œ íŠ¹ì • ì›”ì— ì†Œë¹„í•œ ì „ê¸°ì™€ ê°€ìŠ¤ì˜ ì–‘ì„ kWh ë‹¨ìœ„ë¡œ ê¸°ë¡í•œ ë°ì´í„°ì…‹ì´ë‹¤.">


  <meta name="author" content="Jeonghun Song">
  
  <meta property="article:author" content="Jeonghun Song">
  


<meta property="og:type" content="article">
<meta property="og:locale" content="ko_KR">
<meta property="og:site_name" content="A test page">
<meta property="og:title" content="ê±´ì¶•ë¬¼ ë³„ ì›”ë³„ ì—ë„ˆì§€ ì‚¬ìš©ëŸ‰ ë°ì´í„°ì…‹ - 1) ëª¨ë“  ì›”ì— ëŒ€í•œ í†µí•© ë° í‘œì œë¶€ì™€ì˜ ê²°í•© í›„ SQLite DBí™”">
<meta property="og:url" content="http://localhost:4000/2023/04/monthlyenergyone.html">


  <meta property="og:description" content="í•„ìì—ê²Œ ìˆì–´ ê°ë³„í•œ ë°ì´í„°ì…‹ì´ ìˆë‹¤. (ë¹„ì£¼ê±°ìš©) ê±´ì¶•ë¬¼ ë³„ ì›”ë³„ ì—ë„ˆì§€ ì‚¬ìš©ëŸ‰ ë°ì´í„°ì…‹ì´ë‹¤. ê°ì§€ë²ˆ ì£¼ì†Œ ë‹¨ìœ„ì˜ ê°œë³„ ë¹„ì£¼ê±°ìš© ê±´ë¬¼ë³„ë¡œ íŠ¹ì • ì›”ì— ì†Œë¹„í•œ ì „ê¸°ì™€ ê°€ìŠ¤ì˜ ì–‘ì„ kWh ë‹¨ìœ„ë¡œ ê¸°ë¡í•œ ë°ì´í„°ì…‹ì´ë‹¤.">







  <meta property="article:published_time" content="2023-04-20T00:00:00+09:00">





  

  


<link rel="canonical" href="http://localhost:4000/2023/04/monthlyenergyone.html">




<script type="application/ld+json">
  {
    "@context": "https://schema.org",
    
      "@type": "Person",
      "name": "Jeonghun Song",
      "url": "http://localhost:4000/"
    
  }
</script>







<!-- end _includes/seo.html -->



  <link href="/feed.xml" type="application/atom+xml" rel="alternate" title="A test page Feed">


<!-- https://t.co/dKP3o1e -->
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script>
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
</script>

<!-- For all browsers -->
<link rel="stylesheet" href="/assets/css/main.css">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5/css/all.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
<noscript><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5/css/all.min.css"></noscript>



  <!-- start custom head snippets -->

<!-- insert favicons. use https://realfavicongenerator.net/ -->

<head>
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="manifest" href="/site.webmanifest">
    <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="theme-color" content="#ffffff">
</head>


<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        TeX: {
          equationNumbers: {
            autoNumber: "AMS"
          }
        },
        tex2jax: {
        inlineMath: [ ['$', '$'] ],
        displayMath: [ ['$$', '$$'] ],
        processEscapes: true,
      }
    });
    MathJax.Hub.Register.MessageHook("Math Processing Error",function (message) {
          alert("Math Processing Error: "+message[1]);
        });
    MathJax.Hub.Register.MessageHook("TeX Jax - parse error",function (message) {
          alert("Math Processing Error: "+message[1]);
        });
    </script>
<script type="text/javascript" async src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-MML-AM_CHTML">
</script>


<!-- end custom head snippets -->
</head>

<body
  class="layout--single">
  <nav class="skip-links">
  <ul>
    <li><a href="#site-nav" class="screen-reader-shortcut">Skip to primary navigation</a></li>
    <li><a href="#main" class="screen-reader-shortcut">Skip to content</a></li>
    <li><a href="#footer" class="screen-reader-shortcut">Skip to footer</a></li>
  </ul>
</nav>

  

<div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      <nav id="site-nav" class="greedy-nav">
        
          <a class="site-logo" href="/"><img src="/assets/images/logo.png" alt="A test page"></a>
        
        <a class="site-title" href="/">
          A test page
          <span class="site-subtitle">learning Github Page</span>
        </a>
        <ul class="visible-links"><li class="masthead__menu-item">
              <a href="/aboutme/">About Me</a>
            </li><li class="masthead__menu-item">
              <a href="/search/">Search</a>
            </li><li class="masthead__menu-item">
              <a href="/categories/">Category</a>
            </li><li class="masthead__menu-item">
              <a href="/tags/">Tag</a>
            </li></ul>
        
        <button class="greedy-nav__toggle hidden" type="button">
          <span class="visually-hidden">ì¹´í…Œê³ ë¦¬ ëª©ë¡</span>
          <div class="navicon"></div>
        </button>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>


  <div class="initial-content">
    




  
    



<nav class="breadcrumbs">
  <ol itemscope itemtype="https://schema.org/BreadcrumbList">
    
    
    
      
        <li itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem">
          <a href="/" itemprop="item"><span itemprop="name">Home</span></a>

          <meta itemprop="position" content="1" />
        </li>
        <span class="sep">/</span>
      
      
        
        <li itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem">
          <a href="/categories/#2023" itemprop="item"><span itemprop="name">2023</span></a>
          <meta itemprop="position" content="2" />
        </li>
        <span class="sep">/</span>
      
    
      
      
        
        <li itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem">
          <a href="/categories/#04" itemprop="item"><span itemprop="name">04</span></a>
          <meta itemprop="position" content="3" />
        </li>
        <span class="sep">/</span>
      
    
      
      
        <li class="current">ê±´ì¶•ë¬¼ ë³„ ì›”ë³„ ì—ë„ˆì§€ ì‚¬ìš©ëŸ‰ ë°ì´í„°ì…‹ - 1) ëª¨ë“  ì›”ì— ëŒ€í•œ í†µí•© ë° í‘œì œë¶€ì™€ì˜ ê²°í•© í›„ SQLite DBí™”</li>
      
    
  </ol>
</nav>

  


<div id="main" role="main">
  

  <div class="sidebar sticky">
    
  
  
  
  
    
    
      
    
    
  
  
   <!-- three lines added by Jeonghun  -->
    

<nav class="nav__list">
  <input id="ac-toc" name="accordion-toc" type="checkbox" />
  <label for="ac-toc">ì¹´í…Œê³ ë¦¬ ëª©ë¡</label>
  <ul class="nav__items" id="category_tag_menu">
      <!--ì „ì²´ ê¸€ ìˆ˜-->
      <li>
            ğŸ“‚ <span style="font-family:'Cafe24Oneprettynight';">ì „ì²´ ê¸€ ìˆ˜</style> <span style="font-family:'Coming Soon';">24</style> <span style="font-family:'Cafe24Oneprettynight';">ê°œ</style> 
      </li>
      <li>
        <!--span íƒœê·¸ë¡œ ì¹´í…Œê³ ë¦¬ë“¤ì„ í¬ê²Œ ë¶„ë¥˜ ex) C/C++/C#-->
        <span class="nav__sub-title">ë²”ì£¼1</span>
            <!--ul íƒœê·¸ë¡œ ê°™ì€ ì¹´í…Œê³ ë¦¬ë“¤ ëª¨ì•„ë‘” í˜ì´ì§€ë“¤ ë‚˜ì—´-->
            <ul>
                <!--Cpp ì¹´í…Œê³ ë¦¬ ê¸€ë“¤ì„ ëª¨ì•„ë‘” í˜ì´ì§€ì¸ /categories/cpp ì£¼ì†Œì˜ ê¸€ë¡œ ë§í¬ ì—°ê²°-->
                <!--category[1].size ë¡œ í•´ë‹¹ ì¹´í…Œê³ ë¦¬ë¥¼ ê°€ì§„ ê¸€ì˜ ê°œìˆ˜ í‘œì‹œ--> 
                
                    
                
                    
                
                    
                        <li><a href="/code" class="">ì½”ë“œ (1)</a></li>
                    
                
                    
                
                    
                
            </ul>
            <ul>
                
                    
                
                    
                        <li><a href="/theory" class="">ì´ë¡  (2)</a></li>
                    
                
                    
                
                    
                
                    
                
            </ul>
            <ul>
                
                    
                
                    
                
                    
                
                    
                
                    
                        <li><a href="/energy" class="">ì—ë„ˆì§€ (17)</a></li>
                    
                
            </ul>
        <span class="nav__sub-title">ë²”ì£¼2</span>
            <ul>
                
                    
                
                    
                
                    
                
                    
                        <li><a href="/project" class="">í”„ë¡œì íŠ¸ (1)</a></li>
                    
                
                    
                
            </ul>
            <ul>
                
                    
                        <li><a href="/etc" class="">ê¸°íƒ€ (3)</a></li>
                    
                
                    
                
                    
                
                    
                
                    
                
            </ul>
      </li>
  </ul>
</nav>
  
  

  </div>




  <article class="page h-entry" itemscope itemtype="https://schema.org/CreativeWork">
    <meta itemprop="headline" content="ê±´ì¶•ë¬¼ ë³„ ì›”ë³„ ì—ë„ˆì§€ ì‚¬ìš©ëŸ‰ ë°ì´í„°ì…‹ - 1) ëª¨ë“  ì›”ì— ëŒ€í•œ í†µí•© ë° í‘œì œë¶€ì™€ì˜ ê²°í•© í›„ SQLite DBí™”">
    <meta itemprop="description" content="í•„ìì—ê²Œ ìˆì–´ ê°ë³„í•œ ë°ì´í„°ì…‹ì´ ìˆë‹¤. (ë¹„ì£¼ê±°ìš©) ê±´ì¶•ë¬¼ ë³„ ì›”ë³„ ì—ë„ˆì§€ ì‚¬ìš©ëŸ‰ ë°ì´í„°ì…‹ì´ë‹¤. ê°ì§€ë²ˆ ì£¼ì†Œ ë‹¨ìœ„ì˜ ê°œë³„ ë¹„ì£¼ê±°ìš© ê±´ë¬¼ë³„ë¡œ íŠ¹ì • ì›”ì— ì†Œë¹„í•œ ì „ê¸°ì™€ ê°€ìŠ¤ì˜ ì–‘ì„ kWh ë‹¨ìœ„ë¡œ ê¸°ë¡í•œ ë°ì´í„°ì…‹ì´ë‹¤.">
    <meta itemprop="datePublished" content="2023-04-20T00:00:00+09:00">
    

    <div class="page__inner-wrap">
      
        <header>
          <h1 id="page-title" class="page__title p-name" itemprop="headline">
            <a href="http://localhost:4000/2023/04/monthlyenergyone.html" class="u-url" itemprop="url">ê±´ì¶•ë¬¼ ë³„ ì›”ë³„ ì—ë„ˆì§€ ì‚¬ìš©ëŸ‰ ë°ì´í„°ì…‹ - 1) ëª¨ë“  ì›”ì— ëŒ€í•œ í†µí•© ë° í‘œì œë¶€ì™€ì˜ ê²°í•© í›„ SQLite DBí™”
</a>
          </h1>
          

  <p class="page__meta">
    
      
      <span class="page__meta-date">
        <i class="far fa-calendar-alt" aria-hidden="true"></i>
        
        <time datetime="2023-04-20T00:00:00+09:00">2023-04-20</time>
      </span>
    

    

    
  </p>


        </header>
      

      <section class="page__content e-content" itemprop="text">
        
          <aside class="sidebar__right sticky">
            <nav class="toc">
              <header><h4 class="nav__title"><i class="fas fa-file-alt"></i> Contents</h4></header> 
              
 <!-- ìš°ì¸¡ TOC -->
            </nav>
          </aside>
        
        <p>í•„ìì—ê²Œ ìˆì–´ ê°ë³„í•œ ë°ì´í„°ì…‹ì´ ìˆë‹¤. (ë¹„ì£¼ê±°ìš©) ê±´ì¶•ë¬¼ ë³„ ì›”ë³„ ì—ë„ˆì§€ ì‚¬ìš©ëŸ‰ ë°ì´í„°ì…‹ì´ë‹¤. ê°ì§€ë²ˆ ì£¼ì†Œ ë‹¨ìœ„ì˜ ê°œë³„ ë¹„ì£¼ê±°ìš© ê±´ë¬¼ë³„ë¡œ íŠ¹ì • ì›”ì— ì†Œë¹„í•œ ì „ê¸°ì™€ ê°€ìŠ¤ì˜ ì–‘ì„ kWh ë‹¨ìœ„ë¡œ ê¸°ë¡í•œ ë°ì´í„°ì…‹ì´ë‹¤.</p>

<p>ì–´ë–¤ ê±´ë¬¼ì˜ 1ë…„ 12ê°œì›” ê°„ ì›”ë³„ ì „ê¸° ì‚¬ìš©ëŸ‰ê³¼ ê°€ìŠ¤ ì‚¬ìš©ëŸ‰ì€, ëŒ€ë¶€ë¶„ ì•„ë˜ ê·¸ë¦¼ê³¼ ê°™ì€ í˜•íƒœë¥¼ ë¤ë‹¤.</p>

<p><img src="/assets/images/monthlyenergyone/typicalpattern.png" alt="typicalpattern" class="align-center" /></p>

<p>ì „ê¸° ì‚¬ìš©ëŸ‰ì€ 7ì›”/ 8ì›” ì¦‰ ì—¬ë¦„ì— í¬ê³ , ê°€ìŠ¤ ì‚¬ìš©ëŸ‰ì€ 1ì›”/ 2ì›”/ 12ì›” ì¦‰ ê²¨ìš¸ì— í° ê±¸ ë³¼ ìˆ˜ ìˆë‹¤.</p>

<p>ì´ëŸ¬í•œ ê°œë³„ ê±´ë¬¼ì˜ ì›”ë³„ ì—ë„ˆì§€ ì‚¬ìš©ëŸ‰ ë°ì´í„°ëŠ”, <a href="https://open.eais.go.kr/main/main.do">êµ­í† êµí†µë¶€ì˜ ê±´ì¶•ë°ì´í„° ë¯¼ê°„ê°œë°© ì‹œìŠ¤í…œ</a>ì—ì„œ ì œê³µí•œë‹¤.</p>

<p><img src="/assets/images/monthlyenergyone/webpage_monthlyenergy.png" alt="webpage_monthlyenergy" class="align-center" /></p>

<p>ê°ê°ì´ ìˆ˜ì‹­(ê°€ìŠ¤)~ìˆ˜ë°±(ì „ê¸°) MBì˜ í…ìŠ¤íŠ¸ íŒŒì¼ì´ë©°, êµ¬ë¶„ìëŠ” $|$ ì´ë‹¤. ì´ë¥¼ ì—‘ì…€ë¡œ ì—´ì–´ë³´ë©´ ì•„ë˜ ê·¸ë¦¼ê³¼ ê°™ë‹¤.</p>

<p><img src="/assets/images/monthlyenergyone/monthly_raw.png" alt="monthly_raw" class="align-center" /></p>

<p>ìœ„ì—ì„œ E~Jì—´ì´ ê±´ë¬¼ ì£¼ì†Œ, Qì—´ì´ ì—ë„ˆì§€ ì‚¬ìš©ëŸ‰ì´ë‹¤.</p>

<p>í•„ìëŠ” ë°•ì‚¬ê³¼ì • ì‹œì ˆì— ìœ„ ë°ì´í„°ì…‹ì„ ì´ìš©í•´ ê³µê³µê±´ì¶•ë¬¼ ì‹ ì¬ìƒì—ë„ˆì§€ ì˜ë¬´í™” ì •ì±…ì´ ë¯¼ê°„ê±´ë¬¼ë¡œê¹Œì§€ í™•ëŒ€ë  ê²½ìš°ì˜ ì˜í–¥ì„ ë¶„ì„í•˜ê³  ë° ë„ì‹œ ë‹¨ìœ„ì˜ ëŒ€ê·œëª¨ ì ìš© ì‹œ ì˜í–¥ì„ ì˜ˆì¸¡í•˜ëŠ” ê¸°ë²•ì— ëŒ€í•œ ì—°êµ¬ë¥¼ ìˆ˜í–‰í•´ ë°•ì‚¬í•™ìœ„ë¥¼ ë°›ì•˜ê³ , ì´ ì—°êµ¬ë¥¼ ì†Œì¬ë¡œ <a href="https://doi.org/10.1016/j.energy.2019.116132">Energy</a>ì™€ <a href="https://doi.org/10.1016/j.apenergy.2020.115489">Applied Energy</a>ì— ë…¼ë¬¸ë„ ê²Œì¬í–ˆë‹¤.</p>

<p>ë˜í•œ ìµœê·¼ì—ëŠ”, ìœ„ ë°ì´í„°ì…‹ì„ ë˜ ì´ìš©í•´ ê°œë³„ ê±´ì¶•ë¬¼ ë‚´ ì›”ë³„ ì—ë„ˆì§€ ì‚¬ìš©ëŸ‰ì˜ ê²°í•©í™•ë¥ ë¶„í¬ë¥¼ ëª¨ë¸ë§í•˜ëŠ” ì—°êµ¬ë¥¼ ìˆ˜í–‰í•˜ê³  ì™¸ë¶€ ë°œí‘œë¥¼ í•˜ê¸°ë„ í–ˆë‹¤ (<a href="https://rnd.gmdsa.org/building-energy-prediction/">MDSA ê¸°ì‚¬ê¸€</a>).</p>

<p><img src="/assets/images/monthlyenergyone/mdsaseminar.png" alt="mdsaseminar" class="align-center" /></p>

<p>ë‹¤ë§Œ, ì´ ë°ì´í„°ì…‹ì„ ì œëŒ€ë¡œ í™œìš©í•˜ë ¤ë©´ ëª‡ ê°€ì§€ ì‚¬ì „ ì‘ì—…ì„ ê±°ì³ì•¼ í–ˆë‹¤. ê° ê±´ì¶•ë¬¼ ì§€ë²ˆ ë³„ ì†ì„± (ê° ê±´ë¬¼ë³„ ì—°ë©´ì / ìš©ë„/ ì¸µìˆ˜/ ê±´ì¶•ì—°ìˆ˜/ ì¬ì§ˆ ë“±) ì •ë³´ë¥¼ ë‹´ì€ ë°ì´í„°ì…‹ì¸ í‘œì œë¶€ì™€ ê²°í•©ì„ í•´ì•¼ í–ˆë‹¤. ê·¸ë¦¬ê³  ëˆ„ë½ ë°ì´í„°, ëª¨ì–‘ì´ ì´ìƒí•œ ë°ì´í„°, outlier ë“±ì„ ì œê±°í•´ì•¼ í–ˆë‹¤.</p>

<p>ì´ë²ˆ í¬ìŠ¤íŒ…ì€ ì—ë„ˆì§€ ì‚¬ìš©ëŸ‰ ë°ì´í„°ì™€ í‘œì œë¶€ë¥¼ Pythonì˜ pandasë¥¼ ì´ìš©í•´ ê²°í•©í•˜ê³  SQL DBë¡œ ì €ì¥í–ˆë˜ ê³¼ì •ì— ëŒ€í•œ ê¸°ë¡ì´ë‹¤.</p>

<p>ì§€ë²ˆë³„ ì›”ë³„ ì—ë„ˆì§€ ì‚¬ìš©ëŸ‰ ë°ì´í„°ëŠ” ê° ì›”ë³„ë¡œ í©ì–´ì ¸ ìˆëŠ”ë°, ë¨¼ì € ê³µí†µëœ ì—°ë„ì˜ ì›”ë³„ ì‚¬ìš©ëŸ‰ ìë£Œë“¤ì„ Pythonì˜ pandasë¥¼ ì´ìš©í•´ í•˜ë‚˜ë¡œ í•©ì³¤ë‹¤. 2022ë…„ì˜ 1~12ì›” ì „ê¸° ì‚¬ìš©ëŸ‰ê³¼ ê°€ìŠ¤ ì‚¬ìš©ëŸ‰ ë°ì´í„°ë“¤ì„ í•˜ë‚˜ë¡œ í•©ì¹˜ëŠ” ì½”ë“œëŠ” ì•„ë˜ì™€ ê°™ë‹¤.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># -*- coding: utf-8 -*-
</span>
<span class="kn">import</span> <span class="n">pandas</span> <span class="k">as</span> <span class="n">pd</span>
<span class="kn">import</span> <span class="n">settings</span>

<span class="n">filelist</span> <span class="o">=</span> <span class="p">[</span><span class="s">'elec_202201'</span><span class="p">,</span><span class="s">'elec_202202'</span><span class="p">,</span><span class="s">'elec_202203'</span><span class="p">,</span><span class="s">'elec_202204'</span><span class="p">,</span><span class="s">'elec_202205'</span><span class="p">,</span><span class="s">'elec_202206'</span><span class="p">,</span><span class="s">'elec_202207'</span><span class="p">,</span><span class="s">'elec_202208'</span><span class="p">,</span><span class="s">'elec_202209'</span><span class="p">,</span><span class="s">'elec_202210'</span><span class="p">,</span><span class="s">'elec_202211'</span><span class="p">,</span><span class="s">'elec_202212'</span><span class="p">,</span>
            <span class="s">'gas_202201'</span><span class="p">,</span><span class="s">'gas_202202'</span><span class="p">,</span><span class="s">'gas_202203'</span><span class="p">,</span><span class="s">'gas_202204'</span><span class="p">,</span><span class="s">'gas_202205'</span><span class="p">,</span><span class="s">'gas_202206'</span><span class="p">,</span><span class="s">'gas_202207'</span><span class="p">,</span><span class="s">'gas_202208'</span><span class="p">,</span><span class="s">'gas_202209'</span><span class="p">,</span><span class="s">'gas_202210'</span><span class="p">,</span><span class="s">'gas_202211'</span><span class="p">,</span><span class="s">'gas_202212'</span><span class="p">]</span>

<span class="n">colname</span> <span class="o">=</span> <span class="p">[</span><span class="s">'useYm'</span><span class="p">,</span><span class="s">'rnum'</span><span class="p">,</span><span class="s">'sigunguCd'</span><span class="p">,</span><span class="s">'bjdongCd'</span><span class="p">,</span><span class="s">'sido'</span><span class="p">,</span><span class="s">'sigungu'</span><span class="p">,</span><span class="s">'bjdong'</span><span class="p">,</span><span class="s">'platGbCd'</span><span class="p">,</span><span class="s">'bun'</span><span class="p">,</span><span class="s">'ji'</span><span class="p">,</span><span class="s">'naRoadCd'</span><span class="p">,</span><span class="s">'naRoad'</span><span class="p">,</span><span class="s">'naUgrndCd'</span><span class="p">,</span><span class="s">'naUgrnd'</span><span class="p">,</span><span class="s">'naMainBun'</span><span class="p">,</span><span class="s">'naSubBun'</span><span class="p">,</span><span class="s">'useQty'</span><span class="p">]</span>

<span class="n">count</span> <span class="o">=</span> <span class="mi">0</span>

<span class="k">for</span> <span class="n">filename</span> <span class="ow">in</span> <span class="n">filelist</span><span class="p">:</span>
    <span class="nf">print</span><span class="p">(</span><span class="n">count</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="nf">read_csv</span><span class="p">(</span><span class="n">settings</span><span class="p">.</span><span class="n">ENERGY_ROOT</span><span class="o">+</span><span class="s">'</span><span class="se">\\</span><span class="s">{}.txt'</span><span class="p">.</span><span class="nf">format</span><span class="p">(</span><span class="n">filename</span><span class="p">),</span><span class="n">sep</span><span class="o">=</span><span class="s">'|'</span><span class="p">,</span><span class="n">header</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span><span class="n">names</span><span class="o">=</span><span class="n">colname</span><span class="p">,</span><span class="n">encoding</span><span class="o">=</span><span class="s">'cp949'</span><span class="p">,)</span>
    
    <span class="n">df_temp</span><span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="nc">DataFrame</span><span class="p">()</span>
    
    <span class="n">df_temp</span><span class="p">[</span><span class="s">'address'</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s">'sido'</span><span class="p">].</span><span class="nf">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span> <span class="o">+</span><span class="s">" "</span><span class="o">+</span> <span class="n">data</span><span class="p">[</span><span class="s">'sigungu'</span><span class="p">].</span><span class="nf">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span> <span class="o">+</span><span class="s">" "</span><span class="o">+</span> <span class="n">data</span><span class="p">[</span><span class="s">"bjdong"</span><span class="p">].</span><span class="nf">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span> <span class="o">+</span><span class="s">" "</span><span class="o">+</span> <span class="n">data</span><span class="p">[</span><span class="s">"bun"</span><span class="p">].</span><span class="nf">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span> <span class="o">+</span><span class="s">"-"</span><span class="o">+</span> <span class="n">data</span><span class="p">[</span><span class="s">"ji"</span><span class="p">].</span><span class="nf">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span><span class="o">+</span><span class="s">"ë²ˆì§€|"</span><span class="o">+</span><span class="n">data</span><span class="p">[</span><span class="s">'sigunguCd'</span><span class="p">].</span><span class="nf">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span><span class="o">+</span><span class="s">"|"</span><span class="o">+</span><span class="n">data</span><span class="p">[</span><span class="s">'bjdongCd'</span><span class="p">].</span><span class="nf">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span><span class="o">+</span><span class="s">"|"</span><span class="o">+</span><span class="n">data</span><span class="p">[</span><span class="s">'bun'</span><span class="p">].</span><span class="nf">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span><span class="o">+</span><span class="s">"|"</span><span class="o">+</span><span class="n">data</span><span class="p">[</span><span class="s">'ji'</span><span class="p">].</span><span class="nf">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span> <span class="c1"># í•œ ê°œ columnë§Œì„ outer join ê¸°ì¤€ìœ¼ë¡œ í•˜ê¸° ìœ„í•´ ì½”ë“œê¹Œì§€ ê°™ì´ ë„£ìŒ
</span>    <span class="n">df_temp</span><span class="p">[</span><span class="s">'address'</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_temp</span><span class="p">[</span><span class="s">'address'</span><span class="p">].</span><span class="nb">str</span><span class="p">.</span><span class="nf">replace</span><span class="p">(</span><span class="s">'-0'</span><span class="p">,</span><span class="s">''</span><span class="p">)</span> <span class="c1"># jiê°€ 0ì¸ ê²½ìš° ë°ì´í„°ì—ëŠ” 0ìœ¼ë¡œ ë˜ì–´ ìˆìœ¼ë‚˜, ì£¼ì†Œì— -0 ì´ ë‚˜íƒ€ë‚˜ì§€ ì•Šê²Œë”
</span>    <span class="n">df_temp</span><span class="p">[</span><span class="s">'{}'</span><span class="p">.</span><span class="nf">format</span><span class="p">(</span><span class="n">filename</span><span class="p">)]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s">'useQty'</span><span class="p">]</span>
    <span class="n">df_temp</span> <span class="o">=</span> <span class="n">df_temp</span><span class="p">.</span><span class="nf">drop_duplicates</span><span class="p">([</span><span class="s">'address'</span><span class="p">])</span>  <span class="c1"># ì£¼ì†Œê°€ ì¤‘ë³µì¸ í•­ë“¤ì€ ì „ë¶€ ì œê±° (ì¤‘ë³µì¸ í•­ë“¤ì€ ì—ë„ˆì§€ ì‚¬ìš©ëŸ‰ì´ ëª¨ë‘ ë™ì¼ ìˆ˜ì¹˜ì¸ ê²ƒ í™•ì¸í•¨)
</span>        
    <span class="nf">if</span><span class="p">(</span><span class="n">count</span><span class="o">==</span><span class="mi">0</span><span class="p">):</span>
        <span class="n">df</span> <span class="o">=</span> <span class="n">df_temp</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="nf">merge</span><span class="p">(</span><span class="n">left</span> <span class="o">=</span> <span class="n">df</span> <span class="p">,</span> <span class="n">right</span> <span class="o">=</span> <span class="n">df_temp</span><span class="p">,</span> <span class="n">how</span> <span class="o">=</span> <span class="s">"outer"</span><span class="p">,</span> <span class="n">on</span> <span class="o">=</span> <span class="s">"address"</span><span class="p">)</span> <span class="c1"># í•œ ì›”ì— ëŒ€í•´ì„œë¼ë„ ì‚¬ìš©ëŸ‰ ìˆëŠ” ì£¼ì†ŒëŠ” ëª¨ë‘ í¬í•¨í•˜ë¯€ë¡œ outer
</span>    
    <span class="k">del</span> <span class="n">data</span><span class="p">,</span> <span class="n">df_temp</span>
    
    <span class="n">count</span> <span class="o">+=</span> <span class="mi">1</span>
    
<span class="c1"># ëª¨ë“  ì›”ì— ëŒ€í•´ joinë˜ì—ˆìœ¼ë¯€ë¡œ ì£¼ì†Œí…ìŠ¤íŠ¸ì™€ ì£¼ì†Œì½”ë“œë¥¼ ë‚˜ëˆ”    
</span><span class="n">df</span><span class="p">[</span><span class="s">'addresstxt'</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s">'address'</span><span class="p">].</span><span class="nb">str</span><span class="p">.</span><span class="nf">split</span><span class="p">(</span><span class="s">'|'</span><span class="p">).</span><span class="nb">str</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="c1"># í‘œì œë¶€ì—ì„œ ì‚¬ìš©í•˜ëŠ” ì£¼ì†Œ stringê³¼ ê°™ìŒ
</span><span class="n">df</span><span class="p">[</span><span class="s">'sigunguCd'</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s">'address'</span><span class="p">].</span><span class="nb">str</span><span class="p">.</span><span class="nf">split</span><span class="p">(</span><span class="s">'|'</span><span class="p">).</span><span class="nb">str</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">df</span><span class="p">[</span><span class="s">'bjdongCd'</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s">'address'</span><span class="p">].</span><span class="nb">str</span><span class="p">.</span><span class="nf">split</span><span class="p">(</span><span class="s">'|'</span><span class="p">).</span><span class="nb">str</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="n">df</span><span class="p">[</span><span class="s">'bun'</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s">'address'</span><span class="p">].</span><span class="nb">str</span><span class="p">.</span><span class="nf">split</span><span class="p">(</span><span class="s">'|'</span><span class="p">).</span><span class="nb">str</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="n">df</span><span class="p">[</span><span class="s">'ji'</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s">'address'</span><span class="p">].</span><span class="nb">str</span><span class="p">.</span><span class="nf">split</span><span class="p">(</span><span class="s">'|'</span><span class="p">).</span><span class="nb">str</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>

<span class="k">del</span> <span class="n">df</span><span class="p">[</span><span class="s">'address'</span><span class="p">]</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="s">'addresstxt'</span><span class="p">,</span><span class="s">'sigunguCd'</span><span class="p">,</span><span class="s">'bjdongCd'</span><span class="p">,</span><span class="s">'bun'</span><span class="p">,</span><span class="s">'ji'</span><span class="p">,</span><span class="s">'elec_202201'</span><span class="p">,</span><span class="s">'elec_202202'</span><span class="p">,</span><span class="s">'elec_202203'</span><span class="p">,</span><span class="s">'elec_202204'</span><span class="p">,</span><span class="s">'elec_202205'</span><span class="p">,</span><span class="s">'elec_202206'</span><span class="p">,</span><span class="s">'elec_202207'</span><span class="p">,</span><span class="s">'elec_202208'</span><span class="p">,</span><span class="s">'elec_202209'</span><span class="p">,</span><span class="s">'elec_202210'</span><span class="p">,</span><span class="s">'elec_202211'</span><span class="p">,</span><span class="s">'elec_202212'</span><span class="p">,</span><span class="s">'gas_202201'</span><span class="p">,</span><span class="s">'gas_202202'</span><span class="p">,</span><span class="s">'gas_202203'</span><span class="p">,</span><span class="s">'gas_202204'</span><span class="p">,</span><span class="s">'gas_202205'</span><span class="p">,</span><span class="s">'gas_202206'</span><span class="p">,</span><span class="s">'gas_202207'</span><span class="p">,</span><span class="s">'gas_202208'</span><span class="p">,</span><span class="s">'gas_202209'</span><span class="p">,</span><span class="s">'gas_202210'</span><span class="p">,</span><span class="s">'gas_202211'</span><span class="p">,</span><span class="s">'gas_202212'</span><span class="p">]]</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="p">.</span><span class="nf">drop_duplicates</span><span class="p">([</span><span class="s">'addresstxt'</span><span class="p">])</span> <span class="c1"># ì£¼ì†Œê°€ ì¤‘ë³µì¸ í•­ë“¤ì€ ì „ë¶€ ì œê±° (ì¤‘ë³µì¸ í•­ë“¤ì€ ì—ë„ˆì§€ ì‚¬ìš©ëŸ‰ì´ ëª¨ë‘ ë™ì¼ ìˆ˜ì¹˜ì¸ ê²ƒ í™•ì¸í•¨)
</span>    
<span class="n">df</span><span class="p">.</span><span class="nf">to_csv</span><span class="p">(</span><span class="n">settings</span><span class="p">.</span><span class="n">CSV_ROOT</span><span class="o">+</span><span class="s">'</span><span class="se">\\</span><span class="s">monthlyenergy_2022.csv'</span><span class="p">,</span><span class="n">sep</span><span class="o">=</span><span class="s">','</span><span class="p">,</span><span class="n">encoding</span><span class="o">=</span><span class="s">'utf-8-sig'</span><span class="p">)</span>
</code></pre></div></div>

<p>filelistì— ê° íŒŒì¼ëª…ì„ ë¯¸ë¦¬ ì ì–´ë†“ê³ , colnameì— ê° ì—´ ì´ë¦„ì„ ì½”ë“œ ë‚´ì—ì„œ ì–´ë–»ê²Œ ëª…ì‹œí•  ì§€ ì ì–´ë†“ì•˜ë‹¤ (ê° ì—´ì— ëŒ€í•œ ì„¤ëª…ì€, ê°™ì´ ë‹¤ìš´ë°›ì„ ìˆ˜ ìˆëŠ” ë°ì´í„°ì…‹_ì •ì˜ì„œ íŒŒì¼ì— ìˆë‹¤). ê·¸ë¦¬ê³  ëª¨ë“  ë°ì´í„°ë“¤ì„ ë°˜ë³µë¬¸ì„ ì´ìš©í•´ ìˆœì„œëŒ€ë¡œ ë¶ˆëŸ¬ì˜¨ë‹¤.</p>

<p>íŒŒì¼ ë‚´ì— ê±´ë¬¼ ì£¼ì†Œëª…ì´ ê¸°ë³¸ì ìœ¼ë¡œ ì‹œ/êµ¬/ë²ˆ/ì§€ê°€ ìª¼ê°œì ¸ ìˆëŠ”ë°, í‘œì œë¶€ì—ì„œëŠ” ì£¼ì†Œëª…ì´ í•©ì³ì ¸ ìˆìœ¼ë¯€ë¡œ í‘œì œë¶€ ì£¼ì†Œì™€ ê²°í•©í•  ê²ƒì„ ìƒì •í•˜ê³  í‘œì œë¶€ì™€ ê°™ì€ í¬ë§·ì´ ë˜ê²Œ, address ì¹¼ëŸ¼ì„ ìƒˆë¡œ ë§Œë“ ë‹¤. address ê°™ì€ í–‰ë“¤ì€ ì¡°ì‚¬ ê²°ê³¼ ëª¨ë‘ ê°™ì€ ì—ë„ˆì§€ ì‚¬ìš©ëŸ‰ ê°’ë“¤ì„ ê°–ê³  ìˆì–´ì„œ, ë‹¨ìˆœ ì¤‘ë³µìœ¼ë¡œ ê°„ì£¼í•˜ê³  $\texttt{drop_duplicates}$ë¡œ ì‚­ì œí•˜ì˜€ë‹¤.</p>

<p>ì´ë ‡ê²Œ address ì¹¼ëŸ¼ì„ ê° ë°ì´í„°ì…‹ì— ëŒ€í•´ ë§Œë“¤ê³ , ëª¨ë“  ë°ì´í„°ì…‹ì„ address ê¸°ì¤€ìœ¼ë¡œ outer joiní•´ í•©ì¹œ ë°ì´í„°ì…‹ì´ dfê°€ ë˜ë„ë¡ í•˜ì˜€ë‹¤. Outer joinì„ í•œ ì´ìœ ëŠ” í•œ ê°œ ë°ì´í„°ì…‹ì—ë¼ë„ ìˆëŠ” ê±´ë¬¼ì€ ìš°ì„  í¬í•¨ì‹œí‚¤ê¸° ìœ„í•¨ì´ë‹¤. ê·¸ë¦¬ê³  dfì—ì„œ í•„ìš”í•œ ì¹¼ëŸ¼ë“¤ë§Œ ë‚¨ê¸´ í›„ csv íŒŒì¼ë¡œ ì €ì¥í•˜ì˜€ë‹¤. 2022ë…„ì˜ ëª¨ë“  ì›”ì˜ ì „ê¸°/ê°€ìŠ¤ ì‚¬ìš©ëŸ‰ë“¤ì„ í†µí•©í•œ csv íŒŒì¼ì„ ì—´ì–´ë³´ë©´ ì•„ë˜ ê·¸ë¦¼ê³¼ ê°™ë‹¤.</p>

<p><img src="/assets/images/monthlyenergyone/everymonth.png" alt="everymonth" class="align-center" /></p>

<p>ì–´ë–¤ ê±´ë¬¼ë“¤ì€ ê°€ìŠ¤ ì‚¬ìš©ëŸ‰ì´ ëª¨ë“  ì›”ì— ëŒ€í•´ ì—†ëŠ”ë°, ì´ëŠ” í•´ë‹¹ ê±´ë¬¼ì´ ë„ì‹œê°€ìŠ¤ë¥¼ ê³µê¸‰ë°›ì§€ ì•Šê¸° ë•Œë¬¸ì´ë‹¤ (í•´ë‹¹ ê±´ë¬¼ ë‚´ ì¼ë¶€ ë¶€ëŒ€ì‹œì„¤(ìŒì‹ì  ë“±)ì´ LPG ê°€ìŠ¤ë¥¼ ì‚¬ìš©í•˜ê±°ë‚˜ í•  ìˆ˜ëŠ” ìˆë‹¤).</p>

<p>ë‹¤ìŒìœ¼ë¡œ, ëª¨ë“  ì›”ì˜ ì—ë„ˆì§€ ì‚¬ìš©ëŸ‰ í†µí•© ë°ì´í„°ë¥¼ í‘œì œë¶€ì™€ í•©ì¹˜ê³  SQL DBë¡œ ì €ì¥í•œë‹¤.
í‘œì œë¶€ì˜ ìŠ¤í¬ë¦°ìƒ·ì€ ì•„ë˜ì™€ ê°™ë‹¤ (ê±´ì¶•ë°ì´í„° ë¯¼ê°„ê°œë°© ì‹œìŠ¤í…œ ì›¹ì‚¬ì´íŠ¸ì—ì„œ ì§ì ‘ ìº¡ì³í•¨).</p>

<p><img src="/assets/images/monthlyenergyone/pyoje_web_1.png" alt="pyoje_web_1" class="align-center" />
<img src="/assets/images/monthlyenergyone/pyoje_web_2.png" alt="pyoje_web_2" class="align-center" />
<img src="/assets/images/monthlyenergyone/pyoje_web_3.png" alt="pyoje_web_3" class="align-center" /></p>

<p>ëŒ€í•œë¯¼êµ­ ë‚´ ëª¨ë“  ê±´ë¬¼ë“¤ì— ëŒ€í•œ í‘œì œë¶€ë¥¼ í•œ ë²ˆì— ë°›ì„ ìˆ˜ ìˆìœ¼ë©°, ì´ëŠ” ìˆ˜ GBì˜ í…ìŠ¤íŠ¸ íŒŒì¼ì´ë‹¤. ê° ì—´ì˜ ì„¤ëª…ì€ ê°™ì´ ë‹¤ìš´ë°›ì„ ìˆ˜ ìˆëŠ” ë°ì´í„°êµ¬ì¡° íŒŒì¼ì— ìˆë‹¤ (ê·¸ëŸ°ë° ì‹¤ì œ ë°ì´í„°ì˜ ìˆœì„œì™€ ë‹¤ë¥¸ ê²½ìš°ë„ ìˆì–´ì„œ, ê²°êµ­ ì§ì ‘ í™•ì¸í•´ì•¼ í–ˆë‹¤â€¦). ì´ íŒŒì¼ì˜ í‘œì œë¶€ ë°ì´í„°ë¥¼ ìœ„ì—ì„œ ë§Œë“  csv íŒŒì¼ ë‚´ ì—ë„ˆì§€ ì‚¬ìš©ëŸ‰ ë°ì´í„°ì™€ í•©ì¹˜ê³  SQL DBë¡œ ì €ì¥í•˜ëŠ” ì½”ë“œëŠ” ì•„ë˜ì™€ ê°™ë‹¤.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># -*- coding: utf-8 -*-
</span>
<span class="kn">import</span> <span class="n">pandas</span> <span class="k">as</span> <span class="n">pd</span>
<span class="kn">import</span> <span class="n">settings</span>

<span class="c1"># ê° columnì˜ ì˜ë¯¸ëŠ” pyojedata í´ë”ì˜ ë°ì´í„°êµ¬ì¡°.xls ì°¸ê³ 
</span><span class="n">colname</span> <span class="o">=</span> <span class="p">[</span><span class="s">'column_01'</span><span class="p">,</span> <span class="s">'column_02'</span><span class="p">,</span> <span class="s">'column_03'</span><span class="p">,</span> <span class="s">'column_04'</span><span class="p">,</span> <span class="s">'column_05'</span><span class="p">,</span> <span class="s">'addresstxt'</span><span class="p">,</span> <span class="s">'column_07'</span><span class="p">,</span> <span class="s">'bldgname'</span><span class="p">,</span> <span class="s">'sigunguCd'</span><span class="p">,</span> <span class="s">'bjdongCd'</span><span class="p">,</span> <span class="s">'column_11'</span><span class="p">,</span> <span class="s">'bun'</span><span class="p">,</span> <span class="s">'ji'</span><span class="p">,</span> <span class="s">'column_14'</span><span class="p">,</span> <span class="s">'column_15'</span><span class="p">,</span> <span class="s">'column_16'</span><span class="p">,</span> <span class="s">'column_17'</span><span class="p">,</span> <span class="s">'column_18'</span><span class="p">,</span> <span class="s">'column_19'</span><span class="p">,</span> <span class="s">'column_20'</span><span class="p">,</span> <span class="s">'column_21'</span><span class="p">,</span> <span class="s">'column_22'</span><span class="p">,</span> <span class="s">'column_23'</span><span class="p">,</span> <span class="s">'column_24'</span><span class="p">,</span> <span class="s">'column_25'</span><span class="p">,</span> <span class="s">'sitearea'</span><span class="p">,</span> <span class="s">'buildingarea'</span><span class="p">,</span> <span class="s">'coverageratio'</span><span class="p">,</span> <span class="s">'floorarea'</span><span class="p">,</span> <span class="s">'netfloorarea'</span><span class="p">,</span> <span class="s">'voltolotratio'</span><span class="p">,</span> <span class="s">'structureCd'</span><span class="p">,</span> <span class="s">'structure'</span><span class="p">,</span> <span class="s">'structuresub'</span><span class="p">,</span> <span class="s">'principaluseCd'</span><span class="p">,</span> <span class="s">'principaluse'</span><span class="p">,</span> <span class="s">'subuse'</span><span class="p">,</span> <span class="s">'roofCd'</span><span class="p">,</span> <span class="s">'roof'</span><span class="p">,</span> <span class="s">'roofsub'</span><span class="p">,</span> <span class="s">'num_household'</span><span class="p">,</span> <span class="s">'num_gagu'</span><span class="p">,</span> <span class="s">'column_43'</span><span class="p">,</span> <span class="s">'num_level'</span><span class="p">,</span> <span class="s">'num_level_below'</span><span class="p">,</span> <span class="s">'column_46'</span><span class="p">,</span> <span class="s">'column_47'</span><span class="p">,</span> <span class="s">'column_48'</span><span class="p">,</span> <span class="s">'column_49'</span><span class="p">,</span> <span class="s">'totalfloorarea'</span><span class="p">,</span> <span class="s">'column_51'</span><span class="p">,</span> <span class="s">'column_52'</span><span class="p">,</span> <span class="s">'column_53'</span><span class="p">,</span> <span class="s">'column_54'</span><span class="p">,</span> <span class="s">'column_55'</span><span class="p">,</span> <span class="s">'column_56'</span><span class="p">,</span> <span class="s">'column_57'</span><span class="p">,</span> <span class="s">'column_58'</span><span class="p">,</span> <span class="s">'column_59'</span><span class="p">,</span> <span class="s">'column_60'</span><span class="p">,</span> <span class="s">'approvaldate'</span><span class="p">,</span> <span class="s">'column_62'</span><span class="p">,</span> <span class="s">'column_63'</span><span class="p">,</span> <span class="s">'column_64'</span><span class="p">,</span> <span class="s">'column_65'</span><span class="p">,</span> <span class="s">'column_66'</span><span class="p">,</span> <span class="s">'column_67'</span><span class="p">,</span> <span class="s">'efficiencygrade'</span><span class="p">,</span> <span class="s">'efficiencyrate'</span><span class="p">,</span> <span class="s">'efficiencyscore'</span><span class="p">,</span> <span class="s">'greengrade'</span><span class="p">,</span> <span class="s">'greenscore'</span><span class="p">,</span> <span class="s">'column_73'</span><span class="p">,</span> <span class="s">'column_74'</span><span class="p">,</span> <span class="s">'column_75'</span><span class="p">,</span> <span class="s">'column_76'</span><span class="p">,</span> <span class="s">'column_77'</span><span class="p">]</span>

<span class="c1"># í‘œì œë¶€ ë¶ˆëŸ¬ì˜¤ê¸°
</span><span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="nf">read_csv</span><span class="p">(</span><span class="n">settings</span><span class="p">.</span><span class="n">PYOJE_ROOT</span><span class="o">+</span><span class="s">'</span><span class="se">\\</span><span class="s">pyojetable.txt'</span><span class="p">,</span><span class="n">sep</span><span class="o">=</span><span class="s">'|'</span><span class="p">,</span><span class="n">header</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span><span class="n">names</span><span class="o">=</span><span class="n">colname</span><span class="p">,</span><span class="n">encoding</span><span class="o">=</span><span class="s">'CP949'</span><span class="p">)</span>

<span class="c1"># ë¯¸ë¦¬ netfloorareaì— ëŒ€í•´ ë‚´ë¦¼ì°¨ìˆœ ì •ë ¬í•´ì„œ, ì¶”í›„ ê°™ì€ ë²ˆì§€ì— ì—¬ëŸ¬ ê±´ë¬¼ì´ ìˆì„ ê²½ìš° ì¤‘ë³µì œê±° í›„ ìš©ë„ê°€ netfloorareaê°€ ê°€ì¥ í° í•­ëª©ì˜ ìš©ë„ê°€ ë˜ê²Œ í•¨
</span><span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="p">.</span><span class="nf">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="p">[</span><span class="s">'netfloorarea'</span><span class="p">],</span> <span class="n">ascending</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>

<span class="c1"># ì¤‘ë³µì£¼ì†Œë“¤ì— ëŒ€í•´ ê°’ì„ í•©ì¹  í•­ëª©ë“¤ (ì—°ë©´ì , ì„¸ëŒ€ìˆ˜ ë“±) ì„ í•©ì¹˜ê¸°
</span><span class="n">data_tosum</span> <span class="o">=</span> <span class="n">data</span><span class="p">[[</span><span class="s">"addresstxt"</span><span class="p">,</span><span class="s">"sitearea"</span><span class="p">,</span><span class="s">"buildingarea"</span><span class="p">,</span><span class="s">"floorarea"</span><span class="p">,</span><span class="s">"netfloorarea"</span><span class="p">,</span><span class="s">"num_household"</span><span class="p">,</span><span class="s">"num_gagu"</span><span class="p">]]</span>
<span class="n">data_tosum</span> <span class="o">=</span> <span class="n">data_tosum</span><span class="p">.</span><span class="nf">groupby</span><span class="p">(</span><span class="s">'addresstxt'</span><span class="p">).</span><span class="nf">sum</span><span class="p">()</span> 

<span class="c1"># ì¤‘ë³µì£¼ì†Œë“¤ì— ëŒ€í•´ ê°’ì„ í•©ì¹˜ì§€ ì•Šì„ í•­ëª©ë“¤ì€ í•˜ë‚˜ë§Œ ë‚¨ê¹€
</span><span class="n">data_todrop</span> <span class="o">=</span> <span class="n">data</span><span class="p">[[</span><span class="s">"addresstxt"</span><span class="p">,</span><span class="s">"structureCd"</span><span class="p">,</span><span class="s">"structure"</span><span class="p">,</span><span class="s">"structuresub"</span><span class="p">,</span><span class="s">"principaluseCd"</span><span class="p">,</span><span class="s">"principaluse"</span><span class="p">,</span><span class="s">"subuse"</span><span class="p">,</span><span class="s">"roofCd"</span><span class="p">,</span><span class="s">"roof"</span><span class="p">,</span><span class="s">"approvaldate"</span><span class="p">,</span><span class="s">"coverageratio"</span><span class="p">,</span><span class="s">"voltolotratio"</span><span class="p">,</span><span class="s">"num_level"</span><span class="p">]]</span>
<span class="n">data_todrop</span> <span class="o">=</span> <span class="n">data_todrop</span><span class="p">.</span><span class="nf">drop_duplicates</span><span class="p">([</span><span class="s">'addresstxt'</span><span class="p">])</span> 

<span class="c1"># í‘œì œë¶€ í•­ëª©ë“¤ì„ outer joinìœ¼ë¡œ í•©ì¹˜ê¸°
</span><span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="nf">merge</span><span class="p">(</span><span class="n">left</span> <span class="o">=</span> <span class="n">data_tosum</span> <span class="p">,</span> <span class="n">right</span> <span class="o">=</span> <span class="n">data_todrop</span><span class="p">,</span> <span class="n">how</span> <span class="o">=</span> <span class="s">"outer"</span><span class="p">,</span> <span class="n">on</span> <span class="o">=</span> <span class="s">"addresstxt"</span><span class="p">)</span>

<span class="k">del</span> <span class="n">data_tosum</span><span class="p">,</span> <span class="n">data_todrop</span>

<span class="c1"># ì›”ë³„ ì—ë„ˆì§€ ì‚¬ìš©ëŸ‰ ë°ì´í„° ë¶ˆëŸ¬ì˜¤ê¸°
</span><span class="n">energydata</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="nf">read_csv</span><span class="p">(</span><span class="n">settings</span><span class="p">.</span><span class="n">CSV_ROOT</span><span class="o">+</span><span class="s">'</span><span class="se">\\</span><span class="s">monthlyenergy_2022.csv'</span><span class="p">,</span><span class="n">sep</span><span class="o">=</span><span class="s">','</span><span class="p">)</span>

<span class="c1"># í‘œì œë¶€ í•­ëª©ë“¤ê³¼ ì›”ë³„ ì—ë„ˆì§€ ì‚¬ìš©ëŸ‰ ë°ì´í„°ë¥¼ left joinìœ¼ë¡œ í•©ì¹˜ê¸° (ê±´ë¬¼ ì†ì„± ì •ë³´ê°€ ìˆëŠ” ê²½ìš°ì—ë§Œ)
</span><span class="n">resultdata</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="nf">merge</span><span class="p">(</span><span class="n">left</span> <span class="o">=</span> <span class="n">data</span> <span class="p">,</span> <span class="n">right</span> <span class="o">=</span> <span class="n">energydata</span><span class="p">,</span> <span class="n">how</span> <span class="o">=</span> <span class="s">"left"</span><span class="p">,</span> <span class="n">on</span> <span class="o">=</span> <span class="s">"addresstxt"</span><span class="p">)</span>

<span class="k">del</span> <span class="n">data</span><span class="p">,</span> <span class="n">energydata</span>

<span class="c1"># pandas dfì—ì„œ ìƒê¸°ëŠ” ê¸°ë³¸ axis column í•„ìš”ì—†ìœ¼ë¯€ë¡œ ì‚­ì œ
</span><span class="n">resultdata</span> <span class="o">=</span> <span class="n">resultdata</span><span class="p">.</span><span class="nf">drop</span><span class="p">([</span><span class="s">'Unnamed: 0'</span><span class="p">],</span><span class="n">axis</span><span class="o">=</span><span class="s">'columns'</span><span class="p">)</span>

<span class="c1"># addresstxtê°€ nullì¸ rowë“¤ ì—†ì• ê¸° (SQLì—ì„œ addresstxtì— ëŒ€í•œ not null ì œì•½ ë§Œì¡±í•˜ë„ë¡)
</span><span class="n">resultdata</span> <span class="o">=</span> <span class="n">resultdata</span><span class="p">.</span><span class="nf">dropna</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="s">'addresstxt'</span><span class="p">])</span> 

<span class="c1"># addresstxtê°€ ì¤‘ë³µì¸ ê²½ìš° í•˜ë‚˜ë§Œ ë‚¨ê¸°ê³  ì—†ì• ê¸° (SQLì—ì„œ addresstxtì— ëŒ€í•œ primary key ì œì•½ ë§Œì¡±í•˜ë„ë¡_
</span><span class="n">resultdata</span> <span class="o">=</span> <span class="n">resultdata</span><span class="p">.</span><span class="nf">drop_duplicates</span><span class="p">([</span><span class="s">'addresstxt'</span><span class="p">])</span> 
        
<span class="c1"># netfloorarea(ìš©ì ë¥ ì‚°ì •ìš©ì—°ë©´ì , ì—´ì¸ë±ìŠ¤ 4)ê°€ floorarea(ì—°ë©´ì , ì—´ì¸ë±ìŠ¤ 3)ë³´ë‹¤ í° ê²½ìš° ì˜ëª»ëœ ë°ì´í„°ì´ë¯€ë¡œ ìˆ˜ì •: 
# ëŒ€ì§€ë©´ì  * ìš©ì ë¥  ì´ ê³„ì‚°ë˜ë©´ì„œ ê·¸ ê°’ì´ ì—°ë©´ì ë³´ë‹¤ ì‘ìœ¼ë©´ ê·¸ ê°’ì„ ì“°ê³ ,
# ëŒ€ì§€ë©´ì  í˜¹ì€ ìš©ì ë¥ ì´ ëˆ„ë½ë˜ì–´ 0ì´ ë‚˜ì˜¤ê±°ë‚˜ ê·¸ ê°’ì´ ì—°ë©´ì ë³´ë‹¤ í¬ë©´ ì—°ë©´ì ì„ ì”€
</span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="n">resultdata</span><span class="p">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
    <span class="k">if</span> <span class="n">resultdata</span><span class="p">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">3</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">resultdata</span><span class="p">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">4</span><span class="p">]:</span> <span class="c1"># ì—°ë©´ì  &lt; ìš©ì ë¥ ì‚°ì •ë©´ì  ì´ë©´
</span>        <span class="k">if</span> <span class="n">resultdata</span><span class="p">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">resultdata</span><span class="p">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">17</span><span class="p">]</span><span class="o">/</span><span class="mi">100</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">resultdata</span><span class="p">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">resultdata</span><span class="p">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">17</span><span class="p">]</span><span class="o">/</span><span class="mi">100</span> <span class="o">&lt;</span> <span class="n">resultdata</span><span class="p">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">3</span><span class="p">]:</span>
            <span class="n">resultdata</span><span class="p">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="n">resultdata</span><span class="p">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">resultdata</span><span class="p">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">17</span><span class="p">]</span><span class="o">/</span><span class="mi">100</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">resultdata</span><span class="p">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="n">resultdata</span><span class="p">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">3</span><span class="p">]</span>
            


<span class="c1"># CSV íŒŒì¼ë¡œ ì €ì¥
</span><span class="n">resultdata</span><span class="p">.</span><span class="nf">to_csv</span><span class="p">(</span><span class="n">settings</span><span class="p">.</span><span class="n">CSV_ROOT</span><span class="o">+</span><span class="s">'</span><span class="se">\\</span><span class="s">monthlyenergy_2022_pyoje.csv'</span><span class="p">,</span><span class="n">sep</span><span class="o">=</span><span class="s">','</span><span class="p">,</span><span class="n">encoding</span><span class="o">=</span><span class="s">'utf-8-sig'</span><span class="p">)</span>

<span class="c1"># SQLite query ì‹¤í–‰
</span><span class="kn">import</span> <span class="n">sqlite3</span>
<span class="n">conn</span> <span class="o">=</span> <span class="n">sqlite3</span><span class="p">.</span><span class="nf">connect</span><span class="p">(</span><span class="s">'db_monthlyenergy_pyoje.db'</span><span class="p">)</span>

<span class="n">cur</span> <span class="o">=</span> <span class="n">conn</span><span class="p">.</span><span class="nf">cursor</span><span class="p">()</span> 

<span class="k">with</span> <span class="n">conn</span><span class="p">:</span> 
    
    <span class="n">sql_create</span> <span class="o">=</span> <span class="s">"""
    create table monthlyenergy_2022_pyoje
    (addresstxt text primary key not null,
     sitearea numeric,
     buildingarea numeric,
     floorarea numeric,
     netfloorarea numeric,
     voltolotratio numeric,        
     principaluse text, 
     subuse text,
     principaluseCd integer,
     coverageratio numeric,
     num_household integer, 
     num_gagu integer, 
     structureCd integer,
     structure text,
     structuresub text,
     roofCd integer,
     roof text,
     roofsub text,
     num_level integer,
     approvaldate text,
     sigunguCd integer,
     bjdongCd integer,
     bun integer,
     ji integer,
     elec_01 numeric,
     elec_02 numeric,
     elec_03 numeric,
     elec_04 numeric,
     elec_05 numeric,
     elec_06 numeric,
     elec_07 numeric,
     elec_08 numeric,
     elec_09 numeric,
     elec_10 numeric,
     elec_11 numeric,
     elec_12 numeric,
     gas_01 numeric,
     gas_02 numeric,
     gas_03 numeric,
     gas_04 numeric,
     gas_05 numeric,
     gas_06 numeric,
     gas_07 numeric,
     gas_08 numeric,
     gas_09 numeric,
     gas_10 numeric,
     gas_11 numeric,
     gas_12 numeric
     )
    """</span>
    
    <span class="n">cur</span><span class="p">.</span><span class="nf">execute</span><span class="p">(</span><span class="n">sql_create</span><span class="p">)</span>
    
<span class="n">resultdata</span><span class="p">.</span><span class="nf">to_sql</span><span class="p">(</span><span class="s">'monthlyenergy_2022_pyoje'</span><span class="p">,</span> <span class="n">conn</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">if_exists</span><span class="o">=</span><span class="s">'replace'</span><span class="p">)</span>
</code></pre></div></div>

<p>ì—ë„ˆì§€ ì‚¬ìš©ëŸ‰ ë°ì´í„°ì—ì„œ ì¤‘ë³µ ì£¼ì†Œë¥¼ ì œê±°í–ˆê¸° ë•Œë¬¸ì—, í‘œì œë¶€ì—ì„œë„ ì¤‘ë³µì£¼ì†ŒëŠ” ì œê±°í•´ì•¼ í•œë‹¤ (ì´ ê²½ìš° ì£¼ì†Œê°€ primary keyê°€ ëœë‹¤).</p>

<p>ì´ ë•Œ ê°™ì€ ì§€ë²ˆì£¼ì†Œ ë‚´ì— ì—¬ëŸ¬ ê±´ë¬¼ë“¤ì´ ìˆëŠ” ê²½ìš°ê°€ ìˆëŠ”ë°, ëŒ€ì§€ë©´ì ì´ë‚˜ ì—°ë©´ì  (ëª¨ë“  ì¸µì˜ ë°”ë‹¥ë©´ì ë“¤ì˜ í•©) ë“±ì˜ ì¹¼ëŸ¼ë“¤ì— ëŒ€í•´ì„œëŠ” ëª¨ë“  ê±´ë¬¼ë“¤ì˜ ê°’ì„ ë‹¤ ë”í•˜ë©´ ëœë‹¤ (ì´ëŠ” ì½”ë“œ ë‚´ $\texttt{data_tosum}$ ë³€ìˆ˜ ì •ì˜ì—ì„œ $\texttt{groupby}$ì™€ $\texttt{sum}$ìœ¼ë¡œ êµ¬í˜„í•¨). ê·¸ëŸ¬ë‚˜, ê±´ë¬¼ìš©ë„ (ê·¼ë¦°ìƒí™œ/ ì—…ë¬´/ íŒë§¤/ ì˜ë£Œ ë“±) ë˜ëŠ” ì¸µìˆ˜ ë“±ì€ í•©ì¹  ìˆ˜ ì—†ëŠ”ë°, ë¯¸ë¦¬ $\texttt{sort_values}$ í•¨ìˆ˜ë¥¼ ì´ìš©í•´ ì—°ë©´ì  ê¸°ì¤€ìœ¼ë¡œ ë‚´ë¦¼ì°¨ìˆœ ì •ë ¬ì„ í•´ ë†“ìŒìœ¼ë¡œì¨ ì£¼ì†Œ ì¤‘ë³µ ì œê±° ì‹œ ê±´ë¬¼ìš©ë„ë‚˜ ì¸µìˆ˜ ë“±ì´ ê°€ì¥ ì—°ë©´ì ì´ í° ê±´ë¬¼ ê¸°ì¤€ìœ¼ë¡œ ê²°ì •ë˜ê²Œ í–ˆë‹¤ (ì½”ë“œ ë‚´ $\texttt{data_todrop}$ ë³€ìˆ˜ ì •ì˜ì—ì„œ $\texttt{drop_duplicates}$ë¡œ êµ¬í˜„í•¨). ì°¸ê³ ë¡œ í‘œì œë¶€ì˜ ì—¬ëŸ¬ ì¹¼ëŸ¼ë“¤ ì¤‘ í•„ìš”í•œ ì¹¼ëŸ¼ë“¤ë§Œ ê°€ì ¸ì˜¤ëŠ” ê²ƒë„ ì—¬ê¸°ì— ë°˜ì˜ë˜ì–´ ìˆë‹¤.</p>

<p>í‘œì œë¶€ì˜ ì£¼ì†Œ ì¤‘ë³µ ì œê±°ë¥¼ ì²˜ë¦¬í•œ í›„, ì—ë„ˆì§€ì‚¬ìš©ëŸ‰ csv íŒŒì¼ì„ ë¶ˆëŸ¬ì˜¤ê³ , í‘œì œë¶€ì™€ ì—ë„ˆì§€ì‚¬ìš©ëŸ‰ì„ ì£¼ì†Œ ê¸°ì¤€ìœ¼ë¡œ outer joinìœ¼ë¡œ í•©ì¹œë‹¤. ê·¸ ê²°ê³¼ë¬¼ì¸ resultdata dataframeì„ SQL tableë¡œ ë§Œë“œëŠ” create table ì¿¼ë¦¬ë¥¼ sqlite3 íŒ¨í‚¤ì§€ì™€ to_sql í•¨ìˆ˜ë¥¼ ì´ìš©í•´ ì‹¤í–‰í–ˆë‹¤. (ì´ ë•Œ $\texttt{sqlite3.connect()}$ ì•ˆì— DB ì´ë¦„ ì“¸ ë•Œ $\texttt{.db}$ ê¹Œë¨¹ëŠ” ì‹¤ìˆ˜ë¥¼ í•˜ê¸° ì‰¬ìš´ë° ì£¼ì˜í•´ì•¼ í•¨)</p>

<p>ì„œìš¸ ì†Œì¬ ê±´ë¬¼ë“¤ì— ëŒ€í•´ êµ¬ì„±í•œ SQLite DBì˜ ìŠ¤í¬ë¦°ìƒ·ë“¤ì€ ì•„ë˜ì™€ ê°™ë‹¤.</p>

<p><img src="/assets/images/monthlyenergyone/sql_1.png" alt="sql_1" class="align-center" />
<img src="/assets/images/monthlyenergyone/sql_2.png" alt="sql_2" class="align-center" />
<img src="/assets/images/monthlyenergyone/sql_3.png" alt="sql_3" class="align-center" />
<img src="/assets/images/monthlyenergyone/sql_4.png" alt="sql_4" class="align-center" /></p>

<p>ì„œìš¸ ì†Œì¬ ê±´ë¬¼ë“¤ì— ëŒ€í•œ DB êµ¬ì„±ì€ ì•„ë˜ ì½”ë“œë¥¼ í†µí•´ ì „ì²´ SQLite DBë¡œë¶€í„° ì„œìš¸ ë‚´ ê±´ë¬¼ë“¤ ì¤‘ ì „ê¸° ì‚¬ìš©ëŸ‰ ë° ì—°ë©´ì  ê°’ì˜ ëˆ„ë½ì´ ì—†ëŠ” í–‰ë“¤ë§Œìœ¼ë¡œ tableì„ ë§Œë“¤ì–´ ì´ë¥¼ ë³„ë„ì˜ DB ë° tableë¡œ ì €ì¥í•˜ì—¬ ìˆ˜í–‰í•˜ì˜€ë‹¤.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># -*- coding: utf-8 -*-
</span>
<span class="c1"># SQLite DBë¡œë¶€í„° ì„œìš¸ ì†Œì¬ì´ë©° ì›”ë³„ ì „ê¸° ë° ìš©ì ë¥ ì‚°ì •ì—°ë©´ì  ëˆ„ë½ì´ ì—†ëŠ” ë°ì´í„°ë“¤ë§Œ dfë¡œ ë¶ˆëŸ¬ì˜¤ê¸°
</span>
<span class="n">your_query</span> <span class="o">=</span> <span class="s">"""
select * from monthlyenergy_2022_pyoje
where addresstxt like 'ì„œìš¸íŠ¹ë³„ì‹œ%'
and elec_01 not null
and elec_02 not null
and elec_03 not null
and elec_04 not null
and elec_05 not null
and elec_06 not null
and elec_07 not null
and elec_08 not null
and elec_09 not null
and elec_10 not null
and elec_11 not null
and elec_12 not null
and netfloorarea not null
and netfloorarea &gt; 0
"""</span>
<span class="kn">import</span> <span class="n">pandas</span> <span class="k">as</span> <span class="n">pd</span>
<span class="kn">import</span> <span class="n">sqlite3</span>

<span class="n">conn</span> <span class="o">=</span> <span class="n">sqlite3</span><span class="p">.</span><span class="nf">connect</span><span class="p">(</span><span class="s">"db_monthlyenergy_pyoje.db"</span><span class="p">)</span> <span class="c1"># .db ê¹Œë¨¹ì§€ ë§ ê²ƒ
</span>
<span class="n">cur</span> <span class="o">=</span> <span class="n">conn</span><span class="p">.</span><span class="nf">cursor</span><span class="p">()</span>

<span class="k">with</span> <span class="n">conn</span><span class="p">:</span>

    <span class="n">df_result</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="nc">DataFrame</span><span class="p">(</span><span class="n">cur</span><span class="p">.</span><span class="nf">execute</span><span class="p">(</span><span class="n">your_query</span><span class="p">).</span><span class="nf">fetchall</span><span class="p">())</span>
    <span class="n">df_result</span><span class="p">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">cur</span><span class="p">.</span><span class="n">description</span><span class="p">]</span>  <span class="c1"># add column names to the table
</span>
<span class="n">conn</span><span class="p">.</span><span class="nf">close</span><span class="p">()</span>    

<span class="n">conn_export</span> <span class="o">=</span> <span class="n">sqlite3</span><span class="p">.</span><span class="nf">connect</span><span class="p">(</span><span class="s">"db_monthlyenergy_seoul.db"</span><span class="p">)</span>
<span class="n">df_result</span><span class="p">.</span><span class="nf">to_sql</span><span class="p">(</span><span class="s">'seoul_2022'</span><span class="p">,</span> <span class="n">conn_export</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">if_exists</span><span class="o">=</span><span class="s">'append'</span><span class="p">)</span> <span class="c1"># ë³„ë„ì˜ SQLite DBë¡œ ì €ì¥
</span>
<span class="n">df_result</span><span class="p">.</span><span class="nf">to_csv</span><span class="p">(</span><span class="s">'seoul_2022.csv'</span><span class="p">,</span><span class="n">sep</span><span class="o">=</span><span class="s">','</span><span class="p">,</span><span class="n">encoding</span><span class="o">=</span><span class="s">'utf-8-sig'</span><span class="p">)</span>
</code></pre></div></div>


        
      </section>

      <footer class="page__meta">
        
        
  


  

  <p class="page__taxonomy">
    <strong><i class="fas fa-fw fa-tags" aria-hidden="true"></i> íƒœê·¸: </strong>
    <span itemprop="keywords">
    
      <a href="/tags/#beautifulsoup" class="page__taxonomy-item p-category" rel="tag">BeautifulSoup</a><span class="sep">, </span>
    
      <a href="/tags/#python" class="page__taxonomy-item p-category" rel="tag">python</a>
    
    </span>
  </p>



<!-- 
  


  

  <p class="page__taxonomy">
    <strong><i class="fas fa-fw fa-folder-open" aria-hidden="true"></i> ì¹´í…Œê³ ë¦¬: </strong>
    <span itemprop="keywords">
    
      <a href="/categories/#energy" class="page__taxonomy-item p-category" rel="tag">Energy</a>
    
    </span>
  </p>

 -->
        <!-- 

  <p class="page__date"><strong><i class="fas fa-fw fa-calendar-alt" aria-hidden="true"></i> ì—…ë°ì´íŠ¸:</strong> <time class="dt-published" datetime="2023-04-20T00:00:00+09:00">2023-04-20</time></p>
 -->
      </footer>

      <section class="page__share">
  
    <h4 class="page__share-title">ê³µìœ í•˜ê¸°</h4>
  

  <!-- <a href="https://twitter.com/intent/tweet?text=%EA%B1%B4%EC%B6%95%EB%AC%BC+%EB%B3%84+%EC%9B%94%EB%B3%84+%EC%97%90%EB%84%88%EC%A7%80+%EC%82%AC%EC%9A%A9%EB%9F%89+%EB%8D%B0%EC%9D%B4%ED%84%B0%EC%85%8B+-+1%29+%EB%AA%A8%EB%93%A0+%EC%9B%94%EC%97%90+%EB%8C%80%ED%95%9C+%ED%86%B5%ED%95%A9+%EB%B0%8F+%ED%91%9C%EC%A0%9C%EB%B6%80%EC%99%80%EC%9D%98+%EA%B2%B0%ED%95%A9+%ED%9B%84+SQLite+DB%ED%99%94%20http%3A%2F%2Flocalhost%3A4000%2F2023%2F04%2Fmonthlyenergyone.html" class="btn btn--twitter" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="ê³µìœ í•˜ê¸° Twitter"><i class="fab fa-fw fa-twitter" aria-hidden="true"></i><span> Twitter</span></a> -->

  <a href="https://www.facebook.com/sharer/sharer.php?u=http%3A%2F%2Flocalhost%3A4000%2F2023%2F04%2Fmonthlyenergyone.html" class="btn btn--facebook" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="ê³µìœ í•˜ê¸° Facebook"><i class="fab fa-fw fa-facebook" aria-hidden="true"></i><span> Facebook</span></a>

  <a href="https://www.linkedin.com/shareArticle?mini=true&url=http%3A%2F%2Flocalhost%3A4000%2F2023%2F04%2Fmonthlyenergyone.html" class="btn btn--linkedin" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="ê³µìœ í•˜ê¸° LinkedIn"><i class="fab fa-fw fa-linkedin" aria-hidden="true"></i><span> LinkedIn</span></a>
</section>


      <p></p>
        <h4 class="page__meta-title"><span>Energy</span> <span>ì¹´í…Œê³ ë¦¬ ë‚´ ë‹¤ë¥¸ ê¸€ ë³´ëŸ¬ê°€ê¸°</span></h4>
        


  

  

  
  	
  	
  	
  	
  	

<nav class="pagination_prev_next"> <!-- ì‹ë¹µë§˜ ì½”ë“œì—ì„œ ì¡°ê¸ˆ ìˆ˜ì •í•¨ -->

  
    
      <a href="/2023/04/monthlyenergytwo.html" class="pagination_prev_next--pager"><span class="prev_next">ë‹¤ìŒ ê¸€  &nbsp  </span>ê±´ì¶•ë¬¼ ë³„ ì›”ë³„ ì—ë„ˆì§€ ì‚¬ìš©ëŸ‰ ë°ì´í„°ì…‹ - 2) ì›”ë³„ ì‚¬ìš© ì¶”ì´ê°€ ì´ìƒí•œ data point ì œê±°</a>
    
    
      <a href="/2023/04/reinforcefive.html" class="pagination_prev_next--pager"><span class="prev_next">ì´ì „ ê¸€  &nbsp</span>ê°•í™”í•™ìŠµ ê¸°ë°˜ ë§ˆì´í¬ë¡œê·¸ë¦¬ë“œ ë‚´ ë°°í„°ë¦¬ ìŠ¤ì¼€ì¤„ë§ - 5) TD3, SACë¥¼ í†µí•œ continuous control ë„ì¶œ</a>
        
  

</nav>
      <p></p>
    </div>

    
  </article>

  
  <!-- 
    <div class="page__related">
      <h2 class="page__related-title">ì°¸ê³ </h2>
      <div class="grid__wrapper">
        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
      <div class="archive__item-teaser">
        <img src="/assets/images/logo.png" alt="">
      </div>
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/2023/04/monthlyenergythree.html" rel="permalink">ê±´ì¶•ë¬¼ ë³„ ì›”ë³„ ì—ë„ˆì§€ ì‚¬ìš©ëŸ‰ ë°ì´í„°ì…‹ - 3) ì›”ë³„ ì‚¬ìš©ëŸ‰ í¬ê¸°ê°€ ì´ìƒí•œ data point ì œê±°
</a>
      
    </h2>
    

  <p class="page__meta">
    
      
      <span class="page__meta-date">
        <i class="far fa-calendar-alt" aria-hidden="true"></i>
        
        <time datetime="2023-04-23T00:00:00+09:00">2023-04-23</time>
      </span>
    

    

    
  </p>


    <p class="archive__item-excerpt" itemprop="description">ì €ë²ˆ í¬ìŠ¤íŒ…ì—ì„œëŠ” ê±´ë¬¼ ì›”ë³„ ì—ë„ˆì§€ ì‚¬ìš©ëŸ‰ì˜ â€˜ì¶”ì´â€™ê°€ ì´ìƒí•œ data pointë¥¼ íŒë³„í•˜ëŠ” ë°©ë²•ì„ ì„¤ëª…í–ˆë‹¤. ì´ë²ˆ í¬ìŠ¤íŒ…ì—ì„œëŠ” ì›”ë³„ ì—ë„ˆì§€ ì‚¬ìš©ëŸ‰ì˜ â€˜í¬ê¸°(magnitude)â€™ê°€ ì´ìƒí•œ data pointë¥¼ íŒë³„í•˜ëŠ” ë°©ë²•ì„ ì„¤ëª…í•œë‹¤.
</p>
  </article>
</div>

        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
      <div class="archive__item-teaser">
        <img src="/assets/images/logo.png" alt="">
      </div>
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/2023/04/monthlyenergytwo.html" rel="permalink">ê±´ì¶•ë¬¼ ë³„ ì›”ë³„ ì—ë„ˆì§€ ì‚¬ìš©ëŸ‰ ë°ì´í„°ì…‹ - 2) ì›”ë³„ ì‚¬ìš© ì¶”ì´ê°€ ì´ìƒí•œ data point ì œê±°
</a>
      
    </h2>
    

  <p class="page__meta">
    
      
      <span class="page__meta-date">
        <i class="far fa-calendar-alt" aria-hidden="true"></i>
        
        <time datetime="2023-04-22T00:00:00+09:00">2023-04-22</time>
      </span>
    

    

    
  </p>


    <p class="archive__item-excerpt" itemprop="description">ì´ì „ í¬ìŠ¤íŒ…ì—ì„œ, ê° ê±´ë¬¼ì˜ ì§€ë²ˆë³„/ì›”ë³„ ì „ê¸°ì™€ ë„ì‹œê°€ìŠ¤ ì‚¬ìš©ëŸ‰ ë°ì´í„°ë¥¼ ì†Œê°œí•˜ì˜€ë‹¤. ë˜í•œ ì´ë¥¼ í‘œì œë¶€ì™€ ê²°í•©í•´ ê±´ë¬¼ ì—ë„ˆì§€ ë¶„ì„ì— í™œìš©í•  ìˆ˜ ìˆìœ¼ë©°, ê·¸ ê²°í•© ë°©ë²• ë˜í•œ ì†Œê°œí•˜ì˜€ë‹¤.
</p>
  </article>
</div>

        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
      <div class="archive__item-teaser">
        <img src="/assets/images/logo.png" alt="">
      </div>
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/2023/04/cudadudnn.html" rel="permalink">WSL2 Ubuntu 22.04ì— CUDA &amp; cuDNN ì„¤ì¹˜í•˜ê¸°
</a>
      
    </h2>
    

  <p class="page__meta">
    
      
      <span class="page__meta-date">
        <i class="far fa-calendar-alt" aria-hidden="true"></i>
        
        <time datetime="2023-04-21T00:00:00+09:00">2023-04-21</time>
      </span>
    

    

    
  </p>


    <p class="archive__item-excerpt" itemprop="description">ìì‹ ì˜ NVIDIA ê·¸ë˜í”½ì¹´ë“œ ëª¨ë¸ëª…ì— ë§ëŠ” NVIDIA driverë¥¼ ë‹¤ìš´ë¡œë“œ ì›¹í˜ì´ì§€ ì°¾ì•„ì„œ ìœˆë„ìš°ì—ì„œ ì„¤ì¹˜
</p>
  </article>
</div>

        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
      <div class="archive__item-teaser">
        <img src="/assets/images/logo.png" alt="">
      </div>
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/2023/04/reinforcefive.html" rel="permalink">ê°•í™”í•™ìŠµ ê¸°ë°˜ ë§ˆì´í¬ë¡œê·¸ë¦¬ë“œ ë‚´ ë°°í„°ë¦¬ ìŠ¤ì¼€ì¤„ë§ - 5) TD3, SACë¥¼ í†µí•œ continuous control ë„ì¶œ
</a>
      
    </h2>
    

  <p class="page__meta">
    
      
      <span class="page__meta-date">
        <i class="far fa-calendar-alt" aria-hidden="true"></i>
        
        <time datetime="2023-04-19T00:00:00+09:00">2023-04-19</time>
      </span>
    

    

    
  </p>


    <p class="archive__item-excerpt" itemprop="description">ì €ë²ˆ í¬ìŠ¤íŒ…ì—ì„œëŠ” continuous controlì„ ìœ„í•œ ê¸°ë³¸ì ì¸ ì‹¬ì¸µê°•í™”í•™ìŠµ ë°©ë²•, Deep Deterministic Policy Gradient (DDPG) ë¥¼ ì ìš©í•´ ë³´ì•˜ë‹¤. ë†€ëê²Œë„(?) ì´ ì‹œë¦¬ì¦ˆì—ì„œ ë‹¤ë£¨ëŠ” ë§ˆì´í¬ë¡œê·¸ë¦¬ë“œ ë¬¸ì œì—ì„œëŠ”, DDPGê°€ Deep Q-learnin...</p>
  </article>
</div>

        
      </div>
    </div> -->
  
  <!--  -->
</div>

  </div>

  

  <aside class="sidebar__top">
    <a href="#site-nav"> <i class="fas fa-angle-double-up fa-2x"></i></a>
    </aside>

  <div id="footer" class="page__footer">
    <footer>
      <!-- start custom footer snippets -->

<!-- end custom footer snippets -->
      <div class="page__footer-follow">
  <ul class="social-icons">
    
      <li><strong>íŒ”ë¡œìš°:</strong></li>
    

    
      
        
          <li><a href="https://blog.naver.com/song4energy" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-github" aria-hidden="true"></i> GitHub</a></li>
        
      
    

    
      <li><a href="/feed.xml"><i class="fas fa-fw fa-rss-square" aria-hidden="true"></i> í”¼ë“œ</a></li>
    
  </ul>
</div>

<div class="page__footer-copyright">&copy; 2023 Jeonghun Song. Powered by <a href="https://jekyllrb.com" rel="nofollow">Jekyll</a> &amp; <a href="https://mademistakes.com/work/minimal-mistakes-jekyll-theme/" rel="nofollow">Minimal Mistakes</a>.</div>

    </footer>
  </div>

  
  <script src="/assets/js/main.min.js"></script>










</body>

</html>